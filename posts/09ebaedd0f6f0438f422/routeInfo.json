{"template":"__react_static_root__/src/components/QiitaPost","sharedHashesByProp":{},"data":{"post":{"rendered_body":"<p>なんか公式のやり方があるっぽいのでメモがてら書いておく。</p>\n\n<p><qiita-embed-ogp src=\"https://cloud.google.com/blog/products/g-suite/g-suite-pro-tip-how-to-automatically-add-a-schedule-from-google-sheets-into-calendar\"></qiita-embed-ogp></p>\n\n<h1>\n<span id=\"google-apps-script-gas-ガチ勢3日目\" class=\"fragment\"></span><a href=\"#google-apps-script-gas-%E3%82%AC%E3%83%81%E5%8B%A23%E6%97%A5%E7%9B%AE\"><i class=\"fa fa-link\"></i></a>Google Apps Script [GAS] ガチ勢3日目</h1>\n\n<p>Google Apps Scriptすげえ！楽しい！ってなって3日目です。<br>\nこのScript便利だよ、自社のJavaScript書けるエンジニアさんの大切な時間を奪えば<del>なんだって</del>いろいろできるよって話をしていきます。</p>\n\n<h2>\n<span id=\"内容\" class=\"fragment\"></span><a href=\"#%E5%86%85%E5%AE%B9\"><i class=\"fa fa-link\"></i></a>内容</h2>\n\n<ul>\n<li>完成品の確認</li>\n<li>コピペ編</li>\n<li>コード編</li>\n</ul>\n\n<p>以上3つで構成しようと思っています。</p>\n\n<h1>\n<span id=\"完成品の確認\" class=\"fragment\"></span><a href=\"#%E5%AE%8C%E6%88%90%E5%93%81%E3%81%AE%E7%A2%BA%E8%AA%8D\"><i class=\"fa fa-link\"></i></a>完成品の確認</h1>\n\n<p>マイカレンダー &gt;&gt; [ ◯◯株式会社 ] これを作ります。<br>\n<a href=\"https://camo.qiitausercontent.com/0822b8ed4d102266c3f3e7122cbe824822eca0b1/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f38646534633666372d613735382d663338322d373566652d6365363137383066373433372e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"><img width=\"1293\" alt=\"スクリーンショット 2017-03-05 16.40.22.jpg\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F8de4c6f7-a758-f382-75fe-ce61780f7437.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f61d886b28aaebe30d00a04a6124159d\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/8de4c6f7-a758-f382-75fe-ce61780f7437.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F8de4c6f7-a758-f382-75fe-ce61780f7437.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=16c9270be1fa19fced7a0d13cc38125f 1x\" loading=\"lazy\"></a></p>\n\n<h2>\n<span id=\"point\" class=\"fragment\"></span><a href=\"#point\"><i class=\"fa fa-link\"></i></a>POINT</h2>\n\n<p>Googleの[ 日本の祝日 ]を元として、自社だけの[ 創立記念日 ]とか[ <del>△休日出勤</del> ]<br>\nとか追加したカレンダーが作れます。<br>\n作るだけならコピペで10分くらいで作れるかと思います。<br>\n一度このスクリプトに慣れれば[声優さんイベントカレンダー]とか[アイドルライブカレンダー]とか[◯◯イベントカレンダー]とかをすぐ作れるようになれます。私、某J系アイドルのコンサート日程をGoogleマイカレンダーに登録しているんですけど、普段は非表示(今日は◯でライブか…いきたい！！ってならないように。)必要なときに表示にしています。</p>\n\n<h2>\n<span id=\"使用するサイト技術など\" class=\"fragment\"></span><a href=\"#%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E3%82%B5%E3%82%A4%E3%83%88%E6%8A%80%E8%A1%93%E3%81%AA%E3%81%A9\"><i class=\"fa fa-link\"></i></a>使用するサイト・技術など</h2>\n\n<ul>\n<li>Google Apps(スプレッドシート、カレンダー)を使うので、Googleアカウント</li>\n<li>Google Apps Script( ≒ JavaScript)</li>\n</ul>\n\n<h2>\n<span id=\"カレンダーを作成した後の発展先\" class=\"fragment\"></span><a href=\"#%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC%E3%82%92%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9F%E5%BE%8C%E3%81%AE%E7%99%BA%E5%B1%95%E5%85%88\"><i class=\"fa fa-link\"></i></a>カレンダーを作成した後の発展先</h2>\n\n<p>後でQiita公開しようと思ってる記事</p>\n\n<blockquote>\n<p>自社の営業日だけSlackに投稿したりするボット作成<br>\nこれに似たのさっき公開しました<a href=\"http://qiita.com/ykhirao/items/782e20ab0465533c48f6\" id=\"reference-78379306d036844ceb7f\">最終営業日に月末の報告しっかりしろよってSlackに投げるやつ</a></p>\n</blockquote>\n\n<div class=\"code-frame\" data-lang=\"javascript\">\n<div class=\"code-lang\"><span class=\"bold\">省略しまくってます.js</span></div>\n<div class=\"highlight\"><pre><code><span class=\"nx\">CalendarApp</span><span class=\"p\">.</span><span class=\"nx\">getCalendarById</span><span class=\"p\">();</span>\n<span class=\"nx\">holidays</span> <span class=\"o\">=</span> <span class=\"nx\">cal</span><span class=\"p\">.</span><span class=\"nx\">getEvents</span><span class=\"p\">();</span>\n<span class=\"k\">return</span> <span class=\"nx\">holidays</span><span class=\"p\">.</span><span class=\"nx\">length</span> <span class=\"o\">!=</span> <span class=\"mi\">0</span><span class=\"p\">;</span>\n</code></pre></div>\n</div>\n\n<p>自社カレンダーがあるとこれくらいのコード量で、[ 自社が休みかどうか ]の営業日判定がすごくやりやすくなります。<br>\n詳しくはこちら<a href=\"http://qiita.com/kamatama_41/items/be40e05524530920a9d9\" id=\"reference-bd5c16f94b2d75f301f7\">GoogleAppsScriptで日本の祝日を取得する</a></p>\n\n<blockquote>\n<p>スクレイピングしてせっせとカレンダー作りまくる</p>\n</blockquote>\n\n<p>先程の[ <a href=\"https://calendar.google.com/calendar/embed?src=2mjt9uiftvsjtqrrt2tdtq89do%40group.calendar.google.com&amp;ctz=Asia/Tokyo\" rel=\"nofollow noopener\" target=\"_blank\">◯◯株式会社</a>のカレンダー ]<br>\n<a href=\"https://camo.qiitausercontent.com/608fcfa3e2e7e53fa0e3a14c99cedf1870c2aa77/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f33623836366239362d643435382d343034302d343264632d3465613830363237356365392e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"><img width=\"862\" alt=\"スクリーンショット 2017-03-05 17.47.10.jpg\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F3b866b96-d458-4040-42dc-4ea806275ce9.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1cf1484a195d46b29f6441df9c76f193\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/3b866b96-d458-4040-42dc-4ea806275ce9.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F3b866b96-d458-4040-42dc-4ea806275ce9.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=43297f119df8e716a11db16bc442cda3 1x\" loading=\"lazy\"></a></p>\n\n<p>実は一般公開も簡単で、趣味のイベント情報の管理人にもすぐなれます。画像右下の[ + Google Calendar ]からカレンダーの追加もすぐできます。趣味友のためにイベント情報ちょっとスクレイピングしてくるわ(どやっ)ってしてくれるといいですね。</p>\n\n<h1>\n<span id=\"コピペ編\" class=\"fragment\"></span><a href=\"#%E3%82%B3%E3%83%94%E3%83%9A%E7%B7%A8\"><i class=\"fa fa-link\"></i></a>コピペ編</h1>\n\n<h2>\n<span id=\"スプレッドシート作成\" class=\"fragment\"></span><a href=\"#%E3%82%B9%E3%83%97%E3%83%AC%E3%83%83%E3%83%89%E3%82%B7%E3%83%BC%E3%83%88%E4%BD%9C%E6%88%90\"><i class=\"fa fa-link\"></i></a>スプレッドシート作成</h2>\n\n<p><a href=\"https://drive.google.com/drive/my-drive\" rel=\"nofollow noopener\" target=\"_blank\">Google Drive</a>からスプレッドシートを作成してください。<br>\n<a href=\"https://camo.qiitausercontent.com/dfcbead064a43455153dbec243d65dba2468a63c/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f63616363343762322d633834352d383232622d313965632d6261643762626238656531632e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"><img width=\"1145\" alt=\"スクリーンショット 2017-03-05 17.54.17.jpg\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fcacc47b2-c845-822b-19ec-bad7bbb8ee1c.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a66dcccb71ee84479fc6ce79f3f6f201\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/cacc47b2-c845-822b-19ec-bad7bbb8ee1c.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fcacc47b2-c845-822b-19ec-bad7bbb8ee1c.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=5a9d4689b5031085c3c243f63aba528a 1x\" loading=\"lazy\"></a></p>\n\n<h2>\n<span id=\"表のスタイルをあわせる\" class=\"fragment\"></span><a href=\"#%E8%A1%A8%E3%81%AE%E3%82%B9%E3%82%BF%E3%82%A4%E3%83%AB%E3%82%92%E3%81%82%E3%82%8F%E3%81%9B%E3%82%8B\"><i class=\"fa fa-link\"></i></a>表のスタイルをあわせる</h2>\n\n<table>\n<thead>\n<tr>\n<th style=\"text-align: center\">1</th>\n<th style=\"text-align: center\">2</th>\n<th style=\"text-align: center\">3</th>\n<th style=\"text-align: center\">4</th>\n<th style=\"text-align: center\">5</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align: center\">Googleカレンダーからの取得</td>\n<td style=\"text-align: center\"></td>\n<td style=\"text-align: center\">手動追加</td>\n<td style=\"text-align: center\"></td>\n<td style=\"text-align: center\">カレンダーの名前</td>\n</tr>\n<tr>\n<td style=\"text-align: center\">日付</td>\n<td style=\"text-align: center\">タイトル</td>\n<td style=\"text-align: center\">日付</td>\n<td style=\"text-align: center\">タイトル</td>\n<td style=\"text-align: center\">◯◯株式会社</td>\n</tr>\n</tbody>\n</table>\n\n<p>まずこちらをコピーして、[ 値のみ貼り付け ]をして、図のような形式にしてください。<br>\n<a href=\"https://camo.qiitausercontent.com/2a38e504df77c5d964f259e55bb6556766e683e4/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f65373035343735622d326637372d313837632d303764312d3266653565623638633839622e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"><img width=\"606\" alt=\"スクリーンショット 2017-03-05 18.01.38.jpg\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fe705475b-2f77-187c-07d1-2fe5eb68c89b.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=691955625dc3d885b2b6a36ad9cd5c3f\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/e705475b-2f77-187c-07d1-2fe5eb68c89b.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fe705475b-2f77-187c-07d1-2fe5eb68c89b.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=2b98562c7d4263cd8a19840bf1973b9d 1x\" loading=\"lazy\"></a></p>\n\n<h2>\n<span id=\"スクリプトエディタを開く\" class=\"fragment\"></span><a href=\"#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%82%A8%E3%83%87%E3%82%A3%E3%82%BF%E3%82%92%E9%96%8B%E3%81%8F\"><i class=\"fa fa-link\"></i></a>スクリプトエディタを開く</h2>\n\n<p>ツール &gt;&gt; スクリプトエディタ <br>\nこちらをクリック。<br>\n<a href=\"https://camo.qiitausercontent.com/623ac119c535fb6da789181161e400c291a7deb3/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f36633466393530612d623038382d396262312d323631662d6663623163373335306434312e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"><img width=\"602\" alt=\"スクリーンショット 2017-03-05 18.04.38.jpg\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F6c4f950a-b088-9bb1-261f-fcb1c7350d41.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=128dec1c20caecd178a9275f6286f947\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/6c4f950a-b088-9bb1-261f-fcb1c7350d41.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F6c4f950a-b088-9bb1-261f-fcb1c7350d41.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3cc39b4eab1bffec34968488afda0a52 1x\" loading=\"lazy\"></a></p>\n\n<h2>\n<span id=\"スクリプトエディタにコードを貼り付ける\" class=\"fragment\"></span><a href=\"#%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%82%A8%E3%83%87%E3%82%A3%E3%82%BF%E3%81%AB%E3%82%B3%E3%83%BC%E3%83%89%E3%82%92%E8%B2%BC%E3%82%8A%E4%BB%98%E3%81%91%E3%82%8B\"><i class=\"fa fa-link\"></i></a>スクリプトエディタにコードを貼り付ける</h2>\n\n<p><a href=\"https://camo.qiitausercontent.com/d16a9d0ccd4f0e39000b4fe3e5b4f770d3872a7b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f63376464383364312d363239392d393062382d633337322d6662613538366265383535622e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"><img width=\"784\" alt=\"スクリーンショット 2017-03-05 18.08.15.jpg\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fc7dd83d1-6299-90b8-c372-fba586be855b.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=93a7023c9448dc59dc316bbc34e94579\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/c7dd83d1-6299-90b8-c372-fba586be855b.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fc7dd83d1-6299-90b8-c372-fba586be855b.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=e41c5966cd0e14155a7f5e8ee29d823d 1x\" loading=\"lazy\"></a><br>\n1. 左上の名前変更<br>\n1. コード.gsに以下のコードをコピペ</p>\n\n<div class=\"code-frame\" data-lang=\"js\"><div class=\"highlight\"><pre><code><span class=\"kd\">function</span> <span class=\"nx\">createGoogleCalendar</span><span class=\"p\">(){</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">title</span><span class=\"p\">,</span> <span class=\"nx\">date</span><span class=\"p\">;</span>\n\n  <span class=\"c1\">// カレンダー名の取得</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">sheet</span> <span class=\"o\">=</span> <span class=\"nx\">SpreadsheetApp</span><span class=\"p\">.</span><span class=\"nx\">getActiveSheet</span><span class=\"p\">();</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">calendarName</span> <span class=\"o\">=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getRange</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">).</span><span class=\"nx\">getValue</span><span class=\"p\">();</span>\n\n  <span class=\"c1\">// カレンダーの作成と、オブジェクトcalの生成</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">cal</span> <span class=\"o\">=</span> <span class=\"nx\">CalendarApp</span><span class=\"p\">.</span><span class=\"nx\">createCalendar</span><span class=\"p\">(</span><span class=\"nx\">calendarName</span><span class=\"p\">);</span>\n\n  <span class=\"c1\">// Google[日本の祝日]の全日イベントの追加</span>\n  <span class=\"k\">for</span> <span class=\"p\">(</span><span class=\"kd\">var</span> <span class=\"nx\">i</span> <span class=\"o\">=</span> <span class=\"mi\">3</span><span class=\"p\">;</span> <span class=\"nx\">i</span> <span class=\"o\">&lt;=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getLastRow</span><span class=\"p\">();</span> <span class=\"nx\">i</span><span class=\"o\">++</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"nx\">title</span> <span class=\"o\">=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getRange</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">).</span><span class=\"nx\">getValue</span><span class=\"p\">();</span>\n    <span class=\"nx\">date</span> <span class=\"o\">=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getRange</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">).</span><span class=\"nx\">getValue</span><span class=\"p\">();</span>\n<span class=\"err\">　　　　　　　　</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">title</span><span class=\"o\">==</span><span class=\"dl\">\"\"</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nx\">date</span> <span class=\"o\">==</span> <span class=\"dl\">\"\"</span><span class=\"p\">)</span> <span class=\"k\">break</span><span class=\"p\">;</span>\n    <span class=\"nx\">cal</span><span class=\"p\">.</span><span class=\"nx\">createAllDayEvent</span><span class=\"p\">(</span><span class=\"nx\">title</span><span class=\"p\">,</span> <span class=\"nx\">date</span><span class=\"p\">);</span>\n  <span class=\"p\">}</span>\n\n  <span class=\"c1\">// [手動追加]の全日イベントの追加</span>\n  <span class=\"k\">for</span> <span class=\"p\">(</span><span class=\"kd\">var</span> <span class=\"nx\">i</span> <span class=\"o\">=</span> <span class=\"mi\">3</span><span class=\"p\">;</span> <span class=\"nx\">i</span> <span class=\"o\">&lt;=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getLastRow</span><span class=\"p\">();</span> <span class=\"nx\">i</span><span class=\"o\">++</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"nx\">title</span> <span class=\"o\">=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getRange</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">).</span><span class=\"nx\">getValue</span><span class=\"p\">();</span>\n    <span class=\"nx\">date</span> <span class=\"o\">=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getRange</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">).</span><span class=\"nx\">getValue</span><span class=\"p\">();</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">title</span><span class=\"o\">==</span><span class=\"dl\">\"\"</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nx\">date</span> <span class=\"o\">==</span> <span class=\"dl\">\"\"</span><span class=\"p\">)</span> <span class=\"k\">break</span><span class=\"p\">;</span>\n    <span class=\"nx\">cal</span><span class=\"p\">.</span><span class=\"nx\">createAllDayEvent</span><span class=\"p\">(</span><span class=\"nx\">title</span><span class=\"p\">,</span> <span class=\"nx\">date</span><span class=\"p\">);</span>\n  <span class=\"p\">}</span>  \n<span class=\"p\">}</span>\n\n<span class=\"c1\">// Google[日本の祝日]の全日イベントからスプレッドシート作成</span>\n<span class=\"kd\">function</span> <span class=\"nx\">createByGoogleHoliday</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n\n  <span class=\"kd\">var</span> <span class=\"nx\">start</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"mi\">2017</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">);</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">end</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"mi\">2019</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">);</span>\n\n  <span class=\"kd\">var</span> <span class=\"nx\">sheet</span> <span class=\"o\">=</span> <span class=\"nx\">SpreadsheetApp</span><span class=\"p\">.</span><span class=\"nx\">getActiveSheet</span><span class=\"p\">();</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">holidays</span> <span class=\"o\">=</span> <span class=\"nx\">getHoliday</span><span class=\"p\">(</span><span class=\"nx\">start</span><span class=\"p\">,</span> <span class=\"nx\">end</span><span class=\"p\">);</span>\n\n  <span class=\"kd\">var</span> <span class=\"nx\">startRow</span> <span class=\"o\">=</span> <span class=\"mi\">3</span><span class=\"p\">;</span>\n\n  <span class=\"kd\">var</span> <span class=\"nx\">range</span> <span class=\"o\">=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getRange</span><span class=\"p\">(</span><span class=\"nx\">startRow</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"nx\">holidays</span><span class=\"p\">.</span><span class=\"nx\">length</span><span class=\"p\">,</span> <span class=\"nx\">holidays</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">].</span><span class=\"nx\">length</span><span class=\"p\">);</span>\n  <span class=\"nx\">range</span><span class=\"p\">.</span><span class=\"nx\">setValues</span><span class=\"p\">(</span><span class=\"nx\">holidays</span><span class=\"p\">);</span>\n  <span class=\"nx\">range</span><span class=\"p\">.</span><span class=\"nx\">sort</span><span class=\"p\">([{</span><span class=\"na\">column</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"na\">ascending</span><span class=\"p\">:</span> <span class=\"kc\">true</span><span class=\"p\">}]);</span> <span class=\"c1\">// 昇順ソート</span>\n\n<span class=\"p\">}</span>\n\n<span class=\"cm\">/**\n * startDate〜endDateまでの祝日をgoogleカレンダーの「日本の祝日」から取得\n * [日付,祝日名]の多次元配列にした上で返す\n */</span>\n<span class=\"kd\">function</span> <span class=\"nx\">getHoliday</span><span class=\"p\">(</span><span class=\"nx\">start</span><span class=\"p\">,</span> <span class=\"nx\">end</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">cal</span> <span class=\"o\">=</span> <span class=\"nx\">CalendarApp</span><span class=\"p\">.</span><span class=\"nx\">getCalendarById</span><span class=\"p\">(</span><span class=\"dl\">\"</span><span class=\"s2\">ja.japanese#holiday@group.v.calendar.google.com</span><span class=\"dl\">\"</span><span class=\"p\">);</span>\n\n  <span class=\"kd\">var</span> <span class=\"nx\">holidays</span> <span class=\"o\">=</span> <span class=\"nx\">cal</span><span class=\"p\">.</span><span class=\"nx\">getEvents</span><span class=\"p\">(</span><span class=\"nx\">start</span><span class=\"p\">,</span> <span class=\"nx\">end</span><span class=\"p\">);</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">values</span> <span class=\"o\">=</span> <span class=\"p\">[];</span>\n\n  <span class=\"k\">for</span><span class=\"p\">(</span><span class=\"kd\">var</span> <span class=\"nx\">i</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">;</span> <span class=\"nx\">i</span> <span class=\"o\">&lt;</span> <span class=\"nx\">holidays</span><span class=\"p\">.</span><span class=\"nx\">length</span><span class=\"p\">;</span> <span class=\"nx\">i</span><span class=\"o\">++</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"nx\">values</span><span class=\"p\">[</span><span class=\"nx\">i</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"nx\">holidays</span><span class=\"p\">[</span><span class=\"nx\">i</span><span class=\"p\">].</span><span class=\"nx\">getStartTime</span><span class=\"p\">(),</span> <span class=\"nx\">holidays</span><span class=\"p\">[</span><span class=\"nx\">i</span><span class=\"p\">].</span><span class=\"nx\">getTitle</span><span class=\"p\">()];</span>\n  <span class=\"p\">}</span>\n\n  <span class=\"cm\">/**\n   * 追加と削除機能あり\n   * values.push([new Date(\"2017/1/4\"), \"俺の日\"]);\n   * values = deleteHoliday(values, \"2017/1/4\");\n   */</span>\n\n  <span class=\"k\">return</span> <span class=\"nx\">values</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n<span class=\"kd\">function</span> <span class=\"nx\">deleteHoliday</span><span class=\"p\">(</span><span class=\"nx\">values</span><span class=\"p\">,</span> <span class=\"nx\">date</span><span class=\"p\">){</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">target</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"nx\">date</span><span class=\"p\">);</span>\n  <span class=\"nx\">values</span><span class=\"p\">.</span><span class=\"nx\">some</span><span class=\"p\">(</span><span class=\"kd\">function</span><span class=\"p\">(</span><span class=\"nx\">v</span><span class=\"p\">,</span> <span class=\"nx\">i</span><span class=\"p\">){</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">Date</span><span class=\"p\">.</span><span class=\"nx\">parse</span><span class=\"p\">(</span><span class=\"nx\">v</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">])</span> <span class=\"o\">==</span> <span class=\"nb\">Date</span><span class=\"p\">.</span><span class=\"nx\">parse</span><span class=\"p\">(</span><span class=\"nx\">target</span><span class=\"p\">))</span> <span class=\"nx\">values</span><span class=\"p\">.</span><span class=\"nx\">splice</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">);</span>\n  <span class=\"p\">});</span>\n  <span class=\"k\">return</span> <span class=\"nx\">values</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n</code></pre></div></div>\n\n<p>今回は自動化はしていませんが、コードはこちらの記事[ <a href=\"http://qiita.com/ik-fib/items/6c35640954c2b04a9287\" id=\"reference-37a5adaecf3d739da032\">google spread sheetに自動更新される日本の祝日シートを作る</a> ]から3割くらいお借りしています。月に一度の自動更新で正確に祝日カレンダーをGoogleから同期させられる手法なのでぜひ読んでみてください。追加点は<code>コード内でイベントの追加と削除機能を実装</code>と<code>ソート機能</code>と<code>スプレッドシートからのカレンダー作成</code>です。</p>\n\n<h2>\n<span id=\"コードの実行\" class=\"fragment\"></span><a href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E5%AE%9F%E8%A1%8C\"><i class=\"fa fa-link\"></i></a>コードの実行</h2>\n\n<p>実行 &gt;&gt; <code>createByGoogleHoliday</code></p>\n\n<p><a href=\"https://camo.qiitausercontent.com/5c4e088fddee9191aea8ab21a004ff7cd178cb1e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f64616161316165632d306630312d666537352d363664342d3335643933636238633865652e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"><img width=\"711\" alt=\"スクリーンショット 2017-03-05 18.21.25.jpg\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fdaaa1aec-0f01-fe75-66d4-35d93cb8c8ee.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=0df1f4ab6da75be7d058e0fdddf387fb\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/daaa1aec-0f01-fe75-66d4-35d93cb8c8ee.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fdaaa1aec-0f01-fe75-66d4-35d93cb8c8ee.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=385abecb1900ec574d789edf9d174554 1x\" loading=\"lazy\"></a><br>\nこのスクリプトからスプレッドシートなどのGoogle Appsへのアクセス許可を聞かれるのでOKしてください。</p>\n\n<h2>\n<span id=\"スプレッドシートに戻ってみる\" class=\"fragment\"></span><a href=\"#%E3%82%B9%E3%83%97%E3%83%AC%E3%83%83%E3%83%89%E3%82%B7%E3%83%BC%E3%83%88%E3%81%AB%E6%88%BB%E3%81%A3%E3%81%A6%E3%81%BF%E3%82%8B\"><i class=\"fa fa-link\"></i></a>スプレッドシートに戻ってみる</h2>\n\n<p>こんな感じでGoogleカレンダーから取得できてると正解</p>\n\n<p><a href=\"https://camo.qiitausercontent.com/0d65c0876be8fa53b336f7cdf8f865a5419bc9ad/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f30313434333937382d383266392d666163382d633935372d6465323136643535653562392e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"><img width=\"701\" alt=\"スクリーンショット 2017-03-05 18.24.17.jpg\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F01443978-82f9-fac8-c957-de216d55e5b9.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ab6ec77f3dc1e135f427186f061a98dd\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/01443978-82f9-fac8-c957-de216d55e5b9.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F01443978-82f9-fac8-c957-de216d55e5b9.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=ff33bcac9771d08ae2e0f1233af84d1c 1x\" loading=\"lazy\"></a></p>\n\n<h2>\n<span id=\"手作業入力\" class=\"fragment\"></span><a href=\"#%E6%89%8B%E4%BD%9C%E6%A5%AD%E5%85%A5%E5%8A%9B\"><i class=\"fa fa-link\"></i></a>手作業入力</h2>\n\n<ul>\n<li>手動追記 &gt;&gt; 日付とタイトル\n\n<ul>\n<li>一応どちらも入力してください</li>\n<li>空白行があるとそこで終了</li>\n</ul>\n</li>\n<li>カレンダーの名前 &gt;&gt; 私の会社\n\n<ul>\n<li>私の会社の部分がカレンダーのタイトルになります。</li>\n</ul>\n</li>\n</ul>\n\n<p><a href=\"https://camo.qiitausercontent.com/a252e99a435415acb0f6ec9a42cb7b4381c7539a/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f65633632376462372d613433662d316637612d356464382d3266663165653630313237312e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"><img width=\"670\" alt=\"スクリーンショット 2017-03-05 18.28.02.jpg\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fec627db7-a43f-1f7a-5dd8-2ff1ee601271.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f22a6bd58c75dbbd1306807c691dc836\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/ec627db7-a43f-1f7a-5dd8-2ff1ee601271.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fec627db7-a43f-1f7a-5dd8-2ff1ee601271.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=d13c8ddd66fe8fed0b7479deb1acf462 1x\" loading=\"lazy\"></a></p>\n\n<h2>\n<span id=\"script-edit\" class=\"fragment\"></span><a href=\"#script-edit\"><i class=\"fa fa-link\"></i></a>Script Edit</h2>\n\n<p>ツール &gt;&gt; スクリプトエディタ<br>\nからスクリプトエディタに戻って<br>\n実行 &gt;&gt; createGoogleCalendar</p>\n\n<p><a href=\"https://camo.qiitausercontent.com/2a4153197d790cc09718800618aa450bf8f0be83/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f35396565623864322d336539322d366365312d633432332d6639613165666232343433372e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"><img width=\"699\" alt=\"スクリーンショット 2017-03-05 18.32.53.jpg\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F59eeb8d2-3e92-6ce1-c423-f9a1efb24437.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8d985d46070bfe2cd7b23eae078f9b5b\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/59eeb8d2-3e92-6ce1-c423-f9a1efb24437.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F59eeb8d2-3e92-6ce1-c423-f9a1efb24437.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=af1d42f66baa23979287a76cd39a656c 1x\" loading=\"lazy\"></a></p>\n\n<p>作成に時間はかかりますが、カレンダーができました！！！！</p>\n\n<h2>\n<span id=\"google-calendarを見る\" class=\"fragment\"></span><a href=\"#google-calendar%E3%82%92%E8%A6%8B%E3%82%8B\"><i class=\"fa fa-link\"></i></a>Google Calendarを見る</h2>\n\n<p><a href=\"https://camo.qiitausercontent.com/4916c97b1a1b1ffd3ac9989bd24fb252effeab07/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f39343836363936612d343463392d643262352d623963622d3731363631326130656364332e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img width=\"1369\" alt=\"スクリーンショット 2017-03-05 18.36.03.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F9486696a-44c9-d2b5-b9cb-716612a0ecd3.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=ecb263d78fca85990d165aa69c356428\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/9486696a-44c9-d2b5-b9cb-716612a0ecd3.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F9486696a-44c9-d2b5-b9cb-716612a0ecd3.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=ab4bf3281638fa1fddf400cab9e88659 1x\" loading=\"lazy\"></a></p>\n\n<p>これでカレンダーができました！！無事[ △休日出勤 ]も春分の日も出力されてるので作成ができました。<br>\n共有とか削除はカレンダー設定からいろいろいじれます。</p>\n\n<h2>\n<span id=\"蛇足ボタンの追加\" class=\"fragment\"></span><a href=\"#%E8%9B%87%E8%B6%B3%E3%83%9C%E3%82%BF%E3%83%B3%E3%81%AE%E8%BF%BD%E5%8A%A0\"><i class=\"fa fa-link\"></i></a>蛇足ボタンの追加</h2>\n\n<p>挿入 &gt;&gt; 図形描画<br>\n<a href=\"https://camo.qiitausercontent.com/dfe15c2306543345817cd4b3e3037181a5f1c2d2/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f37656635396263362d623732332d653865612d373561312d3464373361393032643662312e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"><img width=\"1213\" alt=\"スクリーンショット 2017-03-05 18.41.19.jpg\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F7ef59bc6-b723-e8ea-75a1-4d73a902d6b1.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1e59e1571ca0e077604080fc7f02edb7\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/7ef59bc6-b723-e8ea-75a1-4d73a902d6b1.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F7ef59bc6-b723-e8ea-75a1-4d73a902d6b1.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=9787a1a46ba8a5c6abdf71242320a3d4 1x\" loading=\"lazy\"></a></p>\n\n<p>ここからボタン作成ができます。</p>\n\n<p>図形右クリック &gt;&gt; 右上のボタン &gt;&gt; スクリプトの割り当て<br>\n<a href=\"https://camo.qiitausercontent.com/06e5b926f0f321bc899ff11508fffcb23e333d15/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f33383931316134652d373631352d373333302d373464622d3531653732306265363563392e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"><img width=\"865\" alt=\"スクリーンショット 2017-03-05 18.42.43.jpg\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F38911a4e-7615-7330-74db-51e720be65c9.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=6069726eda82b14ca97108ae068a0033\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/38911a4e-7615-7330-74db-51e720be65c9.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F38911a4e-7615-7330-74db-51e720be65c9.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=ab8a8b87d5155b54d434e17314dfc052 1x\" loading=\"lazy\"></a></p>\n\n<p>ここで先程つくったスクリプトを割り当てられます。かっこいらない系。<br>\n[ createGoogleCalendar ]　<br>\n[ createByGoogleHoliday ]</p>\n\n<p><a href=\"https://camo.qiitausercontent.com/f381ab8149d898ec3ccd8c60fc8dc961768647bf/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f33333864303862302d613361632d653130352d366361302d6330646466613935616162362e6a706567\" target=\"_blank\" rel=\"nofollow noopener\"><img width=\"869\" alt=\"スクリーンショット 2017-03-05 18.45.05.jpg\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F338d08b0-a3ac-e105-6ca0-c0ddfa95aab6.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=89d4b478f6d5923c788d324a326acbe5\" data-canonical-src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/338d08b0-a3ac-e105-6ca0-c0ddfa95aab6.jpeg\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F338d08b0-a3ac-e105-6ca0-c0ddfa95aab6.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=727580d2092223569f2b45c62475aee1 1x\" loading=\"lazy\"></a></p>\n\n<p>こうするとデータの更新とカレンダーの作成がワンクリックでできるようになります。</p>\n\n<h2>\n<span id=\"以上10分でできる専用カレンダーの作成方法でした\" class=\"fragment\"></span><a href=\"#%E4%BB%A5%E4%B8%8A10%E5%88%86%E3%81%A7%E3%81%A7%E3%81%8D%E3%82%8B%E5%B0%82%E7%94%A8%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC%E3%81%AE%E4%BD%9C%E6%88%90%E6%96%B9%E6%B3%95%E3%81%A7%E3%81%97%E3%81%9F\"><i class=\"fa fa-link\"></i></a>以上、10分でできる専用カレンダーの作成方法でした。</h2>\n\n<p>次はこの自社カレンダーを使って、営業日だけ動くSlackボットの作成がしたい~<br>\nあ、Google Apps Scriptだと、コード10行くらいで定期実行してくれるbotが簡単につくれます。コード編終わって落ち着いたら記事書きます。</p>\n\n<hr>\n\n<h1>\n<span id=\"コード編\" class=\"fragment\"></span><a href=\"#%E3%82%B3%E3%83%BC%E3%83%89%E7%B7%A8\"><i class=\"fa fa-link\"></i></a>コード編</h1>\n\n<p>簡単な解説とかいれていきます。私がGAS知ってからチュートリアル的なサンプル作りつつ、1日くらいで作れたので、ゆっくり丁寧にコードを読みといていけばすぐにGAS書けるようになると思います。</p>\n\n<h2>\n<span id=\"googleカレンダーから日本の祝日の取得方法\" class=\"fragment\"></span><a href=\"#google%E3%82%AB%E3%83%AC%E3%83%B3%E3%83%80%E3%83%BC%E3%81%8B%E3%82%89%E6%97%A5%E6%9C%AC%E3%81%AE%E7%A5%9D%E6%97%A5%E3%81%AE%E5%8F%96%E5%BE%97%E6%96%B9%E6%B3%95\"><i class=\"fa fa-link\"></i></a>Googleカレンダーから日本の祝日の取得方法</h2>\n\n<div class=\"code-frame\" data-lang=\"javascript\">\n<div class=\"code-lang\"><span class=\"bold\">コード.js</span></div>\n<div class=\"highlight\"><pre><code>\n<span class=\"c1\">// Google[日本の祝日]の全日イベントからスプレッドシート作成</span>\n<span class=\"kd\">function</span> <span class=\"nx\">createByGoogleHoliday</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n\n  <span class=\"kd\">var</span> <span class=\"nx\">start</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"mi\">2017</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">);</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">end</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"mi\">2019</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">);</span>\n\n  <span class=\"kd\">var</span> <span class=\"nx\">sheet</span> <span class=\"o\">=</span> <span class=\"nx\">SpreadsheetApp</span><span class=\"p\">.</span><span class=\"nx\">getActiveSheet</span><span class=\"p\">();</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">holidays</span> <span class=\"o\">=</span> <span class=\"nx\">getHoliday</span><span class=\"p\">(</span><span class=\"nx\">start</span><span class=\"p\">,</span> <span class=\"nx\">end</span><span class=\"p\">);</span>\n\n  <span class=\"kd\">var</span> <span class=\"nx\">startRow</span> <span class=\"o\">=</span> <span class=\"mi\">3</span><span class=\"p\">;</span>\n\n  <span class=\"kd\">var</span> <span class=\"nx\">range</span> <span class=\"o\">=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getRange</span><span class=\"p\">(</span><span class=\"nx\">startRow</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"nx\">holidays</span><span class=\"p\">.</span><span class=\"nx\">length</span><span class=\"p\">,</span> <span class=\"nx\">holidays</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">].</span><span class=\"nx\">length</span><span class=\"p\">);</span>\n  <span class=\"nx\">range</span><span class=\"p\">.</span><span class=\"nx\">setValues</span><span class=\"p\">(</span><span class=\"nx\">holidays</span><span class=\"p\">);</span>\n  <span class=\"nx\">range</span><span class=\"p\">.</span><span class=\"nx\">sort</span><span class=\"p\">([{</span><span class=\"na\">column</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"na\">ascending</span><span class=\"p\">:</span> <span class=\"kc\">true</span><span class=\"p\">}]);</span> <span class=\"c1\">// 昇順ソート</span>\n\n<span class=\"p\">}</span>\n\n<span class=\"cm\">/**\n * startDate〜endDateまでの祝日をgoogleカレンダーの「日本の祝日」から取得\n * [日付,祝日名]の多次元配列にした上で返す\n */</span>\n<span class=\"kd\">function</span> <span class=\"nx\">getHoliday</span><span class=\"p\">(</span><span class=\"nx\">start</span><span class=\"p\">,</span> <span class=\"nx\">end</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">cal</span> <span class=\"o\">=</span> <span class=\"nx\">CalendarApp</span><span class=\"p\">.</span><span class=\"nx\">getCalendarById</span><span class=\"p\">(</span><span class=\"dl\">\"</span><span class=\"s2\">ja.japanese#holiday@group.v.calendar.google.com</span><span class=\"dl\">\"</span><span class=\"p\">);</span>\n\n  <span class=\"kd\">var</span> <span class=\"nx\">holidays</span> <span class=\"o\">=</span> <span class=\"nx\">cal</span><span class=\"p\">.</span><span class=\"nx\">getEvents</span><span class=\"p\">(</span><span class=\"nx\">start</span><span class=\"p\">,</span> <span class=\"nx\">end</span><span class=\"p\">);</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">values</span> <span class=\"o\">=</span> <span class=\"p\">[];</span>\n\n  <span class=\"k\">for</span><span class=\"p\">(</span><span class=\"kd\">var</span> <span class=\"nx\">i</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">;</span> <span class=\"nx\">i</span> <span class=\"o\">&lt;</span> <span class=\"nx\">holidays</span><span class=\"p\">.</span><span class=\"nx\">length</span><span class=\"p\">;</span> <span class=\"nx\">i</span><span class=\"o\">++</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"nx\">values</span><span class=\"p\">[</span><span class=\"nx\">i</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"nx\">holidays</span><span class=\"p\">[</span><span class=\"nx\">i</span><span class=\"p\">].</span><span class=\"nx\">getStartTime</span><span class=\"p\">(),</span> <span class=\"nx\">holidays</span><span class=\"p\">[</span><span class=\"nx\">i</span><span class=\"p\">].</span><span class=\"nx\">getTitle</span><span class=\"p\">()];</span>\n  <span class=\"p\">}</span>\n\n  <span class=\"cm\">/**\n   * 追加と削除機能あり\n   * values.push([new Date(\"2017/1/4\"), \"俺の日\"]);\n   * values = deleteHoliday(values, \"2017/1/4\");\n   */</span>\n\n  <span class=\"k\">return</span> <span class=\"nx\">values</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n<span class=\"kd\">function</span> <span class=\"nx\">deleteHoliday</span><span class=\"p\">(</span><span class=\"nx\">values</span><span class=\"p\">,</span> <span class=\"nx\">date</span><span class=\"p\">){</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">target</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"nx\">date</span><span class=\"p\">);</span>\n  <span class=\"nx\">values</span><span class=\"p\">.</span><span class=\"nx\">some</span><span class=\"p\">(</span><span class=\"kd\">function</span><span class=\"p\">(</span><span class=\"nx\">v</span><span class=\"p\">,</span> <span class=\"nx\">i</span><span class=\"p\">){</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">Date</span><span class=\"p\">.</span><span class=\"nx\">parse</span><span class=\"p\">(</span><span class=\"nx\">v</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">])</span> <span class=\"o\">==</span> <span class=\"nb\">Date</span><span class=\"p\">.</span><span class=\"nx\">parse</span><span class=\"p\">(</span><span class=\"nx\">target</span><span class=\"p\">))</span> <span class=\"nx\">values</span><span class=\"p\">.</span><span class=\"nx\">splice</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">);</span>\n  <span class=\"p\">});</span>\n  <span class=\"k\">return</span> <span class=\"nx\">values</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n\n</code></pre></div>\n</div>\n\n<h3>\n<span id=\"function-createbygoogleholiday\" class=\"fragment\"></span><a href=\"#function-createbygoogleholiday\"><i class=\"fa fa-link\"></i></a><code>function createByGoogleHoliday()</code>\n</h3>\n\n<div class=\"code-frame\" data-lang=\"js\"><div class=\"highlight\"><pre><code><span class=\"kd\">var</span> <span class=\"nx\">start</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"mi\">2017</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">);</span>\n<span class=\"kd\">var</span> <span class=\"nx\">end</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"mi\">2019</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">);</span>\n</code></pre></div></div>\n\n<p>Googleの日本の祝日だと2年分くらいしか取得することができないので、この期間で設定しています。<br>\nまたミリ秒までセットしている理由は、<code>deleteHoliday()</code>の部分でミリ秒まで同じなら削除をするみたいな判定しているからです。(ここ書き方わかんなくて適当に実装しました。アドバイスいただけたらうれしいです。)</p>\n\n<div class=\"code-frame\" data-lang=\"js\"><div class=\"highlight\"><pre><code><span class=\"kd\">var</span> <span class=\"nx\">sheet</span> <span class=\"o\">=</span> <span class=\"nx\">SpreadsheetApp</span><span class=\"p\">.</span><span class=\"nx\">getActiveSheet</span><span class=\"p\">();</span>\n</code></pre></div></div>\n\n<p>こちらスプレッドシート上のGASから操作しているので簡単にシートのオブジェクトがとれます。<br>\n別のGASからでも<code>SpreadsheetApp.openByUrl(SHEET_URL)</code>とかを使えばオブジェクトを取ってこれます。もしくはopenByIdとか。</p>\n\n<div class=\"code-frame\" data-lang=\"js\"><div class=\"highlight\"><pre><code><span class=\"kd\">var</span> <span class=\"nx\">holidays</span> <span class=\"o\">=</span> <span class=\"nx\">getHoliday</span><span class=\"p\">(</span><span class=\"nx\">start</span><span class=\"p\">,</span> <span class=\"nx\">end</span><span class=\"p\">);</span>\n</code></pre></div></div>\n\n<p>後で書きますがgetHoliday関数で、ある期間の祝日を、日付とタイトルの配列として返します。<code>[[日付, タイトル], [日付2, タイトル2]]</code>こんな感じ。</p>\n\n<div class=\"code-frame\" data-lang=\"js\"><div class=\"highlight\"><pre><code><span class=\"kd\">var</span> <span class=\"nx\">startRow</span> <span class=\"o\">=</span> <span class=\"mi\">3</span><span class=\"p\">;</span>\n</code></pre></div></div>\n\n<p>今回は3行目からデータを挿入していくので。</p>\n\n<div class=\"code-frame\" data-lang=\"js\"><div class=\"highlight\"><pre><code><span class=\"kd\">var</span> <span class=\"nx\">range</span> <span class=\"o\">=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getRange</span><span class=\"p\">(</span><span class=\"nx\">startRow</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"nx\">holidays</span><span class=\"p\">.</span><span class=\"nx\">length</span><span class=\"p\">,</span> <span class=\"nx\">holidays</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">].</span><span class=\"nx\">length</span><span class=\"p\">);</span>\n<span class=\"nx\">range</span><span class=\"p\">.</span><span class=\"nx\">setValues</span><span class=\"p\">(</span><span class=\"nx\">holidays</span><span class=\"p\">);</span>\n<span class=\"nx\">range</span><span class=\"p\">.</span><span class=\"nx\">sort</span><span class=\"p\">([{</span><span class=\"na\">column</span><span class=\"p\">:</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"na\">ascending</span><span class=\"p\">:</span> <span class=\"kc\">true</span><span class=\"p\">}]);</span> <span class=\"c1\">// 昇順ソート</span>\n</code></pre></div></div>\n\n<p>まず範囲オブジェクトを作ります。配列の行列と範囲オブジェクトを対応させて、下の表の3行目(日付、タイトルの下)から、値をrange.setValues(holidays)で一気に入れます。</p>\n\n<table>\n<thead>\n<tr>\n<th style=\"text-align: center\">1</th>\n<th style=\"text-align: center\">2</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align: center\">Googleからの取得</td>\n<td style=\"text-align: center\"></td>\n</tr>\n<tr>\n<td style=\"text-align: center\">日付</td>\n<td style=\"text-align: center\">タイトル</td>\n</tr>\n<tr>\n<td style=\"text-align: center\">day1</td>\n<td style=\"text-align: center\">title1</td>\n</tr>\n<tr>\n<td style=\"text-align: center\">day2</td>\n<td style=\"text-align: center\">title2</td>\n</tr>\n<tr>\n<td style=\"text-align: center\">day3</td>\n<td style=\"text-align: center\">title3</td>\n</tr>\n<tr>\n<td style=\"text-align: center\">day4</td>\n<td style=\"text-align: center\">title4</td>\n</tr>\n<tr>\n<td style=\"text-align: center\">day5</td>\n<td style=\"text-align: center\">title5</td>\n</tr>\n<tr>\n<td style=\"text-align: center\">day6</td>\n<td style=\"text-align: center\">title6</td>\n</tr>\n</tbody>\n</table>\n\n<p>そして<code>range.sort([{column: 1, ascending: true}])</code>でソートしてます。(実は削除も追加もしなかったらもともと昇順です)<br>\ncolumn: で何列目を基準にするか<br>\nascending: trueが昇順、falseが降順</p>\n\n<h3>\n<span id=\"function-getholidaystart-end-\" class=\"fragment\"></span><a href=\"#function-getholidaystart-end-\"><i class=\"fa fa-link\"></i></a>function getHoliday(start, end) {}</h3>\n\n<div class=\"code-frame\" data-lang=\"js\"><div class=\"highlight\"><pre><code><span class=\"kd\">function</span> <span class=\"nx\">getHoliday</span><span class=\"p\">(</span><span class=\"nx\">start</span><span class=\"p\">,</span> <span class=\"nx\">end</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">cal</span> <span class=\"o\">=</span> <span class=\"nx\">CalendarApp</span><span class=\"p\">.</span><span class=\"nx\">getCalendarById</span><span class=\"p\">(</span><span class=\"dl\">\"</span><span class=\"s2\">ja.japanese#holiday@group.v.calendar.google.com</span><span class=\"dl\">\"</span><span class=\"p\">);</span>\n\n  <span class=\"kd\">var</span> <span class=\"nx\">holidays</span> <span class=\"o\">=</span> <span class=\"nx\">cal</span><span class=\"p\">.</span><span class=\"nx\">getEvents</span><span class=\"p\">(</span><span class=\"nx\">start</span><span class=\"p\">,</span> <span class=\"nx\">end</span><span class=\"p\">);</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">values</span> <span class=\"o\">=</span> <span class=\"p\">[];</span>\n\n  <span class=\"k\">for</span><span class=\"p\">(</span><span class=\"kd\">var</span> <span class=\"nx\">i</span> <span class=\"o\">=</span> <span class=\"mi\">0</span><span class=\"p\">;</span> <span class=\"nx\">i</span> <span class=\"o\">&lt;</span> <span class=\"nx\">holidays</span><span class=\"p\">.</span><span class=\"nx\">length</span><span class=\"p\">;</span> <span class=\"nx\">i</span><span class=\"o\">++</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"nx\">values</span><span class=\"p\">[</span><span class=\"nx\">i</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"nx\">holidays</span><span class=\"p\">[</span><span class=\"nx\">i</span><span class=\"p\">].</span><span class=\"nx\">getStartTime</span><span class=\"p\">(),</span> <span class=\"nx\">holidays</span><span class=\"p\">[</span><span class=\"nx\">i</span><span class=\"p\">].</span><span class=\"nx\">getTitle</span><span class=\"p\">()];</span>\n  <span class=\"p\">}</span>\n\n  <span class=\"cm\">/**\n   * 追加と削除機能あり\n   * values.push([new Date(\"2017/1/4\"), \"俺の日\"]);\n   * values = deleteHoliday(values, \"2017/1/4\");\n   */</span>\n\n  <span class=\"k\">return</span> <span class=\"nx\">values</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<ul>\n<li>(start, end)で範囲指定する</li>\n<li>CalendarApp.getCalendarByIdで[日本の祝日]を取得</li>\n<li>cal.getEvents(start, end)で[ 日本の祝日 ]のイベント取得\n\n<ul>\n<li>単数データにすると</li>\n<li>.getStartTime()で始まる時間</li>\n<li>.getTitle()でタイトルを取得できるようになる</li>\n</ul>\n</li>\n<li>ここで追加したい時は配列にプッシュするだけ</li>\n<li>deleteHolidayは関数として実装</li>\n</ul>\n\n<h3>\n<span id=\"function-deleteholidayvalues-date\" class=\"fragment\"></span><a href=\"#function-deleteholidayvalues-date\"><i class=\"fa fa-link\"></i></a>function deleteHoliday(values, date){}</h3>\n\n<div class=\"code-frame\" data-lang=\"js\"><div class=\"highlight\"><pre><code><span class=\"kd\">function</span> <span class=\"nx\">deleteHoliday</span><span class=\"p\">(</span><span class=\"nx\">values</span><span class=\"p\">,</span> <span class=\"nx\">date</span><span class=\"p\">){</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">target</span> <span class=\"o\">=</span> <span class=\"k\">new</span> <span class=\"nb\">Date</span><span class=\"p\">(</span><span class=\"nx\">date</span><span class=\"p\">);</span>\n  <span class=\"nx\">values</span><span class=\"p\">.</span><span class=\"nx\">some</span><span class=\"p\">(</span><span class=\"kd\">function</span><span class=\"p\">(</span><span class=\"nx\">v</span><span class=\"p\">,</span> <span class=\"nx\">i</span><span class=\"p\">){</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nb\">Date</span><span class=\"p\">.</span><span class=\"nx\">parse</span><span class=\"p\">(</span><span class=\"nx\">v</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">])</span> <span class=\"o\">==</span> <span class=\"nb\">Date</span><span class=\"p\">.</span><span class=\"nx\">parse</span><span class=\"p\">(</span><span class=\"nx\">target</span><span class=\"p\">))</span> <span class=\"nx\">values</span><span class=\"p\">.</span><span class=\"nx\">splice</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">,</span><span class=\"mi\">1</span><span class=\"p\">);</span>\n  <span class=\"p\">});</span>\n  <span class=\"k\">return</span> <span class=\"nx\">values</span><span class=\"p\">;</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>詳細はJavaScriptのsomeを。<br>\ntargetに消したい日のDateオブジェクトを。<br>\nvaluesには[ 日本の祝日 ]データが入っているので、それをすべて検索<br>\n[ Dateオブジェクト, title ]という形式なのでv[0]<br>\nDate.parse()でDate型を変換して比較できるようにしている(もっと良い書き方あるはず)</p>\n\n<h3>\n<span id=\"function-creategooglecalendar\" class=\"fragment\"></span><a href=\"#function-creategooglecalendar\"><i class=\"fa fa-link\"></i></a>function createGoogleCalendar(){}</h3>\n\n<div class=\"code-frame\" data-lang=\"javascript\">\n<div class=\"code-lang\"><span class=\"bold\">function.js</span></div>\n<div class=\"highlight\"><pre><code><span class=\"kd\">function</span> <span class=\"nx\">createGoogleCalendar</span><span class=\"p\">(){</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">title</span><span class=\"p\">,</span> <span class=\"nx\">date</span><span class=\"p\">;</span>\n\n  <span class=\"c1\">// カレンダー名の取得</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">sheet</span> <span class=\"o\">=</span> <span class=\"nx\">SpreadsheetApp</span><span class=\"p\">.</span><span class=\"nx\">getActiveSheet</span><span class=\"p\">();</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">calendarName</span> <span class=\"o\">=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getRange</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">).</span><span class=\"nx\">getValue</span><span class=\"p\">();</span>\n\n  <span class=\"c1\">// カレンダーの作成と、オブジェクトcalの生成</span>\n  <span class=\"kd\">var</span> <span class=\"nx\">cal</span> <span class=\"o\">=</span> <span class=\"nx\">CalendarApp</span><span class=\"p\">.</span><span class=\"nx\">createCalendar</span><span class=\"p\">(</span><span class=\"nx\">calendarName</span><span class=\"p\">);</span>\n\n  <span class=\"c1\">// Google[日本の祝日]の全日イベントの追加</span>\n  <span class=\"k\">for</span> <span class=\"p\">(</span><span class=\"kd\">var</span> <span class=\"nx\">i</span> <span class=\"o\">=</span> <span class=\"mi\">3</span><span class=\"p\">;</span> <span class=\"nx\">i</span> <span class=\"o\">&lt;=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getLastRow</span><span class=\"p\">();</span> <span class=\"nx\">i</span><span class=\"o\">++</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"nx\">title</span> <span class=\"o\">=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getRange</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">).</span><span class=\"nx\">getValue</span><span class=\"p\">();</span>\n    <span class=\"nx\">date</span> <span class=\"o\">=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getRange</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">).</span><span class=\"nx\">getValue</span><span class=\"p\">();</span>\n<span class=\"err\">　　</span><span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">title</span><span class=\"o\">==</span><span class=\"dl\">\"\"</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nx\">date</span> <span class=\"o\">==</span> <span class=\"dl\">\"\"</span><span class=\"p\">)</span> <span class=\"k\">break</span><span class=\"p\">;</span>\n    <span class=\"nx\">cal</span><span class=\"p\">.</span><span class=\"nx\">createAllDayEvent</span><span class=\"p\">(</span><span class=\"nx\">title</span><span class=\"p\">,</span> <span class=\"nx\">date</span><span class=\"p\">);</span>\n  <span class=\"p\">}</span>\n\n  <span class=\"c1\">// [手動追加]の全日イベントの追加</span>\n  <span class=\"k\">for</span> <span class=\"p\">(</span><span class=\"kd\">var</span> <span class=\"nx\">i</span> <span class=\"o\">=</span> <span class=\"mi\">3</span><span class=\"p\">;</span> <span class=\"nx\">i</span> <span class=\"o\">&lt;=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getLastRow</span><span class=\"p\">();</span> <span class=\"nx\">i</span><span class=\"o\">++</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"nx\">title</span> <span class=\"o\">=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getRange</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">).</span><span class=\"nx\">getValue</span><span class=\"p\">();</span>\n    <span class=\"nx\">date</span> <span class=\"o\">=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getRange</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">).</span><span class=\"nx\">getValue</span><span class=\"p\">();</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">title</span><span class=\"o\">==</span><span class=\"dl\">\"\"</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nx\">date</span> <span class=\"o\">==</span> <span class=\"dl\">\"\"</span><span class=\"p\">)</span> <span class=\"k\">break</span><span class=\"p\">;</span>\n    <span class=\"nx\">cal</span><span class=\"p\">.</span><span class=\"nx\">createAllDayEvent</span><span class=\"p\">(</span><span class=\"nx\">title</span><span class=\"p\">,</span> <span class=\"nx\">date</span><span class=\"p\">);</span>\n  <span class=\"p\">}</span>  \n<span class=\"p\">}</span>\n</code></pre></div>\n</div>\n\n<p>まずはこちら。</p>\n\n<div class=\"code-frame\" data-lang=\"js\"><div class=\"highlight\"><pre><code><span class=\"kd\">var</span> <span class=\"nx\">sheet</span> <span class=\"o\">=</span> <span class=\"nx\">SpreadsheetApp</span><span class=\"p\">.</span><span class=\"nx\">getActiveSheet</span><span class=\"p\">();</span>\n<span class=\"kd\">var</span> <span class=\"nx\">calendarName</span> <span class=\"o\">=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getRange</span><span class=\"p\">(</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">).</span><span class=\"nx\">getValue</span><span class=\"p\">();</span>\n<span class=\"kd\">var</span> <span class=\"nx\">cal</span> <span class=\"o\">=</span> <span class=\"nx\">CalendarApp</span><span class=\"p\">.</span><span class=\"nx\">createCalendar</span><span class=\"p\">(</span><span class=\"nx\">calendarName</span><span class=\"p\">);</span>\n</code></pre></div></div>\n\n<p>現在のアクティブシートからシートオブジェクトを作成して<br>\nカレンダー名を2行5列のとこから取得して、カレンダーを作成</p>\n\n<div class=\"code-frame\" data-lang=\"js\"><div class=\"highlight\"><pre><code>  <span class=\"k\">for</span> <span class=\"p\">(</span><span class=\"kd\">var</span> <span class=\"nx\">i</span> <span class=\"o\">=</span> <span class=\"mi\">3</span><span class=\"p\">;</span> <span class=\"nx\">i</span> <span class=\"o\">&lt;=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getLastRow</span><span class=\"p\">();</span> <span class=\"nx\">i</span><span class=\"o\">++</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"nx\">title</span> <span class=\"o\">=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getRange</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">).</span><span class=\"nx\">getValue</span><span class=\"p\">();</span>\n    <span class=\"nx\">date</span> <span class=\"o\">=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nx\">getRange</span><span class=\"p\">(</span><span class=\"nx\">i</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">).</span><span class=\"nx\">getValue</span><span class=\"p\">();</span>\n    <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">title</span><span class=\"o\">==</span><span class=\"dl\">\"\"</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nx\">date</span> <span class=\"o\">==</span> <span class=\"dl\">\"\"</span><span class=\"p\">)</span> <span class=\"k\">break</span><span class=\"p\">;</span>\n    <span class=\"nx\">cal</span><span class=\"p\">.</span><span class=\"nx\">createAllDayEvent</span><span class=\"p\">(</span><span class=\"nx\">title</span><span class=\"p\">,</span> <span class=\"nx\">date</span><span class=\"p\">);</span>\n  <span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p>3行目からシートの最終行まで繰り返す処理<br>\nタイトルを2列目から<br>\n日付を1列目から所得して<br>\nもしどちらも空白ならfor文終了<br>\nタイトルと日付を使って全日イベントを作成。</p>\n\n<h1>\n<span id=\"google-apps-script\" class=\"fragment\"></span><a href=\"#google-apps-script\"><i class=\"fa fa-link\"></i></a>Google Apps Script</h1>\n\n<p>GASはいかがでしたか。かなり便利でいろんな機能が使えそうだと思ってます。</p>\n\n<p>シンタックスハイライト追加プルリクありがとうございます。追加しました！！</p>\n\n<p>.</p>\n","body":"\nなんか公式のやり方があるっぽいのでメモがてら書いておく。\n\nhttps://cloud.google.com/blog/products/g-suite/g-suite-pro-tip-how-to-automatically-add-a-schedule-from-google-sheets-into-calendar\n\n# Google Apps Script [GAS] ガチ勢3日目\nGoogle Apps Scriptすげえ！楽しい！ってなって3日目です。\nこのScript便利だよ、自社のJavaScript書けるエンジニアさんの大切な時間を奪えば~~なんだって~~いろいろできるよって話をしていきます。\n\n##内容\n* 完成品の確認\n* コピペ編\n* コード編\n\n以上3つで構成しようと思っています。\n\n# 完成品の確認\nマイカレンダー >> [ ◯◯株式会社 ] これを作ります。\n<img width=\"1293\" alt=\"スクリーンショット 2017-03-05 16.40.22.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/8de4c6f7-a758-f382-75fe-ce61780f7437.jpeg\">\n## POINT\nGoogleの[ 日本の祝日 ]を元として、自社だけの[ 創立記念日 ]とか[ ~~△休日出勤~~ ]\nとか追加したカレンダーが作れます。\n作るだけならコピペで10分くらいで作れるかと思います。\n一度このスクリプトに慣れれば[声優さんイベントカレンダー]とか[アイドルライブカレンダー]とか[◯◯イベントカレンダー]とかをすぐ作れるようになれます。私、某J系アイドルのコンサート日程をGoogleマイカレンダーに登録しているんですけど、普段は非表示(今日は◯でライブか…いきたい！！ってならないように。)必要なときに表示にしています。\n\n## 使用するサイト・技術など\n* Google Apps(スプレッドシート、カレンダー)を使うので、Googleアカウント\n* Google Apps Script( ≒ JavaScript)\n\n## カレンダーを作成した後の発展先\n後でQiita公開しようと思ってる記事\n> 自社の営業日だけSlackに投稿したりするボット作成\nこれに似たのさっき公開しました[最終営業日に月末の報告しっかりしろよってSlackに投げるやつ](http://qiita.com/ykhirao/items/782e20ab0465533c48f6)\n\n```省略しまくってます.js\nCalendarApp.getCalendarById();\nholidays = cal.getEvents();\nreturn holidays.length != 0;\n```\n自社カレンダーがあるとこれくらいのコード量で、[ 自社が休みかどうか ]の営業日判定がすごくやりやすくなります。\n詳しくはこちら[GoogleAppsScriptで日本の祝日を取得する](http://qiita.com/kamatama_41/items/be40e05524530920a9d9)\n\n> スクレイピングしてせっせとカレンダー作りまくる\n\n先程の[ [◯◯株式会社](https://calendar.google.com/calendar/embed?src=2mjt9uiftvsjtqrrt2tdtq89do%40group.calendar.google.com&ctz=Asia/Tokyo)のカレンダー ]\n<img width=\"862\" alt=\"スクリーンショット 2017-03-05 17.47.10.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/3b866b96-d458-4040-42dc-4ea806275ce9.jpeg\">\n\n実は一般公開も簡単で、趣味のイベント情報の管理人にもすぐなれます。画像右下の[ + Google Calendar ]からカレンダーの追加もすぐできます。趣味友のためにイベント情報ちょっとスクレイピングしてくるわ(どやっ)ってしてくれるといいですね。\n\n# コピペ編\n\n## スプレッドシート作成\n[Google Drive](https://drive.google.com/drive/my-drive)からスプレッドシートを作成してください。\n<img width=\"1145\" alt=\"スクリーンショット 2017-03-05 17.54.17.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/cacc47b2-c845-822b-19ec-bad7bbb8ee1c.jpeg\">\n\n## 表のスタイルをあわせる\n\n| 1 | 2 | 3 | 4 | 5 |\n|:-:|:-:|:-:|:-:|:-:|\n| Googleカレンダーからの取得 |  | 手動追加 |  | カレンダーの名前 |\n| 日付  |  タイトル | 日付  |  タイトル | ◯◯株式会社  |\nまずこちらをコピーして、[ 値のみ貼り付け ]をして、図のような形式にしてください。\n<img width=\"606\" alt=\"スクリーンショット 2017-03-05 18.01.38.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/e705475b-2f77-187c-07d1-2fe5eb68c89b.jpeg\">\n\n## スクリプトエディタを開く\nツール >> スクリプトエディタ \nこちらをクリック。\n<img width=\"602\" alt=\"スクリーンショット 2017-03-05 18.04.38.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/6c4f950a-b088-9bb1-261f-fcb1c7350d41.jpeg\">\n\n## スクリプトエディタにコードを貼り付ける\n<img width=\"784\" alt=\"スクリーンショット 2017-03-05 18.08.15.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/c7dd83d1-6299-90b8-c372-fba586be855b.jpeg\">\n1. 左上の名前変更\n1. コード.gsに以下のコードをコピペ\n\n```js\nfunction createGoogleCalendar(){\n  var title, date;\n  \n  // カレンダー名の取得\n  var sheet = SpreadsheetApp.getActiveSheet();\n  var calendarName = sheet.getRange(2, 5).getValue();\n  \n  // カレンダーの作成と、オブジェクトcalの生成\n  var cal = CalendarApp.createCalendar(calendarName);\n  \n  // Google[日本の祝日]の全日イベントの追加\n  for (var i = 3; i <= sheet.getLastRow(); i++) {\n    title = sheet.getRange(i, 2).getValue();\n    date = sheet.getRange(i, 1).getValue();\n　　　　　　　　if (title==\"\" && date == \"\") break;\n    cal.createAllDayEvent(title, date);\n  }\n  \n  // [手動追加]の全日イベントの追加\n  for (var i = 3; i <= sheet.getLastRow(); i++) {\n    title = sheet.getRange(i, 4).getValue();\n    date = sheet.getRange(i, 3).getValue();\n    if (title==\"\" && date == \"\") break;\n    cal.createAllDayEvent(title, date);\n  }  \n}\n\n// Google[日本の祝日]の全日イベントからスプレッドシート作成\nfunction createByGoogleHoliday() {\n\n  var start = new Date(2017, 0, 1, 0, 0, 0, 0);\n  var end = new Date(2019, 0, 1, 0, 0, 0, 0);\n\n  var sheet = SpreadsheetApp.getActiveSheet();\n  var holidays = getHoliday(start, end);\n\n  var startRow = 3;\n\n  var range = sheet.getRange(startRow, 1, holidays.length, holidays[0].length);\n  range.setValues(holidays);\n  range.sort([{column: 1, ascending: true}]); // 昇順ソート\n  \n}\n\n/**\n * startDate〜endDateまでの祝日をgoogleカレンダーの「日本の祝日」から取得\n * [日付,祝日名]の多次元配列にした上で返す\n */\nfunction getHoliday(start, end) {\n  var cal = CalendarApp.getCalendarById(\"ja.japanese#holiday@group.v.calendar.google.com\");\n\n  var holidays = cal.getEvents(start, end);\n  var values = [];\n\n  for(var i = 0; i < holidays.length; i++) {\n    values[i] = [holidays[i].getStartTime(), holidays[i].getTitle()];\n  }\n  \n  /**\n   * 追加と削除機能あり\n   * values.push([new Date(\"2017/1/4\"), \"俺の日\"]);\n   * values = deleteHoliday(values, \"2017/1/4\");\n   */\n  \n  return values;\n}\n\nfunction deleteHoliday(values, date){\n  var target = new Date(date);\n  values.some(function(v, i){\n    if (Date.parse(v[0]) == Date.parse(target)) values.splice(i,1);\n  });\n  return values;\n}\n\n```\n\n今回は自動化はしていませんが、コードはこちらの記事[ [google spread sheetに自動更新される日本の祝日シートを作る](http://qiita.com/ik-fib/items/6c35640954c2b04a9287) \\]から3割くらいお借りしています。月に一度の自動更新で正確に祝日カレンダーをGoogleから同期させられる手法なのでぜひ読んでみてください。追加点は`コード内でイベントの追加と削除機能を実装`と`ソート機能`と`スプレッドシートからのカレンダー作成`です。\n\n## コードの実行\n実行 >> `createByGoogleHoliday`\n\n<img width=\"711\" alt=\"スクリーンショット 2017-03-05 18.21.25.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/daaa1aec-0f01-fe75-66d4-35d93cb8c8ee.jpeg\">\nこのスクリプトからスプレッドシートなどのGoogle Appsへのアクセス許可を聞かれるのでOKしてください。\n\n## スプレッドシートに戻ってみる\nこんな感じでGoogleカレンダーから取得できてると正解\n\n<img width=\"701\" alt=\"スクリーンショット 2017-03-05 18.24.17.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/01443978-82f9-fac8-c957-de216d55e5b9.jpeg\">\n\n## 手作業入力\n* 手動追記 >> 日付とタイトル\n    * 一応どちらも入力してください\n    * 空白行があるとそこで終了\n* カレンダーの名前 >> 私の会社\n    * 私の会社の部分がカレンダーのタイトルになります。\n\n<img width=\"670\" alt=\"スクリーンショット 2017-03-05 18.28.02.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/ec627db7-a43f-1f7a-5dd8-2ff1ee601271.jpeg\">\n\n## Script Edit\n\nツール >> スクリプトエディタ\nからスクリプトエディタに戻って\n実行 >> createGoogleCalendar\n\n<img width=\"699\" alt=\"スクリーンショット 2017-03-05 18.32.53.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/59eeb8d2-3e92-6ce1-c423-f9a1efb24437.jpeg\">\n\n作成に時間はかかりますが、カレンダーができました！！！！\n\n## Google Calendarを見る\n<img width=\"1369\" alt=\"スクリーンショット 2017-03-05 18.36.03.png\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/9486696a-44c9-d2b5-b9cb-716612a0ecd3.png\">\n\nこれでカレンダーができました！！無事[ △休日出勤 ]も春分の日も出力されてるので作成ができました。\n共有とか削除はカレンダー設定からいろいろいじれます。\n\n## 蛇足ボタンの追加\n挿入 >> 図形描画\n<img width=\"1213\" alt=\"スクリーンショット 2017-03-05 18.41.19.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/7ef59bc6-b723-e8ea-75a1-4d73a902d6b1.jpeg\">\n\nここからボタン作成ができます。\n\n図形右クリック >> 右上のボタン >> スクリプトの割り当て\n<img width=\"865\" alt=\"スクリーンショット 2017-03-05 18.42.43.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/38911a4e-7615-7330-74db-51e720be65c9.jpeg\">\n\nここで先程つくったスクリプトを割り当てられます。かっこいらない系。\n[ createGoogleCalendar ]　\n[ createByGoogleHoliday ]\n\n<img width=\"869\" alt=\"スクリーンショット 2017-03-05 18.45.05.jpg\" src=\"https://qiita-image-store.s3.amazonaws.com/0/112929/338d08b0-a3ac-e105-6ca0-c0ddfa95aab6.jpeg\">\n\nこうするとデータの更新とカレンダーの作成がワンクリックでできるようになります。\n\n## 以上、10分でできる専用カレンダーの作成方法でした。\n\n次はこの自社カレンダーを使って、営業日だけ動くSlackボットの作成がしたい~\nあ、Google Apps Scriptだと、コード10行くらいで定期実行してくれるbotが簡単につくれます。コード編終わって落ち着いたら記事書きます。\n\n***\n# コード編\n簡単な解説とかいれていきます。私がGAS知ってからチュートリアル的なサンプル作りつつ、1日くらいで作れたので、ゆっくり丁寧にコードを読みといていけばすぐにGAS書けるようになると思います。\n\n## Googleカレンダーから日本の祝日の取得方法\n\n```コード.js\n\n// Google[日本の祝日]の全日イベントからスプレッドシート作成\nfunction createByGoogleHoliday() {\n\n  var start = new Date(2017, 0, 1, 0, 0, 0, 0);\n  var end = new Date(2019, 0, 1, 0, 0, 0, 0);\n\n  var sheet = SpreadsheetApp.getActiveSheet();\n  var holidays = getHoliday(start, end);\n\n  var startRow = 3;\n\n  var range = sheet.getRange(startRow, 1, holidays.length, holidays[0].length);\n  range.setValues(holidays);\n  range.sort([{column: 1, ascending: true}]); // 昇順ソート\n  \n}\n\n/**\n * startDate〜endDateまでの祝日をgoogleカレンダーの「日本の祝日」から取得\n * [日付,祝日名]の多次元配列にした上で返す\n */\nfunction getHoliday(start, end) {\n  var cal = CalendarApp.getCalendarById(\"ja.japanese#holiday@group.v.calendar.google.com\");\n\n  var holidays = cal.getEvents(start, end);\n  var values = [];\n\n  for(var i = 0; i < holidays.length; i++) {\n    values[i] = [holidays[i].getStartTime(), holidays[i].getTitle()];\n  }\n  \n  /**\n   * 追加と削除機能あり\n   * values.push([new Date(\"2017/1/4\"), \"俺の日\"]);\n   * values = deleteHoliday(values, \"2017/1/4\");\n   */\n  \n  return values;\n}\n\nfunction deleteHoliday(values, date){\n  var target = new Date(date);\n  values.some(function(v, i){\n    if (Date.parse(v[0]) == Date.parse(target)) values.splice(i,1);\n  });\n  return values;\n}\n\n```\n\n### `function createByGoogleHoliday()`\n\n```js\nvar start = new Date(2017, 0, 1, 0, 0, 0, 0);\nvar end = new Date(2019, 0, 1, 0, 0, 0, 0);\n```\n\nGoogleの日本の祝日だと2年分くらいしか取得することができないので、この期間で設定しています。\nまたミリ秒までセットしている理由は、`deleteHoliday()`の部分でミリ秒まで同じなら削除をするみたいな判定しているからです。(ここ書き方わかんなくて適当に実装しました。アドバイスいただけたらうれしいです。)\n\n```js\nvar sheet = SpreadsheetApp.getActiveSheet();\n```\n\nこちらスプレッドシート上のGASから操作しているので簡単にシートのオブジェクトがとれます。\n別のGASからでも`SpreadsheetApp.openByUrl(SHEET_URL)`とかを使えばオブジェクトを取ってこれます。もしくはopenByIdとか。\n\n```js\nvar holidays = getHoliday(start, end);\n```\n後で書きますがgetHoliday関数で、ある期間の祝日を、日付とタイトルの配列として返します。`[[日付, タイトル], [日付2, タイトル2]]`こんな感じ。\n\n```js\nvar startRow = 3;\n```\n\n今回は3行目からデータを挿入していくので。\n\n```js\nvar range = sheet.getRange(startRow, 1, holidays.length, holidays[0].length);\nrange.setValues(holidays);\nrange.sort([{column: 1, ascending: true}]); // 昇順ソート\n```\n\nまず範囲オブジェクトを作ります。配列の行列と範囲オブジェクトを対応させて、下の表の3行目(日付、タイトルの下)から、値をrange.setValues(holidays)で一気に入れます。\n\n| 1 | 2 |\n|:-:|:-:|\n| Googleからの取得  |  |\n| 日付  | タイトル  |\n| day1  |  title1 |\n| day2  |  title2 |\n| day3  |  title3 |\n| day4  |  title4 |\n| day5  |  title5 |\n| day6  |  title6 |\n\n\nそして`range.sort([{column: 1, ascending: true}])`でソートしてます。(実は削除も追加もしなかったらもともと昇順です)\ncolumn: で何列目を基準にするか\nascending: trueが昇順、falseが降順\n\n### function getHoliday(start, end) {}\n\n```js\nfunction getHoliday(start, end) {\n  var cal = CalendarApp.getCalendarById(\"ja.japanese#holiday@group.v.calendar.google.com\");\n\n  var holidays = cal.getEvents(start, end);\n  var values = [];\n\n  for(var i = 0; i < holidays.length; i++) {\n    values[i] = [holidays[i].getStartTime(), holidays[i].getTitle()];\n  }\n\n  /**\n   * 追加と削除機能あり\n   * values.push([new Date(\"2017/1/4\"), \"俺の日\"]);\n   * values = deleteHoliday(values, \"2017/1/4\");\n   */\n\n  return values;\n}\n```\n\n* (start, end)で範囲指定する\n* CalendarApp.getCalendarByIdで[日本の祝日]を取得\n* cal.getEvents(start, end)で[ 日本の祝日 ]のイベント取得\n    * 単数データにすると\n    * .getStartTime()で始まる時間\n    * .getTitle()でタイトルを取得できるようになる\n* ここで追加したい時は配列にプッシュするだけ\n* deleteHolidayは関数として実装\n\n\n### function deleteHoliday(values, date){}\n\n```js\nfunction deleteHoliday(values, date){\n  var target = new Date(date);\n  values.some(function(v, i){\n    if (Date.parse(v[0]) == Date.parse(target)) values.splice(i,1);\n  });\n  return values;\n}\n```\n\n詳細はJavaScriptのsomeを。\ntargetに消したい日のDateオブジェクトを。\nvaluesには[ 日本の祝日 ]データが入っているので、それをすべて検索\n[ Dateオブジェクト, title ]という形式なのでv[0]\nDate.parse()でDate型を変換して比較できるようにしている(もっと良い書き方あるはず)\n\n### function createGoogleCalendar(){}\n\n```function.js\nfunction createGoogleCalendar(){\n  var title, date;\n\n  // カレンダー名の取得\n  var sheet = SpreadsheetApp.getActiveSheet();\n  var calendarName = sheet.getRange(2, 5).getValue();\n\n  // カレンダーの作成と、オブジェクトcalの生成\n  var cal = CalendarApp.createCalendar(calendarName);\n\n  // Google[日本の祝日]の全日イベントの追加\n  for (var i = 3; i <= sheet.getLastRow(); i++) {\n    title = sheet.getRange(i, 2).getValue();\n    date = sheet.getRange(i, 1).getValue();\n　　if (title==\"\" && date == \"\") break;\n    cal.createAllDayEvent(title, date);\n  }\n\n  // [手動追加]の全日イベントの追加\n  for (var i = 3; i <= sheet.getLastRow(); i++) {\n    title = sheet.getRange(i, 4).getValue();\n    date = sheet.getRange(i, 3).getValue();\n    if (title==\"\" && date == \"\") break;\n    cal.createAllDayEvent(title, date);\n  }  \n}\n```\n\nまずはこちら。\n\n```js\nvar sheet = SpreadsheetApp.getActiveSheet();\nvar calendarName = sheet.getRange(2, 5).getValue();\nvar cal = CalendarApp.createCalendar(calendarName);\n```\n\n現在のアクティブシートからシートオブジェクトを作成して\nカレンダー名を2行5列のとこから取得して、カレンダーを作成\n\n```js\n  for (var i = 3; i <= sheet.getLastRow(); i++) {\n    title = sheet.getRange(i, 2).getValue();\n    date = sheet.getRange(i, 1).getValue();\n    if (title==\"\" && date == \"\") break;\n    cal.createAllDayEvent(title, date);\n  }\n```\n3行目からシートの最終行まで繰り返す処理\nタイトルを2列目から\n日付を1列目から所得して\nもしどちらも空白ならfor文終了\nタイトルと日付を使って全日イベントを作成。\n\n# Google Apps Script\n\nGASはいかがでしたか。かなり便利でいろんな機能が使えそうだと思ってます。\n\nシンタックスハイライト追加プルリクありがとうございます。追加しました！！\n\n\n.\n","coediting":false,"comments_count":0,"created_at":"2017-03-05T19:49:45+09:00","group":null,"id":"09ebaedd0f6f0438f422","likes_count":41,"private":false,"reactions_count":0,"stocks_count":64,"tags":[{"name":"HTML","versions":[]},{"name":"JavaScript","versions":[]},{"name":"GoogleAppsScript","versions":[]},{"name":"GAS","versions":[]},{"name":"Slack","versions":[]}],"title":"10分でできる ~ Googleカレンダー[ 自社版 ]を作ってみよう ~ [ Google Apps Script ]","updated_at":"2021-01-13T17:17:31+09:00","url":"https://qiita.com/ykhirao/items/09ebaedd0f6f0438f422","user":{"description":"Web Developer For 6 years.\r\nPHP/Laravel && (React OR Vue.js)\r\nTypeScript/node.js\r\n\r\n業務委託の依頼とかはWantedlyとかからでお願いします！","facebook_id":"","followees_count":38,"followers_count":95,"github_login_name":"ykhirao","id":"ykhirao","items_count":60,"linkedin_id":"","location":"Tokyo, Japan","name":"yk","organization":"","permanent_id":112929,"profile_image_url":"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/profile-images/1639030792","team_only":false,"twitter_screen_name":"ykhirao","website_url":"https://www.wantedly.com/id/ykhirao"},"page_views_count":null,"team_membership":null}},"path":"posts/09ebaedd0f6f0438f422"}
