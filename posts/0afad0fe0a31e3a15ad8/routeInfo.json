{"template":"__react_static_root__/src/components/QiitaPost","sharedHashesByProp":{},"data":{"post":{"rendered_body":"<h2 data-sourcepos=\"1:1-1:15\">\n<span id=\"はじめに\" class=\"fragment\"></span><a href=\"#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB\"><i class=\"fa fa-link\"></i></a>はじめに</h2>\n<p data-sourcepos=\"3:1-3:87\">いい感じのスクリプト書いたので忘れないように投稿しておく。</p>\n<h2 data-sourcepos=\"6:1-6:15\">\n<span id=\"イメージ\" class=\"fragment\"></span><a href=\"#%E3%82%A4%E3%83%A1%E3%83%BC%E3%82%B8\"><i class=\"fa fa-link\"></i></a>イメージ</h2>\n<p data-sourcepos=\"9:1-9:163\"><a href=\"https://camo.qiitausercontent.com/64333c947b9020ac3c431003c3f7ccac34577cca/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f34663432386234632d383966652d623962392d643961332d3237616435346433353664642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F4f428b4c-89fe-b9b9-d9a3-27ad54d356dd.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=57e1e3b1e757125060a855b270a32de4\" alt=\"スクリーンショット 2023-11-16 22.21.15.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/4f428b4c-89fe-b9b9-d9a3-27ad54d356dd.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F4f428b4c-89fe-b9b9-d9a3-27ad54d356dd.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=888899c160b1f66ab5d1b65620570c52 1x\" loading=\"lazy\"></a></p>\n<h2 data-sourcepos=\"12:1-12:12\">\n<span id=\"コード\" class=\"fragment\"></span><a href=\"#%E3%82%B3%E3%83%BC%E3%83%89\"><i class=\"fa fa-link\"></i></a>コード</h2>\n<p data-sourcepos=\"14:1-14:43\">fetchするURLは <code>https://httpbin.org/get</code></p>\n<p data-sourcepos=\"16:1-16:33\">gasのコードはこんな感じ</p>\n<div class=\"code-frame\" data-lang=\"javascript\" data-sourcepos=\"18:1-33:3\"><div class=\"highlight\"><pre><code><span class=\"kd\">function</span> <span class=\"nf\">fetchApi</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">ss</span> <span class=\"o\">=</span> <span class=\"nx\">SpreadsheetApp</span><span class=\"p\">.</span><span class=\"nf\">getActiveSpreadsheet</span><span class=\"p\">();</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">sheet</span> <span class=\"o\">=</span> <span class=\"nx\">ss</span><span class=\"p\">.</span><span class=\"nf\">getActiveSheet</span><span class=\"p\">();</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">cell</span> <span class=\"o\">=</span> <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nf\">getCurrentCell</span><span class=\"p\">();</span>\n  <span class=\"kd\">const</span> <span class=\"p\">[</span><span class=\"nx\">col</span><span class=\"p\">,</span> <span class=\"nx\">row</span><span class=\"p\">,</span> <span class=\"nx\">url</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"nx\">cell</span><span class=\"p\">.</span><span class=\"nf\">getColumn</span><span class=\"p\">(),</span> <span class=\"nx\">cell</span><span class=\"p\">.</span><span class=\"nf\">getRow</span><span class=\"p\">(),</span> <span class=\"nx\">cell</span><span class=\"p\">.</span><span class=\"nf\">getValue</span><span class=\"p\">()];</span>\n\n  <span class=\"kd\">const</span> <span class=\"nx\">res</span> <span class=\"o\">=</span> <span class=\"nx\">UrlFetchApp</span><span class=\"p\">.</span><span class=\"nf\">fetch</span><span class=\"p\">(</span><span class=\"nx\">url</span><span class=\"p\">);</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">result</span> <span class=\"o\">=</span> <span class=\"nx\">res</span><span class=\"p\">.</span><span class=\"nf\">getContentText</span><span class=\"p\">();</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">code</span> <span class=\"o\">=</span> <span class=\"nx\">res</span><span class=\"p\">.</span><span class=\"nf\">getResponseCode</span><span class=\"p\">();</span>\n\n  <span class=\"nx\">sheet</span><span class=\"p\">.</span><span class=\"nf\">getRange</span><span class=\"p\">(</span><span class=\"nx\">row</span><span class=\"p\">,</span> <span class=\"nx\">col</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">).</span><span class=\"nf\">setValue</span><span class=\"p\">(</span><span class=\"s2\">`CODE: </span><span class=\"p\">${</span><span class=\"nx\">code</span><span class=\"p\">}</span><span class=\"s2\">, RESULT: </span><span class=\"p\">${</span><span class=\"nx\">result</span><span class=\"p\">}</span><span class=\"s2\">`</span><span class=\"p\">);</span>\n<span class=\"p\">}</span>\n\n\n</code></pre></div></div>\n<ul data-sourcepos=\"35:1-39:0\">\n<li data-sourcepos=\"35:1-35:41\">今いるセルのURLを取ってくる</li>\n<li data-sourcepos=\"36:1-36:13\">Fetchする</li>\n<li data-sourcepos=\"37:1-39:0\">右隣に結果を書き込む</li>\n</ul>\n<h2 data-sourcepos=\"40:1-40:9\">\n<span id=\"設定\" class=\"fragment\"></span><a href=\"#%E8%A8%AD%E5%AE%9A\"><i class=\"fa fa-link\"></i></a>設定</h2>\n<h3 data-sourcepos=\"42:1-42:15\">\n<span id=\"apps-script\" class=\"fragment\"></span><a href=\"#apps-script\"><i class=\"fa fa-link\"></i></a>Apps Script</h3>\n<p data-sourcepos=\"44:1-44:163\"><a href=\"https://camo.qiitausercontent.com/471d27c1949eb430e43057e07ae6da9672974df6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f36303664623961652d623166352d313036612d643965392d6366613033666564373362652e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F606db9ae-b1f5-106a-d9e9-cfa03fed73be.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=17e94317e6c123f2034da58cfe32f9c8\" alt=\"スクリーンショット 2023-11-16 22.22.25.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/606db9ae-b1f5-106a-d9e9-cfa03fed73be.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F606db9ae-b1f5-106a-d9e9-cfa03fed73be.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=97467b78a771d64210d455aa18e78959 1x\" loading=\"lazy\"></a></p>\n<h3 data-sourcepos=\"46:1-46:16\">\n<span id=\"図形描画\" class=\"fragment\"></span><a href=\"#%E5%9B%B3%E5%BD%A2%E6%8F%8F%E7%94%BB\"><i class=\"fa fa-link\"></i></a>図形描画</h3>\n<p data-sourcepos=\"47:1-47:163\"><a href=\"https://camo.qiitausercontent.com/55e2d54fb427e30ab5336258e33728d4fa7c5a76/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f37613165393034642d316431342d633433362d373232322d6432363533343261613664612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F7a1e904d-1d14-c436-7222-d265342aa6da.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f784e8b2dfbcceac54ff48d74f7987d4\" alt=\"スクリーンショット 2023-11-16 22.22.47.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/7a1e904d-1d14-c436-7222-d265342aa6da.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F7a1e904d-1d14-c436-7222-d265342aa6da.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=06ab025f24e9f6747d7da21319743b05 1x\" loading=\"lazy\"></a></p>\n<h3 data-sourcepos=\"49:1-49:37\">\n<span id=\"図形へのスクリプト割当\" class=\"fragment\"></span><a href=\"#%E5%9B%B3%E5%BD%A2%E3%81%B8%E3%81%AE%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E5%89%B2%E5%BD%93\"><i class=\"fa fa-link\"></i></a>図形へのスクリプト割当</h3>\n<p data-sourcepos=\"51:1-51:20\">fetchApi　を設定</p>\n<p data-sourcepos=\"53:1-53:163\"><a href=\"https://camo.qiitausercontent.com/c054f2ef785a830a99ff7178709589ae29042411/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f61343032393531662d613534612d396630382d663033372d3530383333663435636631312e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2Fa402951f-a54a-9f08-f037-50833f45cf11.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=304f787f27b3192ad4bc4cb6601619f1\" alt=\"スクリーンショット 2023-11-16 22.23.08.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/a402951f-a54a-9f08-f037-50833f45cf11.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2Fa402951f-a54a-9f08-f037-50833f45cf11.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=6817ccd6f3749527de6bc87799d8dbe0 1x\" loading=\"lazy\"></a></p>\n<h3 data-sourcepos=\"56:1-56:28\">\n<span id=\"認証関連もろもろ\" class=\"fragment\"></span><a href=\"#%E8%AA%8D%E8%A8%BC%E9%96%A2%E9%80%A3%E3%82%82%E3%82%8D%E3%82%82%E3%82%8D\"><i class=\"fa fa-link\"></i></a>認証関連もろもろ</h3>\n<p data-sourcepos=\"58:1-59:108\">自分が作ったスクリプトなのにかなり権限しつこく聞かれる。<br>\n基本的に他人が作ったスクリプトに権限渡さない。Googleの認証とかこのあと入る</p>\n<p data-sourcepos=\"61:1-61:163\"><a href=\"https://camo.qiitausercontent.com/2105d697790b0833ca6cb8889ba13f2badb2897e/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f61643764336334622d393863372d663031652d666530652d3136386531323930333261372e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2Fad7d3c4b-98c7-f01e-fe0e-168e129032a7.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=12716aa21f869162719267947bd51065\" alt=\"スクリーンショット 2023-11-16 22.07.56.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/ad7d3c4b-98c7-f01e-fe0e-168e129032a7.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2Fad7d3c4b-98c7-f01e-fe0e-168e129032a7.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=08fdaf7289391eaa0ad5f521d5204e29 1x\" loading=\"lazy\"></a></p>\n<h2 data-sourcepos=\"64:1-64:15\">\n<span id=\"終わりに\" class=\"fragment\"></span><a href=\"#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB\"><i class=\"fa fa-link\"></i></a>終わりに</h2>\n<p data-sourcepos=\"66:1-66:348\">今回は具体的にはJamstackでお世話になりやすい <a href=\"https://microcms.io/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\">https://microcms.io/</a> さんのブログ取得APIを使って、microcms側でブログを書いて、定期的にスプレッドシートにコンテンツを出力、それをコピペしてhtmlに埋め込む、みたいなことやってて必要になったので作りました。</p>\n<p data-sourcepos=\"68:1-68:129\">その場合、以下のような書き方に一部変更されますが、概ね簡単な作業でできたので満足です。</p>\n<div class=\"code-frame\" data-lang=\"js\" data-sourcepos=\"70:1-79:3\"><div class=\"highlight\"><pre><code>  <span class=\"kd\">const</span> <span class=\"nx\">options</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"dl\">'</span><span class=\"s1\">method</span><span class=\"dl\">'</span> <span class=\"p\">:</span> <span class=\"dl\">'</span><span class=\"s1\">get</span><span class=\"dl\">'</span><span class=\"p\">,</span>\n    <span class=\"dl\">'</span><span class=\"s1\">headers</span><span class=\"dl\">'</span><span class=\"p\">:</span> <span class=\"p\">{</span>\n      <span class=\"dl\">\"</span><span class=\"s2\">X-MICROCMS-API-KEY</span><span class=\"dl\">\"</span><span class=\"p\">:</span> <span class=\"dl\">\"</span><span class=\"s2\">あなたのAPIキー</span><span class=\"dl\">\"</span>\n    <span class=\"p\">}</span>\n  <span class=\"p\">};</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">res</span> <span class=\"o\">=</span> <span class=\"nx\">UrlFetchApp</span><span class=\"p\">.</span><span class=\"nf\">fetch</span><span class=\"p\">(</span><span class=\"nx\">url</span><span class=\"p\">,</span> <span class=\"nx\">options</span><span class=\"p\">);</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">content</span> <span class=\"o\">=</span> <span class=\"nx\">JSON</span><span class=\"p\">.</span><span class=\"nf\">parse</span><span class=\"p\">(</span><span class=\"nx\">res</span><span class=\"p\">.</span><span class=\"nf\">getContentText</span><span class=\"p\">()).</span><span class=\"nx\">content</span>\n</code></pre></div></div>\n","body":"## はじめに\n\nいい感じのスクリプト書いたので忘れないように投稿しておく。\n\n\n## イメージ\n\n\n![スクリーンショット 2023-11-16 22.21.15.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/4f428b4c-89fe-b9b9-d9a3-27ad54d356dd.png)\n\n\n## コード\n\nfetchするURLは `https://httpbin.org/get`\n\ngasのコードはこんな感じ\n\n```javascript\nfunction fetchApi() {\n  const ss = SpreadsheetApp.getActiveSpreadsheet();\n  const sheet = ss.getActiveSheet();\n  const cell = sheet.getCurrentCell();\n  const [col, row, url] = [cell.getColumn(), cell.getRow(), cell.getValue()];\n\n  const res = UrlFetchApp.fetch(url);\n  const result = res.getContentText();\n  const code = res.getResponseCode();\n\n  sheet.getRange(row, col + 1, 1, 1).setValue(`CODE: ${code}, RESULT: ${result}`);\n}\n\n\n```\n\n* 今いるセルのURLを取ってくる\n* Fetchする\n* 右隣に結果を書き込む\n\n\n## 設定\n\n### Apps Script\n\n![スクリーンショット 2023-11-16 22.22.25.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/606db9ae-b1f5-106a-d9e9-cfa03fed73be.png)\n\n### 図形描画\n![スクリーンショット 2023-11-16 22.22.47.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/7a1e904d-1d14-c436-7222-d265342aa6da.png)\n\n### 図形へのスクリプト割当\n\nfetchApi　を設定\n\n![スクリーンショット 2023-11-16 22.23.08.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/a402951f-a54a-9f08-f037-50833f45cf11.png)\n\n\n### 認証関連もろもろ\n\n自分が作ったスクリプトなのにかなり権限しつこく聞かれる。\n基本的に他人が作ったスクリプトに権限渡さない。Googleの認証とかこのあと入る\n\n![スクリーンショット 2023-11-16 22.07.56.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/ad7d3c4b-98c7-f01e-fe0e-168e129032a7.png)\n\n\n## 終わりに\n\n今回は具体的にはJamstackでお世話になりやすい https://microcms.io/ さんのブログ取得APIを使って、microcms側でブログを書いて、定期的にスプレッドシートにコンテンツを出力、それをコピペしてhtmlに埋め込む、みたいなことやってて必要になったので作りました。\n\nその場合、以下のような書き方に一部変更されますが、概ね簡単な作業でできたので満足です。\n\n```js\n  const options = {\n    'method' : 'get',\n    'headers': {\n      \"X-MICROCMS-API-KEY\": \"あなたのAPIキー\"\n    }\n  };\n  const res = UrlFetchApp.fetch(url, options);\n  const content = JSON.parse(res.getContentText()).content\n```\n","coediting":false,"comments_count":0,"created_at":"2023-11-16T22:29:56+09:00","group":null,"id":"0afad0fe0a31e3a15ad8","likes_count":1,"private":false,"reactions_count":0,"stocks_count":1,"tags":[{"name":"JavaScript","versions":[]},{"name":"API","versions":[]},{"name":"GoogleAppsScript","versions":[]},{"name":"GAS","versions":[]}],"title":"現在いるセルのURLを叩いてレスポンスを右側に格納する[GAS/Google Apps Script]書いた","updated_at":"2023-11-16T22:29:56+09:00","url":"https://qiita.com/ykhirao/items/0afad0fe0a31e3a15ad8","user":{"description":"Web Developer From 2016.\r\nPHP/Laravel && React/TypeScript/Node.js\r\n\r\n業務委託の依頼とかはWantedlyとかからでお願いします！","facebook_id":"","followees_count":39,"followers_count":100,"github_login_name":"ykhirao","id":"ykhirao","items_count":78,"linkedin_id":"","location":"Tokyo, Japan","name":"yk","organization":"","permanent_id":112929,"profile_image_url":"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/profile-images/1639030792","team_only":false,"twitter_screen_name":"ykhirao","website_url":"https://www.wantedly.com/id/ykhirao"},"page_views_count":null,"team_membership":null,"organization_url_name":null,"slide":false}},"path":"posts/0afad0fe0a31e3a15ad8"}
