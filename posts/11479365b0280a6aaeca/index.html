<!DOCTYPE html><html lang="en"><head><meta name="generator" content="React Static"/><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, shrink-to-fit=no"/><link rel="preload" as="script" href="/templates/styles.55eb66eb.js"/><link rel="preload" as="script" href="/templates/vendors~main.867a25a5.js"/><link rel="preload" as="script" href="/main.80784f3b.js"/><link rel="preload" as="style" href="/styles.642cfcb4.css"/><link rel="stylesheet" href="/styles.642cfcb4.css"/><link rel="shortcut icon" href="/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png"/><link rel="manifest" href="/manifest.json"/><meta name="mobile-web-app-capable" content="yes"/><meta name="theme-color" content="#fff"/><meta name="application-name"/><link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png"/><link rel="apple-touch-icon" sizes="167x167" href="/apple-touch-icon-167x167.png"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"/><link rel="apple-touch-icon" sizes="1024x1024" href="/apple-touch-icon-1024x1024.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/><meta name="apple-mobile-web-app-title"/><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-640x1136.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-750x1334.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-828x1792.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1125x2436.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2208.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2688.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1536x2048.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2224.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2388.png"/><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-2048x2732.png"/><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1620x2160.png"/><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1136x640.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1334x750.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1792x828.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2436x1125.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2208x1242.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2688x1242.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2048x1536.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2224x1668.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2388x1668.png"/><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2732x2048.png"/><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1620.png"/><link rel="icon" type="image/png" sizes="228x228" href="/coast-228x228.png"/><meta name="msapplication-TileColor" content="#fff"/><meta name="msapplication-TileImage" content="/mstile-144x144.png"/><meta name="msapplication-config" content="/browserconfig.xml"/><link rel="yandex-tableau-widget" href="/yandex-browser-manifest.json"/></head><body><div id="root"><div style="outline:none" tabindex="-1"><nav class="navbar is-dark is-fixed-top" role="navigation" aria-label="main navigation"><div class="container"><div class="navbar-brand"><a class="navbar-item" href="/">Home</a><a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false"><span aria-hidden="true"></span><span aria-hidden="true"></span><span aria-hidden="true"></span></a></div><div id="navbarBasicExample" class="navbar-menu "><div class="navbar-start"><a class="navbar-item" href="/posts">Posts</a><a class="navbar-item" href="/events">Events</a><a class="navbar-item" href="/github">GitHub</a></div></div></div></nav><div class="container"><div class="is-primary" style="padding:4.5rem 0.5rem"><div style="outline:none" tabindex="-1"><div><a href="/posts">&lt;<!-- --> Back</a><br/><h3>ランチメンバーをランダムでいい感じに選ぶGASスクリプト</h3><article class="md-body"><p><a href="https://camo.qiitausercontent.com/18478755f9544ec862fc94ec1a7b10735aefcc0b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f38663930653861382d343534652d386537302d653831372d3363343661363433356630352e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F8f90e8a8-454e-8e70-e817-3c46a6435f05.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=6ecec4d48ae118bd405aa88a860fcdb7" alt="スクリーンショット 2020-12-28 2.10.22.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/8f90e8a8-454e-8e70-e817-3c46a6435f05.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F8f90e8a8-454e-8e70-e817-3c46a6435f05.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=8ce4169eb7dc6662c7349314c29adf22 1x" loading="lazy"></a></p>

<p>以下のようなURLをクリックするだけで、規定の配列から何人か選んでくれる。</p>

<div class="code-frame" data-lang="text"><div class="highlight"><pre><code>https://script.google.com/macros/s/XXXXX-XXXX/exec
https://script.google.com/macros/s/XXXXX-XXXX/exec?num=2
https://script.google.com/macros/s/XXXXX-XXXX/exec?num=3
https://script.google.com/macros/s/XXXXX-XXXX/exec?num=4
</code></pre></div></div>

<p>以下のようなスクリプトをGASにいれて、Webアプリケーションとして公開したらOK</p>

<div class="code-frame" data-lang="js"><div class="highlight"><pre><code><span class="kd">function</span> <span class="nx">doGet</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">isOurGsuiteUser</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">resText</span><span class="p">(</span><span class="dl">"</span><span class="s2">ログインアドレスが違います</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">postSlackMessage</span><span class="p">(</span><span class="nx">getMessageArray</span><span class="p">(</span><span class="nx">e</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">));</span>

  <span class="k">return</span> <span class="nx">resText</span><span class="p">(</span><span class="dl">"</span><span class="s2">OK!</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">testSlack</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">array</span> <span class="o">=</span> <span class="nx">getMessageArray</span><span class="p">();</span>

  <span class="nx">postSlackMessage</span><span class="p">(</span><span class="nx">array</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">))</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">getMessageArray</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">num</span> <span class="o">=</span> <span class="nx">getNum</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
  <span class="kd">const</span> <span class="nx">array</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nx">getLoginUser</span><span class="p">()</span> <span class="o">+</span> <span class="s2">`さんからのリクエストでランダムに </span><span class="se">\`</span><span class="p">${</span><span class="nx">num</span><span class="p">}</span><span class="s2">人</span><span class="se">\`</span><span class="s2"> 選ばれました :tada:`</span><span class="p">,</span>
    <span class="dl">""</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">```</span><span class="dl">"</span><span class="p">,</span>
    <span class="p">...(</span><span class="nx">getMember</span><span class="p">(</span><span class="nx">num</span><span class="p">)),</span>
    <span class="dl">"</span><span class="s2">```</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">""</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">ランチとか1on1とか楽しんできてください:+1::star:</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">];</span>

  <span class="k">return</span> <span class="nx">array</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">postSlackMessage</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">postUrl</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://hooks.slack.com/services/BBBBB/XXXX/????????</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// webhookurlは自分のチャンネルで取得してください</span>
  <span class="kd">var</span> <span class="nx">username</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Choice BOT</span><span class="dl">'</span><span class="p">;</span>
  <span class="kd">var</span> <span class="nx">icon</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">:slightly_smiling_face:</span><span class="dl">'</span><span class="p">;</span>

  <span class="kd">var</span> <span class="nx">jsonData</span> <span class="o">=</span>
  <span class="p">{</span>
     <span class="dl">"</span><span class="s2">username</span><span class="dl">"</span> <span class="p">:</span> <span class="nx">username</span><span class="p">,</span>
     <span class="dl">"</span><span class="s2">icon_emoji</span><span class="dl">"</span><span class="p">:</span> <span class="nx">icon</span><span class="p">,</span>
     <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span> <span class="p">:</span> <span class="nx">message</span>
  <span class="p">};</span>
  <span class="kd">var</span> <span class="nx">payload</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">jsonData</span><span class="p">);</span>

  <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span>
  <span class="p">{</span>
    <span class="dl">"</span><span class="s2">method</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">post</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">contentType</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">application/json</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">payload</span><span class="dl">"</span> <span class="p">:</span> <span class="nx">payload</span>
  <span class="p">};</span>

  <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nx">fetch</span><span class="p">(</span><span class="nx">postUrl</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**
 * memberを指定の数だけ返す
 */</span>
<span class="kd">function</span> <span class="nx">getMember</span><span class="p">(</span><span class="nx">num</span><span class="p">){</span>
  <span class="kd">const</span> <span class="nx">member</span> <span class="o">=</span> <span class="p">[</span>
    <span class="dl">'</span><span class="s1">Aさん</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">Bさん</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">Cさん</span><span class="dl">'</span>
  <span class="p">];</span>

  <span class="k">return</span> <span class="nx">shuffle</span><span class="p">(</span><span class="nx">member</span><span class="p">).</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">num</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/**
 * 何人にするか
 * 基本は1人
 * @return number
 */</span>
<span class="kd">function</span> <span class="nx">getNum</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kd">const</span> <span class="nx">num</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">parameter</span><span class="p">.</span><span class="nx">num</span><span class="p">);</span>

  <span class="k">return</span> <span class="nb">isNaN</span><span class="p">(</span><span class="nx">num</span><span class="p">)</span> <span class="p">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="nx">num</span><span class="p">;</span> 
<span class="p">}</span>

<span class="cm">/**
 * ログインユーザーのアドレスを確認して弊社社員か確認する
 */</span>
<span class="kd">function</span> <span class="nx">isOurGsuiteUser</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">getActiveUser</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">email</span> <span class="o">=</span> <span class="nx">user</span><span class="p">.</span><span class="nx">getEmail</span><span class="p">();</span>

  <span class="k">return</span> <span class="nx">email</span> <span class="o">&amp;&amp;</span> <span class="nx">email</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">@</span><span class="dl">"</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">email</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">@</span><span class="dl">"</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">gmail.com</span><span class="dl">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**
 * ログインユーザーを取得
 * return Sting
 */</span>
<span class="kd">function</span> <span class="nx">getLoginUser</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="nx">Session</span><span class="p">.</span><span class="nx">getActiveUser</span><span class="p">();</span>
  <span class="kd">const</span> <span class="nx">email</span> <span class="o">=</span> <span class="nx">user</span><span class="p">.</span><span class="nx">getEmail</span><span class="p">();</span>

  <span class="k">if</span> <span class="p">(</span><span class="nx">email</span> <span class="o">&amp;&amp;</span> <span class="nx">email</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">@</span><span class="dl">"</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">email</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">@</span><span class="dl">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">email</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">@</span><span class="dl">"</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="dl">"</span><span class="s2">Who??</span><span class="dl">"</span><span class="p">;</span>
<span class="p">}</span>


<span class="cm">/**
 * responceのラッパーにしようとしている
 */</span>
<span class="kd">function</span> <span class="nx">resText</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">ContentService</span><span class="p">.</span><span class="nx">createTextOutput</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span>
<span class="p">}</span>


<span class="cm">/**
 * 配列をシャッフルする
 */</span>
<span class="kd">function</span> <span class="nx">shuffle</span><span class="p">(</span><span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">array</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">j</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));</span>
    <span class="p">[</span><span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">array</span><span class="p">[</span><span class="nx">j</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="nx">array</span><span class="p">[</span><span class="nx">j</span><span class="p">],</span> <span class="nx">array</span><span class="p">[</span><span class="nx">i</span><span class="p">]];</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="nx">array</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>
</article></div></div></div></div><footer class="footer"><div class="content has-text-centered"><p>This web site was created by ykhirao using react-static. <a href="https://github.com/ykhirao/ykhirao.github.io" target="_blank" rel="noopener noreferrer">Here</a> <!-- -->is the link to the GitHub repository</p><p>&amp; last uploaded at <!-- -->2022/10/13</p><p>© 2021 ykhirao</p></div></footer></div></div><script type="text/javascript">window.__routeInfo = JSON.parse("{\"template\":\"__react_static_root__/src/components/QiitaPost\",\"sharedHashesByProp\":{},\"data\":{\"post\":{\"rendered_body\":\"<p><a href=\\\"https://camo.qiitausercontent.com/18478755f9544ec862fc94ec1a7b10735aefcc0b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f38663930653861382d343534652d386537302d653831372d3363343661363433356630352e706e67\\\" target=\\\"_blank\\\" rel=\\\"nofollow noopener\\\"><img src=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F8f90e8a8-454e-8e70-e817-3c46a6435f05.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=6ecec4d48ae118bd405aa88a860fcdb7\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2020-12-28 2.10.22.png\\\" data-canonical-src=\\\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/8f90e8a8-454e-8e70-e817-3c46a6435f05.png\\\" srcset=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F8f90e8a8-454e-8e70-e817-3c46a6435f05.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=8ce4169eb7dc6662c7349314c29adf22 1x\\\" loading=\\\"lazy\\\"></a></p>\\n\\n<p>\u4EE5\u4E0B\u306E\u3088\u3046\u306AURL\u3092\u30AF\u30EA\u30C3\u30AF\u3059\u308B\u3060\u3051\u3067\u3001\u898F\u5B9A\u306E\u914D\u5217\u304B\u3089\u4F55\u4EBA\u304B\u9078\u3093\u3067\u304F\u308C\u308B\u3002</p>\\n\\n<div class=\\\"code-frame\\\" data-lang=\\\"text\\\"><div class=\\\"highlight\\\"><pre><code>https://script.google.com/macros/s/XXXXX-XXXX/exec\\nhttps://script.google.com/macros/s/XXXXX-XXXX/exec?num=2\\nhttps://script.google.com/macros/s/XXXXX-XXXX/exec?num=3\\nhttps://script.google.com/macros/s/XXXXX-XXXX/exec?num=4\\n</code></pre></div></div>\\n\\n<p>\u4EE5\u4E0B\u306E\u3088\u3046\u306A\u30B9\u30AF\u30EA\u30D7\u30C8\u3092GAS\u306B\u3044\u308C\u3066\u3001Web\u30A2\u30D7\u30EA\u30B1\u30FC\u30B7\u30E7\u30F3\u3068\u3057\u3066\u516C\u958B\u3057\u305F\u3089OK</p>\\n\\n<div class=\\\"code-frame\\\" data-lang=\\\"js\\\"><div class=\\\"highlight\\\"><pre><code><span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">doGet</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">e</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"k\\\">if</span><span class=\\\"p\\\">(</span><span class=\\\"o\\\">!</span><span class=\\\"nx\\\">isOurGsuiteUser</span><span class=\\\"p\\\">())</span> <span class=\\\"p\\\">{</span>\\n    <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">resText</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">\u30ED\u30B0\u30A4\u30F3\u30A2\u30C9\u30EC\u30B9\u304C\u9055\u3044\u307E\u3059</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"p\\\">}</span>\\n\\n  <span class=\\\"nx\\\">postSlackMessage</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">getMessageArray</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">e</span><span class=\\\"p\\\">).</span><span class=\\\"nx\\\">join</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"se\\\">\\\\n</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">));</span>\\n\\n  <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">resText</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">OK!</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">);</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">testSlack</span><span class=\\\"p\\\">()</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">array</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">getMessageArray</span><span class=\\\"p\\\">();</span>\\n\\n  <span class=\\\"nx\\\">postSlackMessage</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">array</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">join</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"se\\\">\\\\n</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">))</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">getMessageArray</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">e</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">num</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">getNum</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">e</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">array</span> <span class=\\\"o\\\">=</span> <span class=\\\"p\\\">[</span>\\n    <span class=\\\"nx\\\">getLoginUser</span><span class=\\\"p\\\">()</span> <span class=\\\"o\\\">+</span> <span class=\\\"s2\\\">`\u3055\u3093\u304B\u3089\u306E\u30EA\u30AF\u30A8\u30B9\u30C8\u3067\u30E9\u30F3\u30C0\u30E0\u306B </span><span class=\\\"se\\\">\\\\`</span><span class=\\\"p\\\">${</span><span class=\\\"nx\\\">num</span><span class=\\\"p\\\">}</span><span class=\\\"s2\\\">\u4EBA</span><span class=\\\"se\\\">\\\\`</span><span class=\\\"s2\\\"> \u9078\u3070\u308C\u307E\u3057\u305F :tada:`</span><span class=\\\"p\\\">,</span>\\n    <span class=\\\"dl\\\">\\\"\\\"</span><span class=\\\"p\\\">,</span>\\n    <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">```</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">,</span>\\n    <span class=\\\"p\\\">...(</span><span class=\\\"nx\\\">getMember</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">num</span><span class=\\\"p\\\">)),</span>\\n    <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">```</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">,</span>\\n    <span class=\\\"dl\\\">\\\"\\\"</span><span class=\\\"p\\\">,</span>\\n    <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">\u30E9\u30F3\u30C1\u3068\u304B1on1\u3068\u304B\u697D\u3057\u3093\u3067\u304D\u3066\u304F\u3060\u3055\u3044:+1::star:</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">,</span>\\n  <span class=\\\"p\\\">];</span>\\n\\n  <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">array</span><span class=\\\"p\\\">;</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">postSlackMessage</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">message</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">postUrl</span> <span class=\\\"o\\\">=</span> <span class=\\\"dl\\\">'</span><span class=\\\"s1\\\">https://hooks.slack.com/services/BBBBB/XXXX/????????</span><span class=\\\"dl\\\">'</span><span class=\\\"p\\\">;</span> <span class=\\\"c1\\\">// webhookurl\u306F\u81EA\u5206\u306E\u30C1\u30E3\u30F3\u30CD\u30EB\u3067\u53D6\u5F97\u3057\u3066\u304F\u3060\u3055\u3044</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">username</span> <span class=\\\"o\\\">=</span> <span class=\\\"dl\\\">'</span><span class=\\\"s1\\\">Choice BOT</span><span class=\\\"dl\\\">'</span><span class=\\\"p\\\">;</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">icon</span> <span class=\\\"o\\\">=</span> <span class=\\\"dl\\\">'</span><span class=\\\"s1\\\">:slightly_smiling_face:</span><span class=\\\"dl\\\">'</span><span class=\\\"p\\\">;</span>\\n\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">jsonData</span> <span class=\\\"o\\\">=</span>\\n  <span class=\\\"p\\\">{</span>\\n     <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">username</span><span class=\\\"dl\\\">\\\"</span> <span class=\\\"p\\\">:</span> <span class=\\\"nx\\\">username</span><span class=\\\"p\\\">,</span>\\n     <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">icon_emoji</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">:</span> <span class=\\\"nx\\\">icon</span><span class=\\\"p\\\">,</span>\\n     <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">text</span><span class=\\\"dl\\\">\\\"</span> <span class=\\\"p\\\">:</span> <span class=\\\"nx\\\">message</span>\\n  <span class=\\\"p\\\">};</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">payload</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">JSON</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">stringify</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">jsonData</span><span class=\\\"p\\\">);</span>\\n\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">options</span> <span class=\\\"o\\\">=</span>\\n  <span class=\\\"p\\\">{</span>\\n    <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">method</span><span class=\\\"dl\\\">\\\"</span> <span class=\\\"p\\\">:</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">post</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">,</span>\\n    <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">contentType</span><span class=\\\"dl\\\">\\\"</span> <span class=\\\"p\\\">:</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">application/json</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">,</span>\\n    <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">payload</span><span class=\\\"dl\\\">\\\"</span> <span class=\\\"p\\\">:</span> <span class=\\\"nx\\\">payload</span>\\n  <span class=\\\"p\\\">};</span>\\n\\n  <span class=\\\"nx\\\">UrlFetchApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">fetch</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">postUrl</span><span class=\\\"p\\\">,</span> <span class=\\\"nx\\\">options</span><span class=\\\"p\\\">);</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"cm\\\">/**\\n * member\u3092\u6307\u5B9A\u306E\u6570\u3060\u3051\u8FD4\u3059\\n */</span>\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">getMember</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">num</span><span class=\\\"p\\\">){</span>\\n  <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">member</span> <span class=\\\"o\\\">=</span> <span class=\\\"p\\\">[</span>\\n    <span class=\\\"dl\\\">'</span><span class=\\\"s1\\\">A\u3055\u3093</span><span class=\\\"dl\\\">'</span><span class=\\\"p\\\">,</span>\\n    <span class=\\\"dl\\\">'</span><span class=\\\"s1\\\">B\u3055\u3093</span><span class=\\\"dl\\\">'</span><span class=\\\"p\\\">,</span>\\n    <span class=\\\"dl\\\">'</span><span class=\\\"s1\\\">C\u3055\u3093</span><span class=\\\"dl\\\">'</span>\\n  <span class=\\\"p\\\">];</span>\\n\\n  <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">shuffle</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">member</span><span class=\\\"p\\\">).</span><span class=\\\"nx\\\">slice</span><span class=\\\"p\\\">(</span><span class=\\\"mi\\\">0</span><span class=\\\"p\\\">,</span><span class=\\\"nx\\\">num</span><span class=\\\"p\\\">);</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"cm\\\">/**\\n * \u4F55\u4EBA\u306B\u3059\u308B\u304B\\n * \u57FA\u672C\u306F1\u4EBA\\n * @return number\\n */</span>\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">getNum</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">e</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"k\\\">if</span> <span class=\\\"p\\\">(</span><span class=\\\"o\\\">!</span><span class=\\\"nx\\\">e</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n    <span class=\\\"k\\\">return</span> <span class=\\\"mi\\\">1</span><span class=\\\"p\\\">;</span>\\n  <span class=\\\"p\\\">}</span>\\n\\n  <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">num</span> <span class=\\\"o\\\">=</span> <span class=\\\"nb\\\">parseInt</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">e</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">parameter</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">num</span><span class=\\\"p\\\">);</span>\\n\\n  <span class=\\\"k\\\">return</span> <span class=\\\"nb\\\">isNaN</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">num</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">?</span> <span class=\\\"mi\\\">1</span> <span class=\\\"p\\\">:</span> <span class=\\\"nx\\\">num</span><span class=\\\"p\\\">;</span> \\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"cm\\\">/**\\n * \u30ED\u30B0\u30A4\u30F3\u30E6\u30FC\u30B6\u30FC\u306E\u30A2\u30C9\u30EC\u30B9\u3092\u78BA\u8A8D\u3057\u3066\u5F0A\u793E\u793E\u54E1\u304B\u78BA\u8A8D\u3059\u308B\\n */</span>\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">isOurGsuiteUser</span><span class=\\\"p\\\">()</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">user</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">Session</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getActiveUser</span><span class=\\\"p\\\">();</span>\\n  <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">email</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">user</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getEmail</span><span class=\\\"p\\\">();</span>\\n\\n  <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">email</span> <span class=\\\"o\\\">&amp;&amp;</span> <span class=\\\"nx\\\">email</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">split</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">@</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">)</span> <span class=\\\"o\\\">&amp;&amp;</span> <span class=\\\"nx\\\">email</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">split</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">@</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">)[</span><span class=\\\"mi\\\">1</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">===</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">gmail.com</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">;</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"cm\\\">/**\\n * \u30ED\u30B0\u30A4\u30F3\u30E6\u30FC\u30B6\u30FC\u3092\u53D6\u5F97\\n * return Sting\\n */</span>\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">getLoginUser</span><span class=\\\"p\\\">()</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">user</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">Session</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getActiveUser</span><span class=\\\"p\\\">();</span>\\n  <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">email</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">user</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getEmail</span><span class=\\\"p\\\">();</span>\\n\\n  <span class=\\\"k\\\">if</span> <span class=\\\"p\\\">(</span><span class=\\\"nx\\\">email</span> <span class=\\\"o\\\">&amp;&amp;</span> <span class=\\\"nx\\\">email</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">split</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">@</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">)</span> <span class=\\\"o\\\">&amp;&amp;</span> <span class=\\\"nx\\\">email</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">split</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">@</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">)[</span><span class=\\\"mi\\\">0</span><span class=\\\"p\\\">])</span> <span class=\\\"p\\\">{</span>\\n    <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">email</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">split</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">@</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">)[</span><span class=\\\"mi\\\">0</span><span class=\\\"p\\\">];</span>\\n  <span class=\\\"p\\\">}</span>\\n\\n  <span class=\\\"k\\\">return</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">Who??</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">;</span>\\n<span class=\\\"p\\\">}</span>\\n\\n\\n<span class=\\\"cm\\\">/**\\n * responce\u306E\u30E9\u30C3\u30D1\u30FC\u306B\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u308B\\n */</span>\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">resText</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">text</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">ContentService</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">createTextOutput</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">text</span><span class=\\\"p\\\">)</span>\\n<span class=\\\"p\\\">}</span>\\n\\n\\n<span class=\\\"cm\\\">/**\\n * \u914D\u5217\u3092\u30B7\u30E3\u30C3\u30D5\u30EB\u3059\u308B\\n */</span>\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">shuffle</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">array</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"k\\\">for</span> <span class=\\\"p\\\">(</span><span class=\\\"kd\\\">let</span> <span class=\\\"nx\\\">i</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">array</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">length</span> <span class=\\\"o\\\">-</span> <span class=\\\"mi\\\">1</span><span class=\\\"p\\\">;</span> <span class=\\\"nx\\\">i</span> <span class=\\\"o\\\">&gt;=</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">;</span> <span class=\\\"nx\\\">i</span><span class=\\\"o\\\">--</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n    <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">j</span> <span class=\\\"o\\\">=</span> <span class=\\\"nb\\\">Math</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">floor</span><span class=\\\"p\\\">(</span><span class=\\\"nb\\\">Math</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">random</span><span class=\\\"p\\\">()</span> <span class=\\\"o\\\">*</span> <span class=\\\"p\\\">(</span><span class=\\\"nx\\\">i</span> <span class=\\\"o\\\">+</span> <span class=\\\"mi\\\">1</span><span class=\\\"p\\\">));</span>\\n    <span class=\\\"p\\\">[</span><span class=\\\"nx\\\">array</span><span class=\\\"p\\\">[</span><span class=\\\"nx\\\">i</span><span class=\\\"p\\\">],</span> <span class=\\\"nx\\\">array</span><span class=\\\"p\\\">[</span><span class=\\\"nx\\\">j</span><span class=\\\"p\\\">]]</span> <span class=\\\"o\\\">=</span> <span class=\\\"p\\\">[</span><span class=\\\"nx\\\">array</span><span class=\\\"p\\\">[</span><span class=\\\"nx\\\">j</span><span class=\\\"p\\\">],</span> <span class=\\\"nx\\\">array</span><span class=\\\"p\\\">[</span><span class=\\\"nx\\\">i</span><span class=\\\"p\\\">]];</span>\\n  <span class=\\\"p\\\">}</span>\\n\\n  <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">array</span><span class=\\\"p\\\">;</span>\\n<span class=\\\"p\\\">}</span>\\n\\n</code></pre></div></div>\\n\",\"body\":\"\\n\\n\\n![\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2020-12-28 2.10.22.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/8f90e8a8-454e-8e70-e817-3c46a6435f05.png)\\n\\n\u4EE5\u4E0B\u306E\u3088\u3046\u306AURL\u3092\u30AF\u30EA\u30C3\u30AF\u3059\u308B\u3060\u3051\u3067\u3001\u898F\u5B9A\u306E\u914D\u5217\u304B\u3089\u4F55\u4EBA\u304B\u9078\u3093\u3067\u304F\u308C\u308B\u3002\\n\\n```\\nhttps://script.google.com/macros/s/XXXXX-XXXX/exec\\nhttps://script.google.com/macros/s/XXXXX-XXXX/exec?num=2\\nhttps://script.google.com/macros/s/XXXXX-XXXX/exec?num=3\\nhttps://script.google.com/macros/s/XXXXX-XXXX/exec?num=4\\n```\\n\\n\u4EE5\u4E0B\u306E\u3088\u3046\u306A\u30B9\u30AF\u30EA\u30D7\u30C8\u3092GAS\u306B\u3044\u308C\u3066\u3001Web\u30A2\u30D7\u30EA\u30B1\u30FC\u30B7\u30E7\u30F3\u3068\u3057\u3066\u516C\u958B\u3057\u305F\u3089OK\\n\\n```js\\nfunction doGet(e) {\\n  if(!isOurGsuiteUser()) {\\n    return resText(\\\"\u30ED\u30B0\u30A4\u30F3\u30A2\u30C9\u30EC\u30B9\u304C\u9055\u3044\u307E\u3059\\\");\\n  }\\n\\n  postSlackMessage(getMessageArray(e).join(\\\"\\\\n\\\"));\\n\\n  return resText(\\\"OK!\\\");\\n}\\n\\nfunction testSlack() {\\n  const array = getMessageArray();\\n\\n  postSlackMessage(array.join(\\\"\\\\n\\\"))\\n}\\n\\nfunction getMessageArray(e) {\\n  const num = getNum(e);\\n  const array = [\\n    getLoginUser() + `\u3055\u3093\u304B\u3089\u306E\u30EA\u30AF\u30A8\u30B9\u30C8\u3067\u30E9\u30F3\u30C0\u30E0\u306B \\\\`${num}\u4EBA\\\\` \u9078\u3070\u308C\u307E\u3057\u305F :tada:`,\\n    \\\"\\\",\\n    \\\"```\\\",\\n    ...(getMember(num)),\\n    \\\"```\\\",\\n    \\\"\\\",\\n    \\\"\u30E9\u30F3\u30C1\u3068\u304B1on1\u3068\u304B\u697D\u3057\u3093\u3067\u304D\u3066\u304F\u3060\u3055\u3044:+1::star:\\\",\\n  ];\\n  \\n  return array;\\n}\\n\\nfunction postSlackMessage(message) {\\n  var postUrl = 'https://hooks.slack.com/services/BBBBB/XXXX/????????'; // webhookurl\u306F\u81EA\u5206\u306E\u30C1\u30E3\u30F3\u30CD\u30EB\u3067\u53D6\u5F97\u3057\u3066\u304F\u3060\u3055\u3044\\n  var username = 'Choice BOT';\\n  var icon = ':slightly_smiling_face:';\\n\\n  var jsonData =\\n  {\\n     \\\"username\\\" : username,\\n     \\\"icon_emoji\\\": icon,\\n     \\\"text\\\" : message\\n  };\\n  var payload = JSON.stringify(jsonData);\\n\\n  var options =\\n  {\\n    \\\"method\\\" : \\\"post\\\",\\n    \\\"contentType\\\" : \\\"application/json\\\",\\n    \\\"payload\\\" : payload\\n  };\\n\\n  UrlFetchApp.fetch(postUrl, options);\\n}\\n\\n/**\\n * member\u3092\u6307\u5B9A\u306E\u6570\u3060\u3051\u8FD4\u3059\\n */\\nfunction getMember(num){\\n  const member = [\\n    'A\u3055\u3093',\\n    'B\u3055\u3093',\\n    'C\u3055\u3093'\\n  ];\\n\\n  return shuffle(member).slice(0,num);\\n}\\n\\n/**\\n * \u4F55\u4EBA\u306B\u3059\u308B\u304B\\n * \u57FA\u672C\u306F1\u4EBA\\n * @return number\\n */\\nfunction getNum(e) {\\n  if (!e) {\\n    return 1;\\n  }\\n\\n  const num = parseInt(e.parameter.num);\\n\\n  return isNaN(num) ? 1 : num; \\n}\\n\\n/**\\n * \u30ED\u30B0\u30A4\u30F3\u30E6\u30FC\u30B6\u30FC\u306E\u30A2\u30C9\u30EC\u30B9\u3092\u78BA\u8A8D\u3057\u3066\u5F0A\u793E\u793E\u54E1\u304B\u78BA\u8A8D\u3059\u308B\\n */\\nfunction isOurGsuiteUser() {\\n  const user = Session.getActiveUser();\\n  const email = user.getEmail();\\n\\n  return email && email.split(\\\"@\\\") && email.split(\\\"@\\\")[1] === \\\"gmail.com\\\";\\n}\\n\\n/**\\n * \u30ED\u30B0\u30A4\u30F3\u30E6\u30FC\u30B6\u30FC\u3092\u53D6\u5F97\\n * return Sting\\n */\\nfunction getLoginUser() {\\n  const user = Session.getActiveUser();\\n  const email = user.getEmail();\\n\\n  if (email && email.split(\\\"@\\\") && email.split(\\\"@\\\")[0]) {\\n    return email.split(\\\"@\\\")[0];\\n  }\\n\\n  return \\\"Who??\\\";\\n}\\n\\n\\n/**\\n * responce\u306E\u30E9\u30C3\u30D1\u30FC\u306B\u3057\u3088\u3046\u3068\u3057\u3066\u3044\u308B\\n */\\nfunction resText(text) {\\n  return ContentService.createTextOutput(text)\\n}\\n\\n\\n/**\\n * \u914D\u5217\u3092\u30B7\u30E3\u30C3\u30D5\u30EB\u3059\u308B\\n */\\nfunction shuffle(array) {\\n  for (let i = array.length - 1; i >= 0; i--) {\\n    const j = Math.floor(Math.random() * (i + 1));\\n    [array[i], array[j]] = [array[j], array[i]];\\n  }\\n\\n  return array;\\n}\\n\\n```\\n\",\"coediting\":false,\"comments_count\":0,\"created_at\":\"2020-12-28T02:13:59+09:00\",\"group\":null,\"id\":\"11479365b0280a6aaeca\",\"likes_count\":0,\"private\":false,\"reactions_count\":0,\"stocks_count\":1,\"tags\":[{\"name\":\"JavaScript\",\"versions\":[]},{\"name\":\"gas\",\"versions\":[]},{\"name\":\"Slack\",\"versions\":[]}],\"title\":\"\u30E9\u30F3\u30C1\u30E1\u30F3\u30D0\u30FC\u3092\u30E9\u30F3\u30C0\u30E0\u3067\u3044\u3044\u611F\u3058\u306B\u9078\u3076GAS\u30B9\u30AF\u30EA\u30D7\u30C8\",\"updated_at\":\"2020-12-28T02:13:59+09:00\",\"url\":\"https://qiita.com/ykhirao/items/11479365b0280a6aaeca\",\"user\":{\"description\":\"Web Developer For 6 years.\\r\\nPHP/Laravel && (React OR Vue.js)\\r\\nTypeScript/node.js\\r\\n\\r\\n\u696D\u52D9\u59D4\u8A17\u306E\u4F9D\u983C\u3068\u304B\u306FWantedly\u3068\u304B\u304B\u3089\u3067\u304A\u9858\u3044\u3057\u307E\u3059\uFF01\",\"facebook_id\":\"\",\"followees_count\":38,\"followers_count\":95,\"github_login_name\":\"ykhirao\",\"id\":\"ykhirao\",\"items_count\":60,\"linkedin_id\":\"\",\"location\":\"Tokyo, Japan\",\"name\":\"yk\",\"organization\":\"\",\"permanent_id\":112929,\"profile_image_url\":\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/profile-images/1639030792\",\"team_only\":false,\"twitter_screen_name\":\"ykhirao\",\"website_url\":\"https://www.wantedly.com/id/ykhirao\"},\"page_views_count\":null,\"team_membership\":null}},\"path\":\"posts/11479365b0280a6aaeca\",\"sharedData\":{},\"siteData\":{\"updatedAt\":\"2022/10/13\"}}");</script><script defer="" type="text/javascript" src="/templates/styles.55eb66eb.js"></script><script defer="" type="text/javascript" src="/templates/vendors~main.867a25a5.js"></script><script defer="" type="text/javascript" src="/main.80784f3b.js"></script></body></html>