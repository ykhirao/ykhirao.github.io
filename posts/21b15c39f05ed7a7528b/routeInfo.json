{"template":"__react_static_root__/src/components/QiitaPost","sharedHashesByProp":{},"data":{"post":{"rendered_body":"<p><a href=\"https://camo.qiitausercontent.com/1ad18f2781a9a463a11ffccaed0dacf909a6ddff/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f39626434636530612d373763342d336661662d636130332d6238643963336332383838612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F9bd4ce0a-77c4-3faf-ca03-b8d9c3c2888a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=95d47533c7507a0816419d81deee1797\" alt=\"スクリーンショット 2021-10-18 2.27.25.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/9bd4ce0a-77c4-3faf-ca03-b8d9c3c2888a.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F9bd4ce0a-77c4-3faf-ca03-b8d9c3c2888a.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f1680524740f69578970cd02feb6ba4c 1x\" loading=\"lazy\"></a></p>\n\n<p>スクリプトエディタで以下の関数を追加</p>\n\n<div class=\"code-frame\" data-lang=\"javascript\"><div class=\"highlight\"><pre><code>\n<span class=\"cm\">/**\n * アクティブな範囲をMDの表に変換する\n */</span>\n<span class=\"kd\">function</span> <span class=\"nx\">createMdTableText</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">range</span> <span class=\"o\">=</span> <span class=\"nx\">SpreadsheetApp</span><span class=\"p\">.</span><span class=\"nx\">getActiveRange</span><span class=\"p\">();</span>\n\n  <span class=\"kd\">const</span> <span class=\"nx\">data</span> <span class=\"o\">=</span> <span class=\"nx\">range</span><span class=\"p\">.</span><span class=\"nx\">getValues</span><span class=\"p\">();</span>\n  <span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span><span class=\"nx\">data</span><span class=\"p\">);</span>\n\n  <span class=\"c1\">// 行列</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">rowNum</span> <span class=\"o\">=</span> <span class=\"nx\">range</span><span class=\"p\">.</span><span class=\"nx\">getNumRows</span><span class=\"p\">();</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">columnNum</span> <span class=\"o\">=</span> <span class=\"nx\">range</span><span class=\"p\">.</span><span class=\"nx\">getNumColumns</span><span class=\"p\">();</span>\n  <span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span><span class=\"s2\">`行数: </span><span class=\"p\">${</span><span class=\"nx\">rowNum</span><span class=\"p\">}</span><span class=\"s2\">, 列数: </span><span class=\"p\">${</span><span class=\"nx\">columnNum</span><span class=\"p\">}</span><span class=\"s2\">`</span><span class=\"p\">);</span>\n  <span class=\"k\">if</span> <span class=\"p\">(</span><span class=\"nx\">rowNum</span> <span class=\"o\">&lt;</span> <span class=\"mi\">1</span> <span class=\"o\">||</span> <span class=\"nx\">columnNum</span> <span class=\"o\">&lt;</span> <span class=\"mi\">1</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n    <span class=\"nx\">Browser</span><span class=\"p\">.</span><span class=\"nx\">msgBox</span><span class=\"p\">(</span><span class=\"dl\">\"</span><span class=\"s2\">選択して〜</span><span class=\"dl\">\"</span><span class=\"p\">);</span>\n  <span class=\"p\">}</span>\n\n  <span class=\"kd\">const</span>  <span class=\"nx\">convertedData</span> <span class=\"o\">=</span> <span class=\"p\">[];</span>\n  <span class=\"nx\">convertedData</span><span class=\"p\">.</span><span class=\"nx\">push</span><span class=\"p\">(</span><span class=\"nx\">data</span><span class=\"p\">.</span><span class=\"nx\">shift</span><span class=\"p\">())</span>\n  <span class=\"nx\">convertedData</span><span class=\"p\">.</span><span class=\"nx\">push</span><span class=\"p\">(</span><span class=\"nb\">Array</span><span class=\"p\">(</span><span class=\"nx\">columnNum</span><span class=\"p\">).</span><span class=\"nx\">fill</span><span class=\"p\">(</span><span class=\"dl\">\"</span><span class=\"s2\">---</span><span class=\"dl\">\"</span><span class=\"p\">))</span>\n  <span class=\"nx\">convertedData</span><span class=\"p\">.</span><span class=\"nx\">push</span><span class=\"p\">(...</span><span class=\"nx\">data</span><span class=\"p\">);</span>\n  <span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span> <span class=\"nx\">convertedData</span><span class=\"p\">);</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">resText</span> <span class=\"o\">=</span> <span class=\"nx\">convertedData</span><span class=\"p\">.</span><span class=\"nx\">map</span><span class=\"p\">(</span><span class=\"nx\">v</span> <span class=\"o\">=&gt;</span> <span class=\"nx\">v</span><span class=\"p\">.</span><span class=\"nx\">join</span><span class=\"p\">(</span><span class=\"dl\">\"</span><span class=\"s2\"> | </span><span class=\"dl\">\"</span><span class=\"p\">)).</span><span class=\"nx\">join</span><span class=\"p\">(</span><span class=\"dl\">\"</span><span class=\"se\">\\\\</span><span class=\"s2\">n</span><span class=\"dl\">\"</span><span class=\"p\">)</span>\n  <span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span><span class=\"nx\">resText</span><span class=\"p\">);</span>\n  <span class=\"nx\">Browser</span><span class=\"p\">.</span><span class=\"nx\">msgBox</span><span class=\"p\">(</span><span class=\"nx\">resText</span><span class=\"p\">);</span>\n<span class=\"p\">}</span>\n</code></pre></div></div>\n\n<p><a href=\"https://camo.qiitausercontent.com/4eb5aab886db8007112ba3a3a67145055f8f2312/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f35363262383466622d616366342d383133622d626562662d3333333836356334626633332e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F562b84fb-acf4-813b-bebf-333865c4bf33.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=0e0a11da6ec04903f606a420dadccb20\" alt=\"スクリーンショット 2021-10-18 2.28.19.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/562b84fb-acf4-813b-bebf-333865c4bf33.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F562b84fb-acf4-813b-bebf-333865c4bf33.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=8da9b31ac6e721941c71fd66e915f950 1x\" loading=\"lazy\"></a></p>\n\n<p>インポート <code>createMdTableText</code></p>\n\n<p>表を選択してマクロの <code>createMdTableText</code> ボタンを押す</p>\n\n<p><a href=\"https://camo.qiitausercontent.com/4a1c23f741f3237b89a09d5d1b6359adc8599f18/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f33653137356138652d323063362d393832652d373937302d6534386439393265343461612e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F3e175a8e-20c6-982e-7970-e48d992e44aa.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=a33e6386e80dc37f42566196cf86dd23\" alt=\"スクリーンショット 2021-10-18 2.29.31.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/3e175a8e-20c6-982e-7970-e48d992e44aa.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F3e175a8e-20c6-982e-7970-e48d992e44aa.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=222c2417be4266dd4262c0fae7dfdb14 1x\" loading=\"lazy\"></a></p>\n\n<p>許可するウインドウがでる、Googleの認証</p>\n\n<p><a href=\"https://camo.qiitausercontent.com/1fc48507f703cb705d3dd6b66620e5b290feadeb/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f36373535636639382d666265322d633436352d346366632d3666636230316162373737352e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F6755cf98-fbe2-c465-4cfc-6fcb01ab7775.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=d92d5fbeef4abfee87b5f9e161544421\" alt=\"スクリーンショット 2021-10-18 2.33.31.png\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/6755cf98-fbe2-c465-4cfc-6fcb01ab7775.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F6755cf98-fbe2-c465-4cfc-6fcb01ab7775.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=807eaf09054e30faf90c87a8c97841ff 1x\" loading=\"lazy\"></a></p>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre><code>タイトル | URL\n--- | ---\ngoogle | https://www.google.com/\nyahoo | https://www.yahoo.co.jp/\n</code></pre></div></div>\n\n<p>↑作られたMDファイル↑<br>\n↓実際の表↓</p>\n\n<table>\n<thead>\n<tr>\n<th>タイトル</th>\n<th>URL</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>google</td>\n<td><a href=\"https://www.google.com/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\">https://www.google.com/</a></td>\n</tr>\n<tr>\n<td>yahoo</td>\n<td><a href=\"https://www.yahoo.co.jp/\" class=\"autolink\" rel=\"nofollow noopener\" target=\"_blank\">https://www.yahoo.co.jp/</a></td>\n</tr>\n</tbody>\n</table>\n","body":"\n![スクリーンショット 2021-10-18 2.27.25.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/9bd4ce0a-77c4-3faf-ca03-b8d9c3c2888a.png)\n\nスクリプトエディタで以下の関数を追加\n\n```javascript\n\n/**\n * アクティブな範囲をMDの表に変換する\n */\nfunction createMdTableText() {\n  const range = SpreadsheetApp.getActiveRange();\n\n  const data = range.getValues();\n  console.log(data);\n\n  // 行列\n  const rowNum = range.getNumRows();\n  const columnNum = range.getNumColumns();\n  console.log(`行数: ${rowNum}, 列数: ${columnNum}`);\n  if (rowNum < 1 || columnNum < 1) {\n    Browser.msgBox(\"選択して〜\");\n  }\n\n  const  convertedData = [];\n  convertedData.push(data.shift())\n  convertedData.push(Array(columnNum).fill(\"---\"))\n  convertedData.push(...data);\n  console.log( convertedData);\n  const resText = convertedData.map(v => v.join(\" | \")).join(\"\\\\n\")\n  console.log(resText);\n  Browser.msgBox(resText);\n}\n```\n\n![スクリーンショット 2021-10-18 2.28.19.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/562b84fb-acf4-813b-bebf-333865c4bf33.png)\n\nインポート `createMdTableText`\n\n表を選択してマクロの `createMdTableText` ボタンを押す\n\n![スクリーンショット 2021-10-18 2.29.31.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/3e175a8e-20c6-982e-7970-e48d992e44aa.png)\n\n\n許可するウインドウがでる、Googleの認証\n\n![スクリーンショット 2021-10-18 2.33.31.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/6755cf98-fbe2-c465-4cfc-6fcb01ab7775.png)\n\n\n```\nタイトル | URL\n--- | ---\ngoogle | https://www.google.com/\nyahoo | https://www.yahoo.co.jp/\n```\n\n↑作られたMDファイル↑\n↓実際の表↓\n\nタイトル | URL\n--- | ---\ngoogle | https://www.google.com/\nyahoo | https://www.yahoo.co.jp/\n\n\n\n\n\n","coediting":false,"comments_count":0,"created_at":"2021-10-18T02:34:59+09:00","group":null,"id":"21b15c39f05ed7a7528b","likes_count":0,"private":false,"reactions_count":0,"stocks_count":0,"tags":[{"name":"Markdown","versions":[]},{"name":"spreadsheet","versions":[]}],"title":"スプレッドシートでマークダウンの表をコピーする【マクロ】","updated_at":"2021-10-18T02:34:59+09:00","url":"https://qiita.com/ykhirao/items/21b15c39f05ed7a7528b","user":{"description":"Web Developer From 2016.\r\nPHP/Laravel && React/TypeScript/Node.js\r\n\r\n業務委託の依頼とかはWantedlyとかからでお願いします！","facebook_id":"","followees_count":39,"followers_count":103,"github_login_name":"ykhirao","id":"ykhirao","items_count":83,"linkedin_id":"","location":"Tokyo, Japan","name":"yk","organization":"","permanent_id":112929,"profile_image_url":"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/profile-images/1639030792","team_only":false,"twitter_screen_name":"ykhirao","website_url":"https://www.wantedly.com/id/ykhirao"},"page_views_count":null,"team_membership":null,"organization_url_name":null,"slide":false}},"path":"posts/21b15c39f05ed7a7528b"}
