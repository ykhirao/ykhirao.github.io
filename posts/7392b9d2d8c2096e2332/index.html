<!DOCTYPE html><html lang="en"><head><meta name="generator" content="React Static"/><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, shrink-to-fit=no"/><link rel="preload" as="script" href="/templates/styles.ac7c013c.js"/><link rel="preload" as="script" href="/templates/vendors~main.867a25a5.js"/><link rel="preload" as="script" href="/main.80784f3b.js"/><link rel="preload" as="style" href="/styles.642cfcb4.css"/><link rel="stylesheet" href="/styles.642cfcb4.css"/><link rel="shortcut icon" href="/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png"/><link rel="manifest" href="/manifest.json"/><meta name="mobile-web-app-capable" content="yes"/><meta name="theme-color" content="#fff"/><meta name="application-name"/><link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png"/><link rel="apple-touch-icon" sizes="167x167" href="/apple-touch-icon-167x167.png"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"/><link rel="apple-touch-icon" sizes="1024x1024" href="/apple-touch-icon-1024x1024.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/><meta name="apple-mobile-web-app-title"/><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-640x1136.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-750x1334.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-828x1792.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1125x2436.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2208.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2688.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1536x2048.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2224.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2388.png"/><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-2048x2732.png"/><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1620x2160.png"/><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1136x640.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1334x750.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1792x828.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2436x1125.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2208x1242.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2688x1242.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2048x1536.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2224x1668.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2388x1668.png"/><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2732x2048.png"/><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1620.png"/><link rel="icon" type="image/png" sizes="228x228" href="/coast-228x228.png"/><meta name="msapplication-TileColor" content="#fff"/><meta name="msapplication-TileImage" content="/mstile-144x144.png"/><meta name="msapplication-config" content="/browserconfig.xml"/><link rel="yandex-tableau-widget" href="/yandex-browser-manifest.json"/></head><body><div id="root"><div style="outline:none" tabindex="-1"><nav class="navbar is-dark is-fixed-top" role="navigation" aria-label="main navigation"><div class="container"><div class="navbar-brand"><a class="navbar-item" href="/">Home</a><a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false"><span aria-hidden="true"></span><span aria-hidden="true"></span><span aria-hidden="true"></span></a></div><div id="navbarBasicExample" class="navbar-menu "><div class="navbar-start"><a class="navbar-item" href="/posts">Posts</a><a class="navbar-item" href="/events">Events</a><a class="navbar-item" href="/github">GitHub</a></div></div></div></nav><div class="container"><div class="is-primary" style="padding:4.5rem 0.5rem"><div style="outline:none" tabindex="-1"><div><a href="/posts">&lt;<!-- --> Back</a><br/><h3>【大量のGmailを一括下書き作成】スプレッドシートから管理するスクリプトを書いたので使ってほしい。</h3><article class="md-body"><h1 data-sourcepos="1:1-1:151">
<span id="gmailで大量の送信先にメールを送るときにスプレッドシートで管理するスクリプトを書いたので使ってほしい" class="fragment"></span><a href="#gmail%E3%81%A7%E5%A4%A7%E9%87%8F%E3%81%AE%E9%80%81%E4%BF%A1%E5%85%88%E3%81%AB%E3%83%A1%E3%83%BC%E3%83%AB%E3%82%92%E9%80%81%E3%82%8B%E3%81%A8%E3%81%8D%E3%81%AB%E3%82%B9%E3%83%97%E3%83%AC%E3%83%83%E3%83%89%E3%82%B7%E3%83%BC%E3%83%88%E3%81%A7%E7%AE%A1%E7%90%86%E3%81%99%E3%82%8B%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%82%92%E6%9B%B8%E3%81%84%E3%81%9F%E3%81%AE%E3%81%A7%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BB%E3%81%97%E3%81%84"><i class="fa fa-link"></i></a>Gmailで大量の送信先にメールを送るときにスプレッドシートで管理するスクリプトを書いたので使ってほしい。</h1>
<p data-sourcepos="3:1-3:33">スクショはこんな感じ。</p>
<a href="https://camo.qiitausercontent.com/b33ced787ae0f9adc8dbb1be8b521a3f594e6a07/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f66383035323666632d623130372d383533622d383163362d3935353765323337626564322e706e67" target="_blank" rel="nofollow noopener"><img width="944" alt="スクリーンショット 2020-03-14 15.29.04.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2Ff80526fc-b107-853b-81c6-9557e237bed2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=17b8b022a7973f78b56e048435d22d79" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/f80526fc-b107-853b-81c6-9557e237bed2.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2Ff80526fc-b107-853b-81c6-9557e237bed2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=1de81c0f2aad7ac7e751a056f38156a8 1x" loading="lazy"></a>
<p data-sourcepos="7:1-7:42"><code>下書き作成</code> ぼたんポチすると</p>
<a href="https://camo.qiitausercontent.com/e60634aca0c6db4d0fa5eb149719c3bd349e31be/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f34666639373434642d333438302d626338322d646532342d3035616535643130613035362e706e67" target="_blank" rel="nofollow noopener"><img width="1351" alt="スクリーンショット 2020-03-14 15.32.25.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F4ff9744d-3480-bc82-de24-05ae5d10a056.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9f62a1b3930a24a8cdeba2ba8ac522c4" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/4ff9744d-3480-bc82-de24-05ae5d10a056.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F4ff9744d-3480-bc82-de24-05ae5d10a056.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b3682d3594055533678cdd49b7b369ad 1x" loading="lazy"></a>
<p data-sourcepos="11:1-11:86">Gmail側に下書きが保存されます。目で目視してから使ってくれ。</p>
<h2 data-sourcepos="13:1-13:6">
<span id="faq" class="fragment"></span><a href="#faq"><i class="fa fa-link"></i></a>FAQ</h2>
<ul data-sourcepos="15:1-24:0">
<li data-sourcepos="15:1-16:65">BCCじゃだめなんですか？
<ul data-sourcepos="16:5-16:65">
<li data-sourcepos="16:5-16:65">Toでたくさん贈りたいときもあるよね…？？</li>
</ul>
</li>
<li data-sourcepos="17:1-18:21">え、もしかして ひとつひとつの宛先ごとにメール作ってくれるの？
<ul data-sourcepos="18:5-18:21">
<li data-sourcepos="18:5-18:21">そうです！</li>
</ul>
</li>
<li data-sourcepos="19:1-21:101">プログラムから実行すると、間違ったときに不安！！！
<ul data-sourcepos="20:5-21:101">
<li data-sourcepos="20:5-20:97">大丈夫です。下書き <code>GmailApp.createDraft(to, subject, body)</code> で作ってます！</li>
<li data-sourcepos="21:5-21:101">自分の目で確認してから、Gmailから送信ボタンぽちぽちしてください。</li>
</ul>
</li>
<li data-sourcepos="22:1-24:0">悪いことに使っていい？
<ul data-sourcepos="23:5-24:0">
<li data-sourcepos="23:5-24:0">絶対にやめてください。特定電子メール法に則って使ってください。</li>
</ul>
</li>
</ul>
<h2 data-sourcepos="25:1-25:9">
<span id="共有" class="fragment"></span><a href="#%E5%85%B1%E6%9C%89"><i class="fa fa-link"></i></a>共有</h2>
<p data-sourcepos="27:1-28:51">ファイルを共有したので自分のドライブにコピーして使ってほしいです。<br>
共有リクエストしないでくださいね〜</p>
<p data-sourcepos="30:1-30:63">↓共有リクエストくるたびにメールきてます。</p>
<p data-sourcepos="32:1-32:163"><a href="https://camo.qiitausercontent.com/1d014ad262e48f1fc69453b9a4430cde72a409c7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f63363630343039392d393230662d666330612d316462302d3363353230373635653639382e706e67" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2Fc6604099-920f-fc0a-1db0-3c520765e698.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=74121489bc611f0e006ecb776776e4cf" alt="スクリーンショット 2023-01-15 21.14.32.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/c6604099-920f-fc0a-1db0-3c520765e698.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2Fc6604099-920f-fc0a-1db0-3c520765e698.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=82d1b6373bd2d908ab208410593d43ff 1x" loading="lazy"></a></p>
<p data-sourcepos="35:1-35:100"><qiita-embed-ogp src="https://docs.google.com/spreadsheets/d/1fPE17OVUx0-OBXCRTZAm-vkLn1msYerBis7rN1tMaRc/edit?usp=sharing"></qiita-embed-ogp></p>
<p data-sourcepos="37:1-37:191">あ、もちろん実際に使われているコードがどんなのか見てから使ってほしいのと、Gmailから権限要求されるので適切に許可してあげてほしい。</p>
<h2 data-sourcepos="39:1-39:9">
<span id="実装" class="fragment"></span><a href="#%E5%AE%9F%E8%A3%85"><i class="fa fa-link"></i></a>実装</h2>
<div class="code-frame" data-lang="javascript" data-sourcepos="41:1-82:3"><div class="highlight"><pre><code><span class="cm">/** *****************************************
[ [ '項目', '内容', 'To', 'Name' ],
  [ '件名', 'XXXXの件について', 'example@example.com', '開発室example さま' ],
  [ '書き出し', '', 'example+123@example.com', '総務 田中 さま' ],
  [ '本文', '', '', '' ],
  [ 'To欄の数', 2, '', '' ] ]
***************************************** */</span>
<span class="kd">const</span> <span class="nx">allData</span> <span class="o">=</span> <span class="nx">SpreadsheetApp</span><span class="p">.</span><span class="nx">getActiveSheet</span><span class="p">().</span><span class="nx">getDataRange</span><span class="p">().</span><span class="nx">getValues</span><span class="p">();</span>

<span class="cm">/** *****************************************
['XXXXの件について', '本文']
***************************************** */</span>
<span class="kd">const</span> <span class="nx">commonData</span> <span class="o">=</span> <span class="nx">allData</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">件名</span><span class="dl">"</span> <span class="o">||</span> <span class="nx">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">本文</span><span class="dl">"</span><span class="p">)).</span><span class="nx">map</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="nx">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>

<span class="cm">/** *****************************************
[ [ 'tanaka@example.com', '開発室example さま' ],
  [ 'AAA@example.com', '総務 田中 さま' ] ]
***************************************** */</span>
<span class="kd">const</span> <span class="nx">toMailData</span> <span class="o">=</span> <span class="nx">allData</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">To</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">!==</span> <span class="dl">""</span><span class="p">)).</span><span class="nx">map</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="nx">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nx">x</span><span class="p">[</span><span class="mi">3</span><span class="p">]])</span>

<span class="kd">function</span> <span class="nx">createDraft</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">subject</span> <span class="o">=</span> <span class="nx">commonData</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>

  <span class="c1">// GmailApp.createDraft(["hirao@openlogi.com", "hirao+2@openlogi.com"], subject, "body test");</span>

  <span class="nx">toMailData</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="k">async</span> <span class="nx">x</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="kd">const</span> <span class="nx">to</span> <span class="o">=</span> <span class="nx">x</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">const</span> <span class="nx">body</span> <span class="o">=</span> <span class="nx">createBody</span><span class="p">(</span><span class="nx">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="k">await</span> <span class="nx">GmailApp</span><span class="p">.</span><span class="nx">createDraft</span><span class="p">(</span><span class="nx">to</span><span class="p">,</span> <span class="nx">subject</span><span class="p">,</span> <span class="nx">body</span><span class="p">);</span>
  <span class="p">})</span>
<span class="p">}</span>

<span class="cm">/**
 * @todo メッセージ本文入れたり署名欄とか拡張する
 */</span>
<span class="kd">function</span> <span class="nx">createBody</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">name</span> <span class="o">+</span> <span class="dl">"</span><span class="se">\n\n</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">commonData</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
<span class="p">}</span>

</code></pre></div></div>
<p data-sourcepos="87:1-87:120"><code>下書き作成</code> ってボタンをスプレッドシート内のGASの関数 <code>createDraft</code> に紐づけています。</p>
<p data-sourcepos="90:1-90:285">発火したら、今ひらいているページのデータを読み込みにいってメール送信するので、こんな感じでどんどんタブを追加していって、どの時はどの人たちにメールを送ったのか、そういう履歴もわかりますです。</p>
<a href="https://camo.qiitausercontent.com/763a833f552a8f96d06c83ca60c96ec7dc0d9770/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f35333164336333332d313038332d393566642d623831652d6337343932326239616632642e706e67" target="_blank" rel="nofollow noopener"><img width="426" alt="スクリーンショット 2020-03-14 15.30.10.png" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F531d3c33-1083-95fd-b81e-c74922b9af2d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1bfeba60cd42a4303dccbef53075ab85" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/531d3c33-1083-95fd-b81e-c74922b9af2d.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F531d3c33-1083-95fd-b81e-c74922b9af2d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=27779f5a95d1bf6bbc74eeccd457b391 1x" loading="lazy"></a>
<p data-sourcepos="95:1-95:9">以上。</p>
<p data-sourcepos="97:1-97:90">今日さくっと作ったやつですが、必要な方いたら使ってください。</p>
</article></div></div></div></div><footer class="footer"><div class="content has-text-centered"><p>This web site was created by ykhirao using react-static. <a href="https://github.com/ykhirao/ykhirao.github.io" target="_blank" rel="noopener noreferrer">Here</a> <!-- -->is the link to the GitHub repository</p><p>&amp; last uploaded at <!-- -->2023/03/06</p><p>© 2021 ykhirao</p></div></footer></div></div><script type="text/javascript">window.__routeInfo = JSON.parse("{\"template\":\"__react_static_root__/src/components/QiitaPost\",\"sharedHashesByProp\":{},\"data\":{\"post\":{\"rendered_body\":\"<h1 data-sourcepos=\\\"1:1-1:151\\\">\\n<span id=\\\"gmail\u3067\u5927\u91CF\u306E\u9001\u4FE1\u5148\u306B\u30E1\u30FC\u30EB\u3092\u9001\u308B\u3068\u304D\u306B\u30B9\u30D7\u30EC\u30C3\u30C9\u30B7\u30FC\u30C8\u3067\u7BA1\u7406\u3059\u308B\u30B9\u30AF\u30EA\u30D7\u30C8\u3092\u66F8\u3044\u305F\u306E\u3067\u4F7F\u3063\u3066\u307B\u3057\u3044\\\" class=\\\"fragment\\\"></span><a href=\\\"#gmail%E3%81%A7%E5%A4%A7%E9%87%8F%E3%81%AE%E9%80%81%E4%BF%A1%E5%85%88%E3%81%AB%E3%83%A1%E3%83%BC%E3%83%AB%E3%82%92%E9%80%81%E3%82%8B%E3%81%A8%E3%81%8D%E3%81%AB%E3%82%B9%E3%83%97%E3%83%AC%E3%83%83%E3%83%89%E3%82%B7%E3%83%BC%E3%83%88%E3%81%A7%E7%AE%A1%E7%90%86%E3%81%99%E3%82%8B%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%82%92%E6%9B%B8%E3%81%84%E3%81%9F%E3%81%AE%E3%81%A7%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BB%E3%81%97%E3%81%84\\\"><i class=\\\"fa fa-link\\\"></i></a>Gmail\u3067\u5927\u91CF\u306E\u9001\u4FE1\u5148\u306B\u30E1\u30FC\u30EB\u3092\u9001\u308B\u3068\u304D\u306B\u30B9\u30D7\u30EC\u30C3\u30C9\u30B7\u30FC\u30C8\u3067\u7BA1\u7406\u3059\u308B\u30B9\u30AF\u30EA\u30D7\u30C8\u3092\u66F8\u3044\u305F\u306E\u3067\u4F7F\u3063\u3066\u307B\u3057\u3044\u3002</h1>\\n<p data-sourcepos=\\\"3:1-3:33\\\">\u30B9\u30AF\u30B7\u30E7\u306F\u3053\u3093\u306A\u611F\u3058\u3002</p>\\n<a href=\\\"https://camo.qiitausercontent.com/b33ced787ae0f9adc8dbb1be8b521a3f594e6a07/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f66383035323666632d623130372d383533622d383163362d3935353765323337626564322e706e67\\\" target=\\\"_blank\\\" rel=\\\"nofollow noopener\\\"><img width=\\\"944\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2020-03-14 15.29.04.png\\\" src=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2Ff80526fc-b107-853b-81c6-9557e237bed2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=17b8b022a7973f78b56e048435d22d79\\\" data-canonical-src=\\\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/f80526fc-b107-853b-81c6-9557e237bed2.png\\\" srcset=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2Ff80526fc-b107-853b-81c6-9557e237bed2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=1de81c0f2aad7ac7e751a056f38156a8 1x\\\" loading=\\\"lazy\\\"></a>\\n<p data-sourcepos=\\\"7:1-7:42\\\"><code>\u4E0B\u66F8\u304D\u4F5C\u6210</code> \u307C\u305F\u3093\u30DD\u30C1\u3059\u308B\u3068</p>\\n<a href=\\\"https://camo.qiitausercontent.com/e60634aca0c6db4d0fa5eb149719c3bd349e31be/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f34666639373434642d333438302d626338322d646532342d3035616535643130613035362e706e67\\\" target=\\\"_blank\\\" rel=\\\"nofollow noopener\\\"><img width=\\\"1351\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2020-03-14 15.32.25.png\\\" src=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F4ff9744d-3480-bc82-de24-05ae5d10a056.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9f62a1b3930a24a8cdeba2ba8ac522c4\\\" data-canonical-src=\\\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/4ff9744d-3480-bc82-de24-05ae5d10a056.png\\\" srcset=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F4ff9744d-3480-bc82-de24-05ae5d10a056.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b3682d3594055533678cdd49b7b369ad 1x\\\" loading=\\\"lazy\\\"></a>\\n<p data-sourcepos=\\\"11:1-11:86\\\">Gmail\u5074\u306B\u4E0B\u66F8\u304D\u304C\u4FDD\u5B58\u3055\u308C\u307E\u3059\u3002\u76EE\u3067\u76EE\u8996\u3057\u3066\u304B\u3089\u4F7F\u3063\u3066\u304F\u308C\u3002</p>\\n<h2 data-sourcepos=\\\"13:1-13:6\\\">\\n<span id=\\\"faq\\\" class=\\\"fragment\\\"></span><a href=\\\"#faq\\\"><i class=\\\"fa fa-link\\\"></i></a>FAQ</h2>\\n<ul data-sourcepos=\\\"15:1-24:0\\\">\\n<li data-sourcepos=\\\"15:1-16:65\\\">BCC\u3058\u3083\u3060\u3081\u306A\u3093\u3067\u3059\u304B\uFF1F\\n<ul data-sourcepos=\\\"16:5-16:65\\\">\\n<li data-sourcepos=\\\"16:5-16:65\\\">To\u3067\u305F\u304F\u3055\u3093\u8D08\u308A\u305F\u3044\u3068\u304D\u3082\u3042\u308B\u3088\u306D\u2026\uFF1F\uFF1F</li>\\n</ul>\\n</li>\\n<li data-sourcepos=\\\"17:1-18:21\\\">\u3048\u3001\u3082\u3057\u304B\u3057\u3066 \u3072\u3068\u3064\u3072\u3068\u3064\u306E\u5B9B\u5148\u3054\u3068\u306B\u30E1\u30FC\u30EB\u4F5C\u3063\u3066\u304F\u308C\u308B\u306E\uFF1F\\n<ul data-sourcepos=\\\"18:5-18:21\\\">\\n<li data-sourcepos=\\\"18:5-18:21\\\">\u305D\u3046\u3067\u3059\uFF01</li>\\n</ul>\\n</li>\\n<li data-sourcepos=\\\"19:1-21:101\\\">\u30D7\u30ED\u30B0\u30E9\u30E0\u304B\u3089\u5B9F\u884C\u3059\u308B\u3068\u3001\u9593\u9055\u3063\u305F\u3068\u304D\u306B\u4E0D\u5B89\uFF01\uFF01\uFF01\\n<ul data-sourcepos=\\\"20:5-21:101\\\">\\n<li data-sourcepos=\\\"20:5-20:97\\\">\u5927\u4E08\u592B\u3067\u3059\u3002\u4E0B\u66F8\u304D <code>GmailApp.createDraft(to, subject, body)</code> \u3067\u4F5C\u3063\u3066\u307E\u3059\uFF01</li>\\n<li data-sourcepos=\\\"21:5-21:101\\\">\u81EA\u5206\u306E\u76EE\u3067\u78BA\u8A8D\u3057\u3066\u304B\u3089\u3001Gmail\u304B\u3089\u9001\u4FE1\u30DC\u30BF\u30F3\u307D\u3061\u307D\u3061\u3057\u3066\u304F\u3060\u3055\u3044\u3002</li>\\n</ul>\\n</li>\\n<li data-sourcepos=\\\"22:1-24:0\\\">\u60AA\u3044\u3053\u3068\u306B\u4F7F\u3063\u3066\u3044\u3044\uFF1F\\n<ul data-sourcepos=\\\"23:5-24:0\\\">\\n<li data-sourcepos=\\\"23:5-24:0\\\">\u7D76\u5BFE\u306B\u3084\u3081\u3066\u304F\u3060\u3055\u3044\u3002\u7279\u5B9A\u96FB\u5B50\u30E1\u30FC\u30EB\u6CD5\u306B\u5247\u3063\u3066\u4F7F\u3063\u3066\u304F\u3060\u3055\u3044\u3002</li>\\n</ul>\\n</li>\\n</ul>\\n<h2 data-sourcepos=\\\"25:1-25:9\\\">\\n<span id=\\\"\u5171\u6709\\\" class=\\\"fragment\\\"></span><a href=\\\"#%E5%85%B1%E6%9C%89\\\"><i class=\\\"fa fa-link\\\"></i></a>\u5171\u6709</h2>\\n<p data-sourcepos=\\\"27:1-28:51\\\">\u30D5\u30A1\u30A4\u30EB\u3092\u5171\u6709\u3057\u305F\u306E\u3067\u81EA\u5206\u306E\u30C9\u30E9\u30A4\u30D6\u306B\u30B3\u30D4\u30FC\u3057\u3066\u4F7F\u3063\u3066\u307B\u3057\u3044\u3067\u3059\u3002<br>\\n\u5171\u6709\u30EA\u30AF\u30A8\u30B9\u30C8\u3057\u306A\u3044\u3067\u304F\u3060\u3055\u3044\u306D\u301C</p>\\n<p data-sourcepos=\\\"30:1-30:63\\\">\u2193\u5171\u6709\u30EA\u30AF\u30A8\u30B9\u30C8\u304F\u308B\u305F\u3073\u306B\u30E1\u30FC\u30EB\u304D\u3066\u307E\u3059\u3002</p>\\n<p data-sourcepos=\\\"32:1-32:163\\\"><a href=\\\"https://camo.qiitausercontent.com/1d014ad262e48f1fc69453b9a4430cde72a409c7/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f63363630343039392d393230662d666330612d316462302d3363353230373635653639382e706e67\\\" target=\\\"_blank\\\" rel=\\\"nofollow noopener\\\"><img src=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2Fc6604099-920f-fc0a-1db0-3c520765e698.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=74121489bc611f0e006ecb776776e4cf\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2023-01-15 21.14.32.png\\\" data-canonical-src=\\\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/c6604099-920f-fc0a-1db0-3c520765e698.png\\\" srcset=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2Fc6604099-920f-fc0a-1db0-3c520765e698.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=82d1b6373bd2d908ab208410593d43ff 1x\\\" loading=\\\"lazy\\\"></a></p>\\n<p data-sourcepos=\\\"35:1-35:100\\\"><qiita-embed-ogp src=\\\"https://docs.google.com/spreadsheets/d/1fPE17OVUx0-OBXCRTZAm-vkLn1msYerBis7rN1tMaRc/edit?usp=sharing\\\"></qiita-embed-ogp></p>\\n<p data-sourcepos=\\\"37:1-37:191\\\">\u3042\u3001\u3082\u3061\u308D\u3093\u5B9F\u969B\u306B\u4F7F\u308F\u308C\u3066\u3044\u308B\u30B3\u30FC\u30C9\u304C\u3069\u3093\u306A\u306E\u304B\u898B\u3066\u304B\u3089\u4F7F\u3063\u3066\u307B\u3057\u3044\u306E\u3068\u3001Gmail\u304B\u3089\u6A29\u9650\u8981\u6C42\u3055\u308C\u308B\u306E\u3067\u9069\u5207\u306B\u8A31\u53EF\u3057\u3066\u3042\u3052\u3066\u307B\u3057\u3044\u3002</p>\\n<h2 data-sourcepos=\\\"39:1-39:9\\\">\\n<span id=\\\"\u5B9F\u88C5\\\" class=\\\"fragment\\\"></span><a href=\\\"#%E5%AE%9F%E8%A3%85\\\"><i class=\\\"fa fa-link\\\"></i></a>\u5B9F\u88C5</h2>\\n<div class=\\\"code-frame\\\" data-lang=\\\"javascript\\\" data-sourcepos=\\\"41:1-82:3\\\"><div class=\\\"highlight\\\"><pre><code><span class=\\\"cm\\\">/** *****************************************\\n[ [ '\u9805\u76EE', '\u5185\u5BB9', 'To', 'Name' ],\\n  [ '\u4EF6\u540D', 'XXXX\u306E\u4EF6\u306B\u3064\u3044\u3066', 'example@example.com', '\u958B\u767A\u5BA4example \u3055\u307E' ],\\n  [ '\u66F8\u304D\u51FA\u3057', '', 'example+123@example.com', '\u7DCF\u52D9 \u7530\u4E2D \u3055\u307E' ],\\n  [ '\u672C\u6587', '', '', '' ],\\n  [ 'To\u6B04\u306E\u6570', 2, '', '' ] ]\\n***************************************** */</span>\\n<span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">allData</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">SpreadsheetApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getActiveSheet</span><span class=\\\"p\\\">().</span><span class=\\\"nx\\\">getDataRange</span><span class=\\\"p\\\">().</span><span class=\\\"nx\\\">getValues</span><span class=\\\"p\\\">();</span>\\n\\n<span class=\\\"cm\\\">/** *****************************************\\n['XXXX\u306E\u4EF6\u306B\u3064\u3044\u3066', '\u672C\u6587']\\n***************************************** */</span>\\n<span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">commonData</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">allData</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">filter</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">x</span> <span class=\\\"o\\\">=&gt;</span> <span class=\\\"p\\\">(</span><span class=\\\"nx\\\">x</span><span class=\\\"p\\\">[</span><span class=\\\"mi\\\">0</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">===</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">\u4EF6\u540D</span><span class=\\\"dl\\\">\\\"</span> <span class=\\\"o\\\">||</span> <span class=\\\"nx\\\">x</span><span class=\\\"p\\\">[</span><span class=\\\"mi\\\">0</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">===</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">\u672C\u6587</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">)).</span><span class=\\\"nx\\\">map</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">x</span> <span class=\\\"o\\\">=&gt;</span> <span class=\\\"nx\\\">x</span><span class=\\\"p\\\">[</span><span class=\\\"mi\\\">1</span><span class=\\\"p\\\">]);</span>\\n\\n<span class=\\\"cm\\\">/** *****************************************\\n[ [ 'tanaka@example.com', '\u958B\u767A\u5BA4example \u3055\u307E' ],\\n  [ 'AAA@example.com', '\u7DCF\u52D9 \u7530\u4E2D \u3055\u307E' ] ]\\n***************************************** */</span>\\n<span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">toMailData</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">allData</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">filter</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">x</span> <span class=\\\"o\\\">=&gt;</span> <span class=\\\"p\\\">(</span><span class=\\\"nx\\\">x</span><span class=\\\"p\\\">[</span><span class=\\\"mi\\\">2</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">!==</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">To</span><span class=\\\"dl\\\">\\\"</span> <span class=\\\"o\\\">&amp;&amp;</span> <span class=\\\"nx\\\">x</span><span class=\\\"p\\\">[</span><span class=\\\"mi\\\">2</span><span class=\\\"p\\\">]</span> <span class=\\\"o\\\">!==</span> <span class=\\\"dl\\\">\\\"\\\"</span><span class=\\\"p\\\">)).</span><span class=\\\"nx\\\">map</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">x</span> <span class=\\\"o\\\">=&gt;</span> <span class=\\\"p\\\">[</span><span class=\\\"nx\\\">x</span><span class=\\\"p\\\">[</span><span class=\\\"mi\\\">2</span><span class=\\\"p\\\">],</span> <span class=\\\"nx\\\">x</span><span class=\\\"p\\\">[</span><span class=\\\"mi\\\">3</span><span class=\\\"p\\\">]])</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">createDraft</span><span class=\\\"p\\\">()</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">subject</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">commonData</span><span class=\\\"p\\\">[</span><span class=\\\"mi\\\">0</span><span class=\\\"p\\\">];</span>\\n\\n  <span class=\\\"c1\\\">// GmailApp.createDraft([\\\"hirao@openlogi.com\\\", \\\"hirao+2@openlogi.com\\\"], subject, \\\"body test\\\");</span>\\n\\n  <span class=\\\"nx\\\">toMailData</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">forEach</span><span class=\\\"p\\\">(</span><span class=\\\"k\\\">async</span> <span class=\\\"nx\\\">x</span> <span class=\\\"o\\\">=&gt;</span> <span class=\\\"p\\\">{</span>\\n    <span class=\\\"nx\\\">console</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">log</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">x</span><span class=\\\"p\\\">[</span><span class=\\\"mi\\\">0</span><span class=\\\"p\\\">]);</span>\\n    <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">to</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">x</span><span class=\\\"p\\\">[</span><span class=\\\"mi\\\">0</span><span class=\\\"p\\\">];</span>\\n    <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">body</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">createBody</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">x</span><span class=\\\"p\\\">[</span><span class=\\\"mi\\\">1</span><span class=\\\"p\\\">]);</span>\\n    <span class=\\\"k\\\">await</span> <span class=\\\"nx\\\">GmailApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">createDraft</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">to</span><span class=\\\"p\\\">,</span> <span class=\\\"nx\\\">subject</span><span class=\\\"p\\\">,</span> <span class=\\\"nx\\\">body</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"p\\\">})</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"cm\\\">/**\\n * @todo \u30E1\u30C3\u30BB\u30FC\u30B8\u672C\u6587\u5165\u308C\u305F\u308A\u7F72\u540D\u6B04\u3068\u304B\u62E1\u5F35\u3059\u308B\\n */</span>\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">createBody</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">name</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">name</span> <span class=\\\"o\\\">+</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"se\\\">\\\\n\\\\n</span><span class=\\\"dl\\\">\\\"</span> <span class=\\\"o\\\">+</span> <span class=\\\"nx\\\">commonData</span><span class=\\\"p\\\">[</span><span class=\\\"mi\\\">1</span><span class=\\\"p\\\">];</span>\\n<span class=\\\"p\\\">}</span>\\n\\n</code></pre></div></div>\\n<p data-sourcepos=\\\"87:1-87:120\\\"><code>\u4E0B\u66F8\u304D\u4F5C\u6210</code> \u3063\u3066\u30DC\u30BF\u30F3\u3092\u30B9\u30D7\u30EC\u30C3\u30C9\u30B7\u30FC\u30C8\u5185\u306EGAS\u306E\u95A2\u6570 <code>createDraft</code> \u306B\u7D10\u3065\u3051\u3066\u3044\u307E\u3059\u3002</p>\\n<p data-sourcepos=\\\"90:1-90:285\\\">\u767A\u706B\u3057\u305F\u3089\u3001\u4ECA\u3072\u3089\u3044\u3066\u3044\u308B\u30DA\u30FC\u30B8\u306E\u30C7\u30FC\u30BF\u3092\u8AAD\u307F\u8FBC\u307F\u306B\u3044\u3063\u3066\u30E1\u30FC\u30EB\u9001\u4FE1\u3059\u308B\u306E\u3067\u3001\u3053\u3093\u306A\u611F\u3058\u3067\u3069\u3093\u3069\u3093\u30BF\u30D6\u3092\u8FFD\u52A0\u3057\u3066\u3044\u3063\u3066\u3001\u3069\u306E\u6642\u306F\u3069\u306E\u4EBA\u305F\u3061\u306B\u30E1\u30FC\u30EB\u3092\u9001\u3063\u305F\u306E\u304B\u3001\u305D\u3046\u3044\u3046\u5C65\u6B74\u3082\u308F\u304B\u308A\u307E\u3059\u3067\u3059\u3002</p>\\n<a href=\\\"https://camo.qiitausercontent.com/763a833f552a8f96d06c83ca60c96ec7dc0d9770/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f35333164336333332d313038332d393566642d623831652d6337343932326239616632642e706e67\\\" target=\\\"_blank\\\" rel=\\\"nofollow noopener\\\"><img width=\\\"426\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2020-03-14 15.30.10.png\\\" src=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F531d3c33-1083-95fd-b81e-c74922b9af2d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1bfeba60cd42a4303dccbef53075ab85\\\" data-canonical-src=\\\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/531d3c33-1083-95fd-b81e-c74922b9af2d.png\\\" srcset=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F531d3c33-1083-95fd-b81e-c74922b9af2d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=27779f5a95d1bf6bbc74eeccd457b391 1x\\\" loading=\\\"lazy\\\"></a>\\n<p data-sourcepos=\\\"95:1-95:9\\\">\u4EE5\u4E0A\u3002</p>\\n<p data-sourcepos=\\\"97:1-97:90\\\">\u4ECA\u65E5\u3055\u304F\u3063\u3068\u4F5C\u3063\u305F\u3084\u3064\u3067\u3059\u304C\u3001\u5FC5\u8981\u306A\u65B9\u3044\u305F\u3089\u4F7F\u3063\u3066\u304F\u3060\u3055\u3044\u3002</p>\\n\",\"body\":\"# Gmail\u3067\u5927\u91CF\u306E\u9001\u4FE1\u5148\u306B\u30E1\u30FC\u30EB\u3092\u9001\u308B\u3068\u304D\u306B\u30B9\u30D7\u30EC\u30C3\u30C9\u30B7\u30FC\u30C8\u3067\u7BA1\u7406\u3059\u308B\u30B9\u30AF\u30EA\u30D7\u30C8\u3092\u66F8\u3044\u305F\u306E\u3067\u4F7F\u3063\u3066\u307B\u3057\u3044\u3002\\n\\n\u30B9\u30AF\u30B7\u30E7\u306F\u3053\u3093\u306A\u611F\u3058\u3002\\n\\n<img width=\\\"944\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2020-03-14 15.29.04.png\\\" src=\\\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/f80526fc-b107-853b-81c6-9557e237bed2.png\\\">\\n\\n`\u4E0B\u66F8\u304D\u4F5C\u6210` \u307C\u305F\u3093\u30DD\u30C1\u3059\u308B\u3068\\n\\n<img width=\\\"1351\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2020-03-14 15.32.25.png\\\" src=\\\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/4ff9744d-3480-bc82-de24-05ae5d10a056.png\\\">\\n\\nGmail\u5074\u306B\u4E0B\u66F8\u304D\u304C\u4FDD\u5B58\u3055\u308C\u307E\u3059\u3002\u76EE\u3067\u76EE\u8996\u3057\u3066\u304B\u3089\u4F7F\u3063\u3066\u304F\u308C\u3002\\n\\n## FAQ\\n\\n- BCC\u3058\u3083\u3060\u3081\u306A\u3093\u3067\u3059\u304B\uFF1F\\n    - To\u3067\u305F\u304F\u3055\u3093\u8D08\u308A\u305F\u3044\u3068\u304D\u3082\u3042\u308B\u3088\u306D\u2026\uFF1F\uFF1F\\n- \u3048\u3001\u3082\u3057\u304B\u3057\u3066 \u3072\u3068\u3064\u3072\u3068\u3064\u306E\u5B9B\u5148\u3054\u3068\u306B\u30E1\u30FC\u30EB\u4F5C\u3063\u3066\u304F\u308C\u308B\u306E\uFF1F\\n    - \u305D\u3046\u3067\u3059\uFF01\\n- \u30D7\u30ED\u30B0\u30E9\u30E0\u304B\u3089\u5B9F\u884C\u3059\u308B\u3068\u3001\u9593\u9055\u3063\u305F\u3068\u304D\u306B\u4E0D\u5B89\uFF01\uFF01\uFF01\\n    - \u5927\u4E08\u592B\u3067\u3059\u3002\u4E0B\u66F8\u304D `GmailApp.createDraft(to, subject, body)` \u3067\u4F5C\u3063\u3066\u307E\u3059\uFF01\\n    - \u81EA\u5206\u306E\u76EE\u3067\u78BA\u8A8D\u3057\u3066\u304B\u3089\u3001Gmail\u304B\u3089\u9001\u4FE1\u30DC\u30BF\u30F3\u307D\u3061\u307D\u3061\u3057\u3066\u304F\u3060\u3055\u3044\u3002\\n- \u60AA\u3044\u3053\u3068\u306B\u4F7F\u3063\u3066\u3044\u3044\uFF1F\\n    - \u7D76\u5BFE\u306B\u3084\u3081\u3066\u304F\u3060\u3055\u3044\u3002\u7279\u5B9A\u96FB\u5B50\u30E1\u30FC\u30EB\u6CD5\u306B\u5247\u3063\u3066\u4F7F\u3063\u3066\u304F\u3060\u3055\u3044\u3002\\n\\n## \u5171\u6709\\n\\n\u30D5\u30A1\u30A4\u30EB\u3092\u5171\u6709\u3057\u305F\u306E\u3067\u81EA\u5206\u306E\u30C9\u30E9\u30A4\u30D6\u306B\u30B3\u30D4\u30FC\u3057\u3066\u4F7F\u3063\u3066\u307B\u3057\u3044\u3067\u3059\u3002\\n\u5171\u6709\u30EA\u30AF\u30A8\u30B9\u30C8\u3057\u306A\u3044\u3067\u304F\u3060\u3055\u3044\u306D\u301C\\n\\n\u2193\u5171\u6709\u30EA\u30AF\u30A8\u30B9\u30C8\u304F\u308B\u305F\u3073\u306B\u30E1\u30FC\u30EB\u304D\u3066\u307E\u3059\u3002\\n\\n![\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2023-01-15 21.14.32.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/c6604099-920f-fc0a-1db0-3c520765e698.png)\\n\\n\\nhttps://docs.google.com/spreadsheets/d/1fPE17OVUx0-OBXCRTZAm-vkLn1msYerBis7rN1tMaRc/edit?usp=sharing\\n\\n\u3042\u3001\u3082\u3061\u308D\u3093\u5B9F\u969B\u306B\u4F7F\u308F\u308C\u3066\u3044\u308B\u30B3\u30FC\u30C9\u304C\u3069\u3093\u306A\u306E\u304B\u898B\u3066\u304B\u3089\u4F7F\u3063\u3066\u307B\u3057\u3044\u306E\u3068\u3001Gmail\u304B\u3089\u6A29\u9650\u8981\u6C42\u3055\u308C\u308B\u306E\u3067\u9069\u5207\u306B\u8A31\u53EF\u3057\u3066\u3042\u3052\u3066\u307B\u3057\u3044\u3002\\n\\n## \u5B9F\u88C5\\n\\n```javascript\\n/** *****************************************\\n[ [ '\u9805\u76EE', '\u5185\u5BB9', 'To', 'Name' ],\\n  [ '\u4EF6\u540D', 'XXXX\u306E\u4EF6\u306B\u3064\u3044\u3066', 'example@example.com', '\u958B\u767A\u5BA4example \u3055\u307E' ],\\n  [ '\u66F8\u304D\u51FA\u3057', '', 'example+123@example.com', '\u7DCF\u52D9 \u7530\u4E2D \u3055\u307E' ],\\n  [ '\u672C\u6587', '', '', '' ],\\n  [ 'To\u6B04\u306E\u6570', 2, '', '' ] ]\\n***************************************** */\\nconst allData = SpreadsheetApp.getActiveSheet().getDataRange().getValues();\\n\\n/** *****************************************\\n['XXXX\u306E\u4EF6\u306B\u3064\u3044\u3066', '\u672C\u6587']\\n***************************************** */\\nconst commonData = allData.filter(x => (x[0] === \\\"\u4EF6\u540D\\\" || x[0] === \\\"\u672C\u6587\\\")).map(x => x[1]);\\n\\n/** *****************************************\\n[ [ 'tanaka@example.com', '\u958B\u767A\u5BA4example \u3055\u307E' ],\\n  [ 'AAA@example.com', '\u7DCF\u52D9 \u7530\u4E2D \u3055\u307E' ] ]\\n***************************************** */\\nconst toMailData = allData.filter(x => (x[2] !== \\\"To\\\" && x[2] !== \\\"\\\")).map(x => [x[2], x[3]])\\n\\nfunction createDraft() {\\n  const subject = commonData[0];\\n\\n  // GmailApp.createDraft([\\\"hirao@openlogi.com\\\", \\\"hirao+2@openlogi.com\\\"], subject, \\\"body test\\\");\\n\\n  toMailData.forEach(async x => {\\n    console.log(x[0]);\\n    const to = x[0];\\n    const body = createBody(x[1]);\\n    await GmailApp.createDraft(to, subject, body);\\n  })\\n}\\n\\n/**\\n * @todo \u30E1\u30C3\u30BB\u30FC\u30B8\u672C\u6587\u5165\u308C\u305F\u308A\u7F72\u540D\u6B04\u3068\u304B\u62E1\u5F35\u3059\u308B\\n */\\nfunction createBody(name) {\\n  return name + \\\"\\\\n\\\\n\\\" + commonData[1];\\n}\\n\\n```\\n\\n\\n\\n\\n`\u4E0B\u66F8\u304D\u4F5C\u6210` \u3063\u3066\u30DC\u30BF\u30F3\u3092\u30B9\u30D7\u30EC\u30C3\u30C9\u30B7\u30FC\u30C8\u5185\u306EGAS\u306E\u95A2\u6570 `createDraft` \u306B\u7D10\u3065\u3051\u3066\u3044\u307E\u3059\u3002\\n\\n\\n\u767A\u706B\u3057\u305F\u3089\u3001\u4ECA\u3072\u3089\u3044\u3066\u3044\u308B\u30DA\u30FC\u30B8\u306E\u30C7\u30FC\u30BF\u3092\u8AAD\u307F\u8FBC\u307F\u306B\u3044\u3063\u3066\u30E1\u30FC\u30EB\u9001\u4FE1\u3059\u308B\u306E\u3067\u3001\u3053\u3093\u306A\u611F\u3058\u3067\u3069\u3093\u3069\u3093\u30BF\u30D6\u3092\u8FFD\u52A0\u3057\u3066\u3044\u3063\u3066\u3001\u3069\u306E\u6642\u306F\u3069\u306E\u4EBA\u305F\u3061\u306B\u30E1\u30FC\u30EB\u3092\u9001\u3063\u305F\u306E\u304B\u3001\u305D\u3046\u3044\u3046\u5C65\u6B74\u3082\u308F\u304B\u308A\u307E\u3059\u3067\u3059\u3002\\n\\n<img width=\\\"426\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2020-03-14 15.30.10.png\\\" src=\\\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/531d3c33-1083-95fd-b81e-c74922b9af2d.png\\\">\\n\\n\\n\u4EE5\u4E0A\u3002\\n\\n\u4ECA\u65E5\u3055\u304F\u3063\u3068\u4F5C\u3063\u305F\u3084\u3064\u3067\u3059\u304C\u3001\u5FC5\u8981\u306A\u65B9\u3044\u305F\u3089\u4F7F\u3063\u3066\u304F\u3060\u3055\u3044\u3002\\n\",\"coediting\":false,\"comments_count\":0,\"created_at\":\"2020-03-14T15:33:41+09:00\",\"group\":null,\"id\":\"7392b9d2d8c2096e2332\",\"likes_count\":5,\"private\":false,\"reactions_count\":0,\"stocks_count\":4,\"tags\":[{\"name\":\"JavaScript\",\"versions\":[]},{\"name\":\"GAS\",\"versions\":[]},{\"name\":\"Gmail\",\"versions\":[]}],\"title\":\"\u3010\u5927\u91CF\u306EGmail\u3092\u4E00\u62EC\u4E0B\u66F8\u304D\u4F5C\u6210\u3011\u30B9\u30D7\u30EC\u30C3\u30C9\u30B7\u30FC\u30C8\u304B\u3089\u7BA1\u7406\u3059\u308B\u30B9\u30AF\u30EA\u30D7\u30C8\u3092\u66F8\u3044\u305F\u306E\u3067\u4F7F\u3063\u3066\u307B\u3057\u3044\u3002\",\"updated_at\":\"2023-01-15T21:17:04+09:00\",\"url\":\"https://qiita.com/ykhirao/items/7392b9d2d8c2096e2332\",\"user\":{\"description\":\"Web Developer For 6 years.\\r\\nPHP/Laravel && (React OR Vue.js)\\r\\nTypeScript/node.js\\r\\n\\r\\n\u696D\u52D9\u59D4\u8A17\u306E\u4F9D\u983C\u3068\u304B\u306FWantedly\u3068\u304B\u304B\u3089\u3067\u304A\u9858\u3044\u3057\u307E\u3059\uFF01\",\"facebook_id\":\"\",\"followees_count\":38,\"followers_count\":96,\"github_login_name\":\"ykhirao\",\"id\":\"ykhirao\",\"items_count\":62,\"linkedin_id\":\"\",\"location\":\"Tokyo, Japan\",\"name\":\"yk\",\"organization\":\"\",\"permanent_id\":112929,\"profile_image_url\":\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/profile-images/1639030792\",\"team_only\":false,\"twitter_screen_name\":\"ykhirao\",\"website_url\":\"https://www.wantedly.com/id/ykhirao\"},\"page_views_count\":null,\"team_membership\":null}},\"path\":\"posts/7392b9d2d8c2096e2332\",\"sharedData\":{},\"siteData\":{\"updatedAt\":\"2023/03/06\"}}");</script><script defer="" type="text/javascript" src="/templates/styles.ac7c013c.js"></script><script defer="" type="text/javascript" src="/templates/vendors~main.867a25a5.js"></script><script defer="" type="text/javascript" src="/main.80784f3b.js"></script></body></html>