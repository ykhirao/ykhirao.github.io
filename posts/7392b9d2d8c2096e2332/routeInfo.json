{"template":"__react_static_root__/src/components/QiitaPost","sharedHashesByProp":{},"data":{"post":{"rendered_body":"\n<h1>\n<span id=\"gmailで大量の送信先にメールを送るときにスプレッドシートで管理するスクリプトを書いたので使ってほしい\" class=\"fragment\"></span><a href=\"#gmail%E3%81%A7%E5%A4%A7%E9%87%8F%E3%81%AE%E9%80%81%E4%BF%A1%E5%85%88%E3%81%AB%E3%83%A1%E3%83%BC%E3%83%AB%E3%82%92%E9%80%81%E3%82%8B%E3%81%A8%E3%81%8D%E3%81%AB%E3%82%B9%E3%83%97%E3%83%AC%E3%83%83%E3%83%89%E3%82%B7%E3%83%BC%E3%83%88%E3%81%A7%E7%AE%A1%E7%90%86%E3%81%99%E3%82%8B%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%82%92%E6%9B%B8%E3%81%84%E3%81%9F%E3%81%AE%E3%81%A7%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BB%E3%81%97%E3%81%84\"><i class=\"fa fa-link\"></i></a>Gmailで大量の送信先にメールを送るときにスプレッドシートで管理するスクリプトを書いたので使ってほしい。</h1>\n\n<p>スクショはこんな感じ。</p>\n\n<p><a href=\"https://camo.qiitausercontent.com/b33ced787ae0f9adc8dbb1be8b521a3f594e6a07/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f66383035323666632d623130372d383533622d383163362d3935353765323337626564322e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img width=\"944\" alt=\"スクリーンショット 2020-03-14 15.29.04.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2Ff80526fc-b107-853b-81c6-9557e237bed2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=17b8b022a7973f78b56e048435d22d79\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/f80526fc-b107-853b-81c6-9557e237bed2.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2Ff80526fc-b107-853b-81c6-9557e237bed2.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=1de81c0f2aad7ac7e751a056f38156a8 1x\" loading=\"lazy\"></a></p>\n\n<p><code>下書き作成</code> ぼたんポチすると</p>\n\n<p><a href=\"https://camo.qiitausercontent.com/e60634aca0c6db4d0fa5eb149719c3bd349e31be/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f34666639373434642d333438302d626338322d646532342d3035616535643130613035362e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img width=\"1351\" alt=\"スクリーンショット 2020-03-14 15.32.25.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F4ff9744d-3480-bc82-de24-05ae5d10a056.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=9f62a1b3930a24a8cdeba2ba8ac522c4\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/4ff9744d-3480-bc82-de24-05ae5d10a056.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F4ff9744d-3480-bc82-de24-05ae5d10a056.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b3682d3594055533678cdd49b7b369ad 1x\" loading=\"lazy\"></a></p>\n\n<p>Gmail側に下書きが保存されます。目で目視してから使ってくれ。</p>\n\n<h2>\n<span id=\"faq\" class=\"fragment\"></span><a href=\"#faq\"><i class=\"fa fa-link\"></i></a>FAQ</h2>\n\n<ul>\n<li>BCCじゃだめなんですか？\n\n<ul>\n<li>Toでたくさん贈りたいときもあるよね…？？</li>\n</ul>\n</li>\n<li>え、もしかして ひとつひとつの宛先ごとにメール作ってくれるの？\n\n<ul>\n<li>そうです！</li>\n</ul>\n</li>\n<li>プログラムから実行すると、間違ったときに不安！！！\n\n<ul>\n<li>大丈夫です。下書き <code>GmailApp.createDraft(to, subject, body)</code> で作ってます！</li>\n<li>自分の目で確認してから、Gmailから送信ボタンぽちぽちしてください。</li>\n</ul>\n</li>\n<li>悪いことに使っていい？\n\n<ul>\n<li>絶対にやめてください。特定電子メール法に則って使ってください。</li>\n</ul>\n</li>\n</ul>\n\n<h2>\n<span id=\"共有\" class=\"fragment\"></span><a href=\"#%E5%85%B1%E6%9C%89\"><i class=\"fa fa-link\"></i></a>共有</h2>\n\n<p>ファイルを共有したので自分のドライブにコピーして使ってほしい。</p>\n\n<p><qiita-embed-ogp src=\"https://docs.google.com/spreadsheets/d/1fPE17OVUx0-OBXCRTZAm-vkLn1msYerBis7rN1tMaRc/edit?usp=sharing\"></qiita-embed-ogp></p>\n\n<p>あ、もちろん実際に使われているコードがどんなのか見てから使ってほしいのと、Gmailから権限要求されるので適切に許可してあげてほしい。</p>\n\n<h2>\n<span id=\"実装\" class=\"fragment\"></span><a href=\"#%E5%AE%9F%E8%A3%85\"><i class=\"fa fa-link\"></i></a>実装</h2>\n\n<div class=\"code-frame\" data-lang=\"javascript\"><div class=\"highlight\"><pre><code><span class=\"cm\">/** *****************************************\n[ [ '項目', '内容', 'To', 'Name' ],\n  [ '件名', 'XXXXの件について', 'example@example.com', '開発室example さま' ],\n  [ '書き出し', '', 'example+123@example.com', '総務 田中 さま' ],\n  [ '本文', '', '', '' ],\n  [ 'To欄の数', 2, '', '' ] ]\n***************************************** */</span>\n<span class=\"kd\">const</span> <span class=\"nx\">allData</span> <span class=\"o\">=</span> <span class=\"nx\">SpreadsheetApp</span><span class=\"p\">.</span><span class=\"nx\">getActiveSheet</span><span class=\"p\">().</span><span class=\"nx\">getDataRange</span><span class=\"p\">().</span><span class=\"nx\">getValues</span><span class=\"p\">();</span>\n\n<span class=\"cm\">/** *****************************************\n['XXXXの件について', '本文']\n***************************************** */</span>\n<span class=\"kd\">const</span> <span class=\"nx\">commonData</span> <span class=\"o\">=</span> <span class=\"nx\">allData</span><span class=\"p\">.</span><span class=\"nx\">filter</span><span class=\"p\">(</span><span class=\"nx\">x</span> <span class=\"o\">=&gt;</span> <span class=\"p\">(</span><span class=\"nx\">x</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">===</span> <span class=\"dl\">\"</span><span class=\"s2\">件名</span><span class=\"dl\">\"</span> <span class=\"o\">||</span> <span class=\"nx\">x</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">===</span> <span class=\"dl\">\"</span><span class=\"s2\">本文</span><span class=\"dl\">\"</span><span class=\"p\">)).</span><span class=\"nx\">map</span><span class=\"p\">(</span><span class=\"nx\">x</span> <span class=\"o\">=&gt;</span> <span class=\"nx\">x</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]);</span>\n\n<span class=\"cm\">/** *****************************************\n[ [ 'tanaka@example.com', '開発室example さま' ],\n  [ 'AAA@example.com', '総務 田中 さま' ] ]\n***************************************** */</span>\n<span class=\"kd\">const</span> <span class=\"nx\">toMailData</span> <span class=\"o\">=</span> <span class=\"nx\">allData</span><span class=\"p\">.</span><span class=\"nx\">filter</span><span class=\"p\">(</span><span class=\"nx\">x</span> <span class=\"o\">=&gt;</span> <span class=\"p\">(</span><span class=\"nx\">x</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span> <span class=\"o\">!==</span> <span class=\"dl\">\"</span><span class=\"s2\">To</span><span class=\"dl\">\"</span> <span class=\"o\">&amp;&amp;</span> <span class=\"nx\">x</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span> <span class=\"o\">!==</span> <span class=\"dl\">\"\"</span><span class=\"p\">)).</span><span class=\"nx\">map</span><span class=\"p\">(</span><span class=\"nx\">x</span> <span class=\"o\">=&gt;</span> <span class=\"p\">[</span><span class=\"nx\">x</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">],</span> <span class=\"nx\">x</span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]])</span>\n\n<span class=\"kd\">function</span> <span class=\"nx\">createDraft</span><span class=\"p\">()</span> <span class=\"p\">{</span>\n  <span class=\"kd\">const</span> <span class=\"nx\">subject</span> <span class=\"o\">=</span> <span class=\"nx\">commonData</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">];</span>\n\n  <span class=\"c1\">// GmailApp.createDraft([\"hirao@openlogi.com\", \"hirao+2@openlogi.com\"], subject, \"body test\");</span>\n\n  <span class=\"nx\">toMailData</span><span class=\"p\">.</span><span class=\"nx\">forEach</span><span class=\"p\">(</span><span class=\"k\">async</span> <span class=\"nx\">x</span> <span class=\"o\">=&gt;</span> <span class=\"p\">{</span>\n    <span class=\"nx\">console</span><span class=\"p\">.</span><span class=\"nx\">log</span><span class=\"p\">(</span><span class=\"nx\">x</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]);</span>\n    <span class=\"kd\">const</span> <span class=\"nx\">to</span> <span class=\"o\">=</span> <span class=\"nx\">x</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">];</span>\n    <span class=\"kd\">const</span> <span class=\"nx\">body</span> <span class=\"o\">=</span> <span class=\"nx\">createBody</span><span class=\"p\">(</span><span class=\"nx\">x</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]);</span>\n    <span class=\"k\">await</span> <span class=\"nx\">GmailApp</span><span class=\"p\">.</span><span class=\"nx\">createDraft</span><span class=\"p\">(</span><span class=\"nx\">to</span><span class=\"p\">,</span> <span class=\"nx\">subject</span><span class=\"p\">,</span> <span class=\"nx\">body</span><span class=\"p\">);</span>\n  <span class=\"p\">})</span>\n<span class=\"p\">}</span>\n\n<span class=\"cm\">/**\n * @todo メッセージ本文入れたり署名欄とか拡張する\n */</span>\n<span class=\"kd\">function</span> <span class=\"nx\">createBody</span><span class=\"p\">(</span><span class=\"nx\">name</span><span class=\"p\">)</span> <span class=\"p\">{</span>\n  <span class=\"k\">return</span> <span class=\"nx\">name</span> <span class=\"o\">+</span> <span class=\"dl\">\"</span><span class=\"se\">\\n\\n</span><span class=\"dl\">\"</span> <span class=\"o\">+</span> <span class=\"nx\">commonData</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">];</span>\n<span class=\"p\">}</span>\n\n</code></pre></div></div>\n\n<p><code>下書き作成</code> ってボタンをスプレッドシート内のGASの関数 <code>createDraft</code> に紐づけています。</p>\n\n<p>発火したら、今ひらいているページのデータを読み込みにいってメール送信するので、こんな感じでどんどんタブを追加していって、どの時はどの人たちにメールを送ったのか、そういう履歴もわかりますです。</p>\n\n<p><a href=\"https://camo.qiitausercontent.com/763a833f552a8f96d06c83ca60c96ec7dc0d9770/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f35333164336333332d313038332d393566642d623831652d6337343932326239616632642e706e67\" target=\"_blank\" rel=\"nofollow noopener\"><img width=\"426\" alt=\"スクリーンショット 2020-03-14 15.30.10.png\" src=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F531d3c33-1083-95fd-b81e-c74922b9af2d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=1bfeba60cd42a4303dccbef53075ab85\" data-canonical-src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/531d3c33-1083-95fd-b81e-c74922b9af2d.png\" srcset=\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F531d3c33-1083-95fd-b81e-c74922b9af2d.png?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=27779f5a95d1bf6bbc74eeccd457b391 1x\" loading=\"lazy\"></a></p>\n\n<p>以上。</p>\n\n<p>今日さくっと作ったやつですが、必要な方いたら使ってください。</p>\n","body":"# Gmailで大量の送信先にメールを送るときにスプレッドシートで管理するスクリプトを書いたので使ってほしい。\n\nスクショはこんな感じ。\n\n<img width=\"944\" alt=\"スクリーンショット 2020-03-14 15.29.04.png\" src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/f80526fc-b107-853b-81c6-9557e237bed2.png\">\n\n`下書き作成` ぼたんポチすると\n\n<img width=\"1351\" alt=\"スクリーンショット 2020-03-14 15.32.25.png\" src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/4ff9744d-3480-bc82-de24-05ae5d10a056.png\">\n\nGmail側に下書きが保存されます。目で目視してから使ってくれ。\n\n## FAQ\n\n- BCCじゃだめなんですか？\n    - Toでたくさん贈りたいときもあるよね…？？\n- え、もしかして ひとつひとつの宛先ごとにメール作ってくれるの？\n    - そうです！\n- プログラムから実行すると、間違ったときに不安！！！\n    - 大丈夫です。下書き `GmailApp.createDraft(to, subject, body)` で作ってます！\n    - 自分の目で確認してから、Gmailから送信ボタンぽちぽちしてください。\n- 悪いことに使っていい？\n    - 絶対にやめてください。特定電子メール法に則って使ってください。\n\n## 共有\n\nファイルを共有したので自分のドライブにコピーして使ってほしい。\n\nhttps://docs.google.com/spreadsheets/d/1fPE17OVUx0-OBXCRTZAm-vkLn1msYerBis7rN1tMaRc/edit?usp=sharing\n\nあ、もちろん実際に使われているコードがどんなのか見てから使ってほしいのと、Gmailから権限要求されるので適切に許可してあげてほしい。\n\n## 実装\n\n```javascript\n/** *****************************************\n[ [ '項目', '内容', 'To', 'Name' ],\n  [ '件名', 'XXXXの件について', 'example@example.com', '開発室example さま' ],\n  [ '書き出し', '', 'example+123@example.com', '総務 田中 さま' ],\n  [ '本文', '', '', '' ],\n  [ 'To欄の数', 2, '', '' ] ]\n***************************************** */\nconst allData = SpreadsheetApp.getActiveSheet().getDataRange().getValues();\n\n/** *****************************************\n['XXXXの件について', '本文']\n***************************************** */\nconst commonData = allData.filter(x => (x[0] === \"件名\" || x[0] === \"本文\")).map(x => x[1]);\n\n/** *****************************************\n[ [ 'tanaka@example.com', '開発室example さま' ],\n  [ 'AAA@example.com', '総務 田中 さま' ] ]\n***************************************** */\nconst toMailData = allData.filter(x => (x[2] !== \"To\" && x[2] !== \"\")).map(x => [x[2], x[3]])\n\nfunction createDraft() {\n  const subject = commonData[0];\n\n  // GmailApp.createDraft([\"hirao@openlogi.com\", \"hirao+2@openlogi.com\"], subject, \"body test\");\n\n  toMailData.forEach(async x => {\n    console.log(x[0]);\n    const to = x[0];\n    const body = createBody(x[1]);\n    await GmailApp.createDraft(to, subject, body);\n  })\n}\n\n/**\n * @todo メッセージ本文入れたり署名欄とか拡張する\n */\nfunction createBody(name) {\n  return name + \"\\n\\n\" + commonData[1];\n}\n\n```\n\n\n\n\n`下書き作成` ってボタンをスプレッドシート内のGASの関数 `createDraft` に紐づけています。\n\n\n発火したら、今ひらいているページのデータを読み込みにいってメール送信するので、こんな感じでどんどんタブを追加していって、どの時はどの人たちにメールを送ったのか、そういう履歴もわかりますです。\n\n<img width=\"426\" alt=\"スクリーンショット 2020-03-14 15.30.10.png\" src=\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/531d3c33-1083-95fd-b81e-c74922b9af2d.png\">\n\n\n以上。\n\n今日さくっと作ったやつですが、必要な方いたら使ってください。\n","coediting":false,"comments_count":0,"created_at":"2020-03-14T15:33:41+09:00","group":null,"id":"7392b9d2d8c2096e2332","likes_count":5,"private":false,"reactions_count":0,"tags":[{"name":"JavaScript","versions":[]},{"name":"gas","versions":[]},{"name":"gmail","versions":[]}],"title":"【大量のGmailを一括下書き作成】スプレッドシートから管理するスクリプトを書いたので使ってほしい。","updated_at":"2020-03-14T15:53:50+09:00","url":"https://qiita.com/ykhirao/items/7392b9d2d8c2096e2332","user":{"description":"Web Developer For 6 years.\r\nPHP/Laravel && (React OR Vue.js)\r\nTypeScript/node.js\r\n\r\n業務委託の依頼とかはWantedlyとかからでお願いします！","facebook_id":"","followees_count":38,"followers_count":95,"github_login_name":"ykhirao","id":"ykhirao","items_count":59,"linkedin_id":"","location":"Tokyo, Japan","name":"yk","organization":"","permanent_id":112929,"profile_image_url":"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/profile-images/1639030792","team_only":false,"twitter_screen_name":"yk_hirao","website_url":"https://www.wantedly.com/id/ykhirao"},"page_views_count":null,"team_membership":null}},"path":"posts/7392b9d2d8c2096e2332"}
