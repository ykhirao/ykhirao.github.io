<!DOCTYPE html><html lang="en"><head><meta name="generator" content="React Static"/><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, shrink-to-fit=no"/><link rel="preload" as="script" href="/templates/styles.5353cbc5.js"/><link rel="preload" as="script" href="/templates/vendors~main.991a9778.js"/><link rel="preload" as="script" href="/main.e4c894d8.js"/><link rel="preload" as="style" href="/styles.642cfcb4.css"/><link rel="stylesheet" href="/styles.642cfcb4.css"/><link rel="shortcut icon" href="/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png"/><link rel="manifest" href="/manifest.json"/><meta name="mobile-web-app-capable" content="yes"/><meta name="theme-color" content="#fff"/><meta name="application-name"/><link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png"/><link rel="apple-touch-icon" sizes="167x167" href="/apple-touch-icon-167x167.png"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"/><link rel="apple-touch-icon" sizes="1024x1024" href="/apple-touch-icon-1024x1024.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/><meta name="apple-mobile-web-app-title"/><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-640x1136.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-750x1334.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-828x1792.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1125x2436.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2208.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2688.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1536x2048.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2224.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2388.png"/><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-2048x2732.png"/><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1620x2160.png"/><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1136x640.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1334x750.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1792x828.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2436x1125.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2208x1242.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2688x1242.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2048x1536.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2224x1668.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2388x1668.png"/><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2732x2048.png"/><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1620.png"/><link rel="icon" type="image/png" sizes="228x228" href="/coast-228x228.png"/><meta name="msapplication-TileColor" content="#fff"/><meta name="msapplication-TileImage" content="/mstile-144x144.png"/><meta name="msapplication-config" content="/browserconfig.xml"/><link rel="yandex-tableau-widget" href="/yandex-browser-manifest.json"/></head><body><div id="root"><div style="outline:none" tabindex="-1"><nav class="navbar is-dark is-fixed-top" role="navigation" aria-label="main navigation"><div class="container"><div class="navbar-brand"><a class="navbar-item" href="/">Home</a><a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false"><span aria-hidden="true"></span><span aria-hidden="true"></span><span aria-hidden="true"></span></a></div><div id="navbarBasicExample" class="navbar-menu "><div class="navbar-start"><a class="navbar-item" href="/posts">Posts</a><a class="navbar-item" href="/events">Events</a><a class="navbar-item" href="/github">GitHub</a></div></div></div></nav><div class="container"><div class="is-primary" style="padding:4.5rem 0.5rem"><div style="outline:none" tabindex="-1"><div><a href="/posts">&lt;<!-- --> Back</a><br/><h3>月末営業日にタスクをリマインドする ~ 使うのはSlackとGoogleアカウントだけで10分くらいで実装できるよ ~</h3><article class="md-body">
<h1>
<span id="月末って忙しいよね" class="fragment"></span><a href="#%E6%9C%88%E6%9C%AB%E3%81%A3%E3%81%A6%E5%BF%99%E3%81%97%E3%81%84%E3%82%88%E3%81%AD"><i class="fa fa-link"></i></a>月末って忙しいよね…</h1>

<p>月末って報告書とか、領収証とか…なんかたくさん出さなきゃいけないものあるよね。センパイが「誰か作って」って言ってたのをGoogle apps scriptで作成しました。<br>
Google apps script[GAS]触りだして4日目くらいですが、かなり便利なのでエンジニア以外のもっとたくさんの人に触れて欲しいなと思い、連日ですがGASの実用例をあげたいと思います。</p>

<h1>
<span id="完成品" class="fragment"></span><a href="#%E5%AE%8C%E6%88%90%E5%93%81"><i class="fa fa-link"></i></a>完成品</h1>

<p>月末の営業日にSlack投げるだけのシンプルな実装です。<br>
コピペすれば10分で実装いけるんじゃないかと！</p>

<p><a href="https://camo.qiitausercontent.com/b149deb75bd6943500f82a6c5d8d688217114df0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f65366537633034382d336463642d303934382d306430642d3539376266313438616534642e6a706567" target="_blank" rel="nofollow noopener"><img width="555" alt="スクリーンショット 2017-03-06 21.29.19.jpg" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fe6e7c048-3dcd-0948-0d0d-597bf148ae4d.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=db2b6d3bde4acf38d998fc70597a61ff" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/112929/e6e7c048-3dcd-0948-0d0d-597bf148ae4d.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fe6e7c048-3dcd-0948-0d0d-597bf148ae4d.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b80bcb2bc2bc1b56c1da86ddedf85763 1x" loading="lazy"></a></p>

<h2>
<span id="完成までに使用するもの" class="fragment"></span><a href="#%E5%AE%8C%E6%88%90%E3%81%BE%E3%81%A7%E3%81%AB%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E3%82%82%E3%81%AE"><i class="fa fa-link"></i></a>完成までに使用するもの</h2>

<p>Googleアカウント[Google Apps Script]<br>
Slack</p>

<h2>
<span id="完成したら" class="fragment"></span><a href="#%E5%AE%8C%E6%88%90%E3%81%97%E3%81%9F%E3%82%89"><i class="fa fa-link"></i></a>完成したら</h2>

<p>以下の2つもコード公開します<br>
* 月初めの営業日になにかをする<br>
* 月始めの第一金曜日になにかをする</p>

<p>つまりこれを応用すれば、いつ何時でもSlackで自動チャットを飛ばせるようになる。</p>

<h1>
<span id="月末締め" class="fragment"></span><a href="#%E6%9C%88%E6%9C%AB%E7%B7%A0%E3%82%81"><i class="fa fa-link"></i></a>月末締め…！！</h1>

<p>画像ありでどんどんいくよ〜〜</p>

<h2>
<span id="slack-tokenの取得" class="fragment"></span><a href="#slack-token%E3%81%AE%E5%8F%96%E5%BE%97"><i class="fa fa-link"></i></a>Slack Tokenの取得</h2>

<p>ここを参考にしてみて！<br>
<a href="http://qiita.com/ykhirao/items/0d6b9f4a0cc626884dbb" class="autolink" id="reference-a3696fbcff57fc2bef93">http://qiita.com/ykhirao/items/0d6b9f4a0cc626884dbb</a></p>

<p>xoxp-18127　こんな感じの長い数字。</p>

<p>Slack持ってない人は<a href="http://qiita.com/saitotak/items/ac0eb7ddc0d8d83cbe91" id="reference-c27f8c53fed184064594">個人Slackのススメ</a>にしたがって導入をすすめます。</p>

<h2>
<span id="gasの導入" class="fragment"></span><a href="#gas%E3%81%AE%E5%B0%8E%E5%85%A5"><i class="fa fa-link"></i></a>GASの導入</h2>

<p>Googleドライブにアクセス<br>
<a href="https://drive.google.com/drive/my-drive" class="autolink" rel="nofollow noopener" target="_blank">https://drive.google.com/drive/my-drive</a></p>

<p><a href="https://camo.qiitausercontent.com/1bb999134bf657ebc975ba39db895e0f36c15e55/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f66303630333130352d656232332d613763612d353362652d3865353933643130343531362e6a706567" target="_blank" rel="nofollow noopener"><img width="1192" alt="スクリーンショット 2017-03-06 21.59.16.jpg" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Ff0603105-eb23-a7ca-53be-8e593d104516.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3d95220c7d0ec307b0b324bb8d73aaab" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/112929/f0603105-eb23-a7ca-53be-8e593d104516.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Ff0603105-eb23-a7ca-53be-8e593d104516.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=68314d0b8ed179a3da5a49d9d6b4f9b6 1x" loading="lazy"></a></p>

<p><code>新規 &gt;&gt; その他 &gt;&gt; アプリを追加</code><br>
から Google apps script を検索・追加</p>

<p><a href="https://camo.qiitausercontent.com/596401421f94304589195d90bbb93d19d32c5092/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f35663537396630642d326432342d333462362d383633342d6137663066343836393533372e6a706567" target="_blank" rel="nofollow noopener"><img width="1196" alt="スクリーンショット 2017-03-06 22.00.23.jpg" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F5f579f0d-2d24-34b6-8634-a7f0f4869537.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=0027e01d18fcdad909aeda9c3be9d951" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/112929/5f579f0d-2d24-34b6-8634-a7f0f4869537.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F5f579f0d-2d24-34b6-8634-a7f0f4869537.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3aa8708c5121478d83d7e4c59f2526c4 1x" loading="lazy"></a></p>

<p>そうすると<code>新規 &gt;&gt; その他 &gt;&gt; Google apps script</code>を押してみてください。<br>
GAS画面になると思います。</p>

<h2>
<span id="gasの編集" class="fragment"></span><a href="#gas%E3%81%AE%E7%B7%A8%E9%9B%86"><i class="fa fa-link"></i></a>GASの編集</h2>

<p><a href="https://camo.qiitausercontent.com/ca5e3c94c0855ef18d78bc41926692f9d7dc8f04/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f66636661393739642d323635322d663739352d633562612d6362376465343063616230322e6a706567" target="_blank" rel="nofollow noopener"><img width="816" alt="スクリーンショット 2017-03-06 22.23.56.jpg" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Ffcfa979d-2652-f795-c5ba-cb7de40cab02.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f194163c0f34c56245cc49838e67f960" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/112929/fcfa979d-2652-f795-c5ba-cb7de40cab02.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Ffcfa979d-2652-f795-c5ba-cb7de40cab02.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=6f030ab2a9355861517cfef200d34f54 1x" loading="lazy"></a></p>

<p>メインの部分にこれを貼り付けてみよう！</p>

<div class="code-frame" data-lang="js"><div class="highlight"><pre><code>
<span class="cm">/*
  メインの処理
  setTriggerDay() : 最終営業日(0時)に次の処理をする命令を出す。
  setTriggerHoursLast() : 最終営業日の18時に次の命令を出す。
  sendSlack() : slackにデータを投げる。

  サブ的な処理
  deleteTrigger() : 蓄積されている命令を削除する
  lastBusinessDay() : 今月の最終営業日を求める
  isHoliday() : 本日が[日本の祝日]かどうかチェック。土日は曜日で判定してるチェック
  .getDay()　: Dateオブジェクトから曜日を求めるメソッド(0:日, 6:土曜日)
*/</span>

<span class="kd">function</span> <span class="nx">setTriggerDay</span><span class="p">()</span>
<span class="p">{</span>  
  <span class="kd">var</span> <span class="nx">last</span> <span class="o">=</span> <span class="nx">lastBusinessDay</span><span class="p">();</span>
  <span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">newTrigger</span><span class="p">(</span><span class="dl">"</span><span class="s2">setTriggerHoursLast</span><span class="dl">"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">timeBased</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">atDate</span><span class="p">(</span><span class="nx">last</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">last</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nx">last</span><span class="p">.</span><span class="nx">getDate</span><span class="p">())</span>
    <span class="p">.</span><span class="nx">create</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">setTriggerHoursLast</span><span class="p">()</span>
<span class="p">{</span>
  <span class="nx">deleteTrigger</span><span class="p">(</span><span class="dl">"</span><span class="s2">setTriggerHoursLast</span><span class="dl">"</span><span class="p">);</span>
  <span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">newTrigger</span><span class="p">(</span><span class="dl">"</span><span class="s2">sendSlack</span><span class="dl">"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">timeBased</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">after</span><span class="p">(</span> <span class="mi">18</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">1000</span> <span class="p">)</span>
    <span class="p">.</span><span class="nx">create</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">sendSlack</span><span class="p">()</span> 
<span class="p">{</span>
  <span class="nx">deleteTrigger</span><span class="p">(</span><span class="dl">"</span><span class="s2">sendSlack</span><span class="dl">"</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> 
  <span class="p">{</span>
    <span class="dl">"</span><span class="s2">method</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">payload</span><span class="dl">"</span> <span class="p">:</span> 
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">token</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">********************</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">channel</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">bot-test</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">領収書出しましたか？忘れてないよね。</span><span class="se">\</span><span class="s2">ｎhttp://.../</span><span class="dl">"</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://slack.com/api/chat.postMessage</span><span class="dl">"</span>
  <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">lastBusinessDay</span><span class="p">()</span> 
<span class="p">{</span>
  <span class="kd">var</span> <span class="nx">today</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>

  <span class="kd">var</span> <span class="nx">lastDayOfThisMonth</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">today</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">today</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">day</span><span class="p">;</span> <span class="c1">// 0-&gt;日曜日</span>

  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">day</span> <span class="o">=</span> <span class="nx">lastDayOfThisMonth</span><span class="p">.</span><span class="nx">getDay</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">day</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">day</span> <span class="o">==</span> <span class="mi">6</span> <span class="o">||</span> <span class="nx">isHoliday</span><span class="p">(</span><span class="nx">lastDayOfThisMonth</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">lastDayOfThisMonth</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">today</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">today</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="nx">i</span><span class="p">);</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">lastDayOfThisMonth</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">deleteTrigger</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> 
<span class="p">{</span>
  <span class="kd">var</span> <span class="nx">triggers</span> <span class="o">=</span> <span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">getProjectTriggers</span><span class="p">();</span>
  <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">triggers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">triggers</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">getHandlerFunction</span><span class="p">()</span> <span class="o">==</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">deleteTrigger</span><span class="p">(</span><span class="nx">triggers</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">isHoliday</span><span class="p">(</span><span class="nx">day</span><span class="p">)</span> 
<span class="p">{</span>
  <span class="kd">var</span> <span class="nx">startDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">day</span><span class="p">.</span><span class="nx">setHours</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
  <span class="kd">var</span> <span class="nx">endDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">day</span><span class="p">.</span><span class="nx">setHours</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">59</span><span class="p">));</span>
  <span class="kd">var</span> <span class="nx">cal</span> <span class="o">=</span> <span class="nx">CalendarApp</span><span class="p">.</span><span class="nx">getCalendarById</span><span class="p">(</span><span class="dl">"</span><span class="s2">ja.japanese#holiday@group.v.calendar.google.com</span><span class="dl">"</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">holidays</span> <span class="o">=</span>  <span class="nx">cal</span><span class="p">.</span><span class="nx">getEvents</span><span class="p">(</span><span class="nx">startDate</span><span class="p">,</span> <span class="nx">endDate</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">holidays</span><span class="p">.</span><span class="nx">length</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// 祝日ならtrue</span>
<span class="p">}</span>

</code></pre></div></div>

<p>sendSlackのここは個人設定に変えてください！</p>

<ul>
<li>"token": "********************",</li>
<li>"channel": "bot-test",</li>
<li>"text": "領収書出しましたか？忘れてないよね。\ｎhttp://.../"</li>
</ul>

<h2>
<span id="settriggerdayの実行と取り消しと毎月実行" class="fragment"></span><a href="#settriggerday%E3%81%AE%E5%AE%9F%E8%A1%8C%E3%81%A8%E5%8F%96%E3%82%8A%E6%B6%88%E3%81%97%E3%81%A8%E6%AF%8E%E6%9C%88%E5%AE%9F%E8%A1%8C"><i class="fa fa-link"></i></a>setTriggerDay()の実行と取り消しと毎月実行</h2>

<p>実行 &gt;&gt; setTriggerDay<br>
をおしてみよう。</p>

<p><a href="https://camo.qiitausercontent.com/2943d9ffc3472a260a7b8b49cf1dd129d6215eaa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f36656238366532392d613466392d346664302d653632642d3736613861663233336137322e6a706567" target="_blank" rel="nofollow noopener"><img width="527" alt="スクリーンショット 2017-03-06 22.26.52.jpg" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F6eb86e29-a4f9-4fd0-e62d-76a8af233a72.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=41f721b304f5cec115d59b983c938b0b" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/112929/6eb86e29-a4f9-4fd0-e62d-76a8af233a72.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F6eb86e29-a4f9-4fd0-e62d-76a8af233a72.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=e1491c09dfdf657c2ef3aff033538ed5 1x" loading="lazy"></a></p>

<p>リソース &gt;&gt; 現在のプロジェクトのトリガー<br>
ここからトリガー（何時にあれを実行しなさい）を確認できます。</p>

<p><a href="https://camo.qiitausercontent.com/3b08a873f77b7d6e66e6950e4b4d91c82fd6c443/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f64616566616139312d353166632d306662662d343035372d6233313663386265343562312e6a706567" target="_blank" rel="nofollow noopener"><img width="648" alt="スクリーンショット 2017-03-06 22.27.40.jpg" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fdaefaa91-51fc-0fbf-4057-b316c8be45b1.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=962a2c45562cefc53b007fdfc8ff1fc8" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/112929/daefaa91-51fc-0fbf-4057-b316c8be45b1.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fdaefaa91-51fc-0fbf-4057-b316c8be45b1.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=2b7a193799802c5662a3b3b0c37d5e9e 1x" loading="lazy"></a></p>

<p>ここで 2017/03/21 夜中丁度に setTriggerHoursLast が実行されるようになっていたら大丈夫。setTriggerHoursLastは18時間後にSlack送りなさいという命令です。</p>

<p><a href="https://camo.qiitausercontent.com/7e6b6f79bffa7dac4f99d0ed7c62440e61ac39e6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f62623663663961322d616566372d373639632d633639622d6261346561613962336539382e6a706567" target="_blank" rel="nofollow noopener"><img width="838" alt="スクリーンショット 2017-03-06 22.27.47.jpg" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fbb6cf9a2-aef7-769c-c69b-ba4eaa9b3e98.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=19baf0caf865485764a2109df380591b" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/112929/bb6cf9a2-aef7-769c-c69b-ba4eaa9b3e98.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fbb6cf9a2-aef7-769c-c69b-ba4eaa9b3e98.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=230c496677d16423f56ac98744f89e3d 1x" loading="lazy"></a></p>

<p>またついでにこの画面でsetTriggerDayを毎月1日6時くらいにセットします。</p>

<p><a href="https://camo.qiitausercontent.com/03a0f1662ae9b4984279eca9bed6bfc52894518b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f33323838633963382d646561372d356264642d656566612d3433666337373335666366622e6a706567" target="_blank" rel="nofollow noopener"><img width="836" alt="スクリーンショット 2017-03-06 22.37.18.jpg" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F3288c9c8-dea7-5bdd-eefa-43fc7735fcfb.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=617a1a8877077bb4ae243b8b31e33d37" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/112929/3288c9c8-dea7-5bdd-eefa-43fc7735fcfb.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F3288c9c8-dea7-5bdd-eefa-43fc7735fcfb.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f2dd1d807c95f0919a362633f312b55c 1x" loading="lazy"></a></p>

<p>そうすると毎月1日にsetTriggerDayが実行されて<br>
-&gt; setTriggerDay :最終日に次を実行<br>
-&gt; setTriggerHoursLast :18時に次を実行<br>
-&gt; sendSlack :Slackを実行</p>

<p>って感じで毎月、最終日トリガーを作成してくれます。</p>

<h2>
<span id="functionごとに見ていく" class="fragment"></span><a href="#function%E3%81%94%E3%81%A8%E3%81%AB%E8%A6%8B%E3%81%A6%E3%81%84%E3%81%8F"><i class="fa fa-link"></i></a>functionごとに見ていく</h2>

<p>簡単にみていきます。</p>

<h3>
<span id="settriggerday" class="fragment"></span><a href="#settriggerday"><i class="fa fa-link"></i></a>setTriggerDay</h3>

<div class="code-frame" data-lang="js"><div class="highlight"><pre><code><span class="kd">function</span> <span class="nx">setTriggerDay</span><span class="p">()</span>
<span class="p">{</span>  
  <span class="kd">var</span> <span class="nx">last</span> <span class="o">=</span> <span class="nx">lastBusinessDay</span><span class="p">();</span>
  <span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">newTrigger</span><span class="p">(</span><span class="dl">"</span><span class="s2">setTriggerHoursLast</span><span class="dl">"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">timeBased</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">atDate</span><span class="p">(</span><span class="nx">last</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">last</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nx">last</span><span class="p">.</span><span class="nx">getDate</span><span class="p">())</span>
    <span class="p">.</span><span class="nx">create</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<p>lastBusinessDay()で営業日最終日のDateオブジェクトを取ってきて<br>
.atDate(last.getMonth()+1)としているところは、月は0月始まりとなっているからです。</p>

<h3>
<span id="settriggerhourslast" class="fragment"></span><a href="#settriggerhourslast"><i class="fa fa-link"></i></a>setTriggerHoursLast</h3>

<div class="code-frame" data-lang="js"><div class="highlight"><pre><code><span class="kd">function</span> <span class="nx">setTriggerHoursLast</span><span class="p">()</span>
<span class="p">{</span>
  <span class="nx">deleteTrigger</span><span class="p">(</span><span class="dl">"</span><span class="s2">setTriggerHoursLast</span><span class="dl">"</span><span class="p">);</span>
  <span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">newTrigger</span><span class="p">(</span><span class="dl">"</span><span class="s2">sendSlack</span><span class="dl">"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">timeBased</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">after</span><span class="p">(</span> <span class="mi">18</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">1000</span> <span class="p">)</span>
    <span class="p">.</span><span class="nx">create</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<p>.after( 18 * 60 * 60 * 1000 )でミリ秒後にトリガーをセットしてます。</p>

<h3>
<span id="sendslack" class="fragment"></span><a href="#sendslack"><i class="fa fa-link"></i></a>sendSlack</h3>

<div class="code-frame" data-lang="js"><div class="highlight"><pre><code><span class="kd">function</span> <span class="nx">sendSlack</span><span class="p">()</span> 
<span class="p">{</span>
  <span class="nx">deleteTrigger</span><span class="p">(</span><span class="dl">"</span><span class="s2">sendSlack</span><span class="dl">"</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> 
  <span class="p">{</span>
    <span class="dl">"</span><span class="s2">method</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">payload</span><span class="dl">"</span> <span class="p">:</span> 
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">token</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">********************</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">channel</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">bot-test</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">領収書出しましたか？忘れてないよね。</span><span class="se">\</span><span class="s2">ｎhttp://.../</span><span class="dl">"</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://slack.com/api/chat.postMessage</span><span class="dl">"</span>
  <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>こういう書き方だと思っていただければ…<br>
詳しくは公式ドキュメントで　<a href="https://api.slack.com/methods/chat.postMessage" class="autolink" rel="nofollow noopener" target="_blank">https://api.slack.com/methods/chat.postMessage</a></p>

<h3>
<span id="lastbusinessday" class="fragment"></span><a href="#lastbusinessday"><i class="fa fa-link"></i></a>lastBusinessDay</h3>

<div class="code-frame" data-lang="js"><div class="highlight"><pre><code><span class="kd">function</span> <span class="nx">lastBusinessDay</span><span class="p">()</span> 
<span class="p">{</span>
  <span class="kd">var</span> <span class="nx">today</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
  <span class="kd">var</span> <span class="nx">lastDayOfThisMonth</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">today</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">today</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">day</span><span class="p">;</span> <span class="c1">// 0-&gt;日曜日</span>

  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">day</span> <span class="o">=</span> <span class="nx">lastDayOfThisMonth</span><span class="p">.</span><span class="nx">getDay</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">day</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">day</span> <span class="o">==</span> <span class="mi">6</span> <span class="o">||</span> <span class="nx">isHoliday</span><span class="p">(</span><span class="nx">lastDayOfThisMonth</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">lastDayOfThisMonth</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">today</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">today</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="nx">i</span><span class="p">);</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">lastDayOfThisMonth</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>day == 0 || day == 6 || isHoliday(lastDayOfThisMonth)<br>
ここで土日もしくは祝日判定をしています。</p>

<h3>
<span id="deletetrigger" class="fragment"></span><a href="#deletetrigger"><i class="fa fa-link"></i></a>deleteTrigger</h3>

<div class="code-frame" data-lang="js"><div class="highlight"><pre><code>
<span class="kd">function</span> <span class="nx">deleteTrigger</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> 
<span class="p">{</span>
  <span class="kd">var</span> <span class="nx">triggers</span> <span class="o">=</span> <span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">getProjectTriggers</span><span class="p">();</span>
  <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">triggers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">triggers</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">getHandlerFunction</span><span class="p">()</span> <span class="o">==</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">deleteTrigger</span><span class="p">(</span><span class="nx">triggers</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<p>実は自分でセットしたtriggerってこんな感じで1分ごとにたまっていきます。<br>
今回だと"MAIAMAIN"って名前のトリガーを全削除する機能になってます。<br>
<a href="https://camo.qiitausercontent.com/18f33b9bf701e7e2189b93dcbdab932fc9b61457/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f61633666346337632d663134322d663463612d663764632d6639353038386263373131382e6a706567" target="_blank" rel="nofollow noopener"><img width="735" alt="スクリーンショット 2017-03-06 23.14.29.jpg" src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fac6f4c7c-f142-f4ca-f7dc-f95088bc7118.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=36fd1a6a74b29b8998d068ac6e5dbb5d" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/112929/ac6f4c7c-f142-f4ca-f7dc-f95088bc7118.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fac6f4c7c-f142-f4ca-f7dc-f95088bc7118.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bcde38fa01a6d1b60bb0a3bef5ea1a2a 1x" loading="lazy"></a></p>

<p>参考：　<a href="http://qiita.com/sumi-engraphia/items/465dd027e17f44da4d6a" class="autolink" id="reference-6cdb302138342d02b062">http://qiita.com/sumi-engraphia/items/465dd027e17f44da4d6a</a></p>

<h3>
<span id="isholiday" class="fragment"></span><a href="#isholiday"><i class="fa fa-link"></i></a>isHoliday</h3>

<div class="code-frame" data-lang="js"><div class="highlight"><pre><code>
<span class="kd">function</span> <span class="nx">isHoliday</span><span class="p">(</span><span class="nx">day</span><span class="p">)</span> 
<span class="p">{</span>
  <span class="kd">var</span> <span class="nx">startDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">day</span><span class="p">.</span><span class="nx">setHours</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
  <span class="kd">var</span> <span class="nx">endDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">day</span><span class="p">.</span><span class="nx">setHours</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">59</span><span class="p">));</span>
  <span class="kd">var</span> <span class="nx">cal</span> <span class="o">=</span> <span class="nx">CalendarApp</span><span class="p">.</span><span class="nx">getCalendarById</span><span class="p">(</span><span class="dl">"</span><span class="s2">ja.japanese#holiday@group.v.calendar.google.com</span><span class="dl">"</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">holidays</span> <span class="o">=</span>  <span class="nx">cal</span><span class="p">.</span><span class="nx">getEvents</span><span class="p">(</span><span class="nx">startDate</span><span class="p">,</span> <span class="nx">endDate</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">holidays</span><span class="p">.</span><span class="nx">length</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// 祝日ならtrue</span>
<span class="p">}</span>

</code></pre></div></div>

<p>getCalendarByIdでGoogleの[日本の祝日]を取得してきてます。</p>

<p>参考：　<a href="http://qiita.com/kamatama_41/items/be40e05524530920a9d9" class="autolink" id="reference-5a809bb3572c78f54395">http://qiita.com/kamatama_41/items/be40e05524530920a9d9</a></p>

<p>終わりました〜〜<br>
次は月初めの営業日を取っていきます〜〜</p>

<h1>
<span id="月初めの営業日" class="fragment"></span><a href="#%E6%9C%88%E5%88%9D%E3%82%81%E3%81%AE%E5%96%B6%E6%A5%AD%E6%97%A5"><i class="fa fa-link"></i></a>月初めの営業日</h1>

<div class="code-frame" data-lang="js"><div class="highlight"><pre><code>
<span class="cm">/*
  メインの処理
  setTriggerDay() : はじめの営業日(0時)に次の処理をする命令を出す。
  setTriggerHoursFirst() : はじめの営業日の11時に次の命令を出す。
  sendSlack() : slackにデータを投げる。

  サブ的な処理
  deleteTrigger() : 蓄積されている命令を削除する
  firstNextBusinessDay() : 来月のはじめの営業日を求める
  isHoliday() : 本日が[日本の祝日]かどうかチェック。土日は曜日で判定してるチェック
  .getDay()　: Dateオブジェクトから曜日を求めるメソッド(0:日, 6:土曜日)
*/</span>

<span class="kd">function</span> <span class="nx">setTriggerDay2</span><span class="p">()</span>
<span class="p">{</span>  
  <span class="kd">var</span> <span class="nx">first</span> <span class="o">=</span> <span class="nx">firstNextBusinessDay</span><span class="p">();</span>
  <span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">newTrigger</span><span class="p">(</span><span class="dl">"</span><span class="s2">setTriggerHoursFirst</span><span class="dl">"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">timeBased</span><span class="p">()</span>
    <span class="p">.</span><span class="nx">atDate</span><span class="p">(</span><span class="nx">first</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">first</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nx">first</span><span class="p">.</span><span class="nx">getDate</span><span class="p">())</span>
    <span class="p">.</span><span class="nx">create</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">setTriggerHoursFirst</span><span class="p">()</span>
<span class="p">{</span>
 <span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">newTrigger</span><span class="p">(</span><span class="dl">"</span><span class="s2">sendSlack</span><span class="dl">"</span><span class="p">)</span>
   <span class="p">.</span><span class="nx">timeBased</span><span class="p">()</span>
   <span class="p">.</span><span class="nx">after</span><span class="p">(</span><span class="mi">11</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
   <span class="p">.</span><span class="nx">create</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">sendSlack</span><span class="p">()</span> 
<span class="p">{</span>
  <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> 
  <span class="p">{</span>
    <span class="dl">"</span><span class="s2">method</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">payload</span><span class="dl">"</span> <span class="p">:</span> 
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">token</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">********************</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">channel</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">bot-test</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">text</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">月が始まりました。</span><span class="dl">"</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://slack.com/api/chat.postMessage</span><span class="dl">"</span>
  <span class="nx">UrlFetchApp</span><span class="p">.</span><span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">firstNextBusinessDay</span><span class="p">()</span> 
<span class="p">{</span>
  <span class="kd">var</span> <span class="nx">today</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>  
  <span class="kd">var</span> <span class="nx">firstDayOfNextMonth</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">today</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">today</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">day</span><span class="p">;</span> <span class="c1">// 0-&gt;日曜日</span>

  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">day</span> <span class="o">=</span> <span class="nx">firstDayOfNextMonth</span><span class="p">.</span><span class="nx">getDay</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">day</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">day</span> <span class="o">==</span> <span class="mi">6</span> <span class="o">||</span> <span class="nx">isHoliday</span><span class="p">(</span><span class="nx">firstDayOfNextMonth</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">firstDayOfThisMonth</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">today</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">today</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">(),</span> <span class="nx">i</span><span class="p">);</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">firstDayOfNextMonth</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">deleteTrigger</span><span class="p">()</span> 
<span class="p">{</span>
  <span class="kd">var</span> <span class="nx">triggers</span> <span class="o">=</span> <span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">getProjectTriggers</span><span class="p">();</span>
  <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">triggers</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">triggers</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">getHandlerFunction</span><span class="p">()</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">main</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">ScriptApp</span><span class="p">.</span><span class="nx">deleteTrigger</span><span class="p">(</span><span class="nx">triggers</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">isHoliday</span><span class="p">(</span><span class="nx">day</span><span class="p">)</span> 
<span class="p">{</span>
  <span class="kd">var</span> <span class="nx">startDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">day</span><span class="p">.</span><span class="nx">setHours</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">));</span>
  <span class="kd">var</span> <span class="nx">endDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">day</span><span class="p">.</span><span class="nx">setHours</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">59</span><span class="p">));</span>
  <span class="kd">var</span> <span class="nx">cal</span> <span class="o">=</span> <span class="nx">CalendarApp</span><span class="p">.</span><span class="nx">getCalendarById</span><span class="p">(</span><span class="dl">"</span><span class="s2">ja.japanese#holiday@group.v.calendar.google.com</span><span class="dl">"</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">holidays</span> <span class="o">=</span>  <span class="nx">cal</span><span class="p">.</span><span class="nx">getEvents</span><span class="p">(</span><span class="nx">startDate</span><span class="p">,</span> <span class="nx">endDate</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">holidays</span><span class="p">.</span><span class="nx">length</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// 祝日ならtrue</span>
<span class="p">}</span>

</code></pre></div></div>

<h1>
<span id="第一月曜日営業日" class="fragment"></span><a href="#%E7%AC%AC%E4%B8%80%E6%9C%88%E6%9B%9C%E6%97%A5%E5%96%B6%E6%A5%AD%E6%97%A5"><i class="fa fa-link"></i></a>第一月曜日営業日</h1>

<div class="code-frame" data-lang="js"><div class="highlight"><pre><code>
<span class="kd">function</span> <span class="nx">firstNextBusinessMonDay</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">today</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>

  <span class="kd">var</span> <span class="nx">firstDayOfNextMonth</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">today</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">today</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">day</span><span class="p">;</span> <span class="c1">// 0-&gt;日曜日</span>

  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">day</span> <span class="o">=</span> <span class="nx">firstDayOfNextMonth</span><span class="p">.</span><span class="nx">getDay</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">day</span> <span class="o">!=</span> <span class="mi">1</span> <span class="o">||</span> <span class="nx">isHoliday</span><span class="p">(</span><span class="nx">firstDayOfNextMonth</span><span class="p">))</span> <span class="p">{</span>
      <span class="nx">firstDayOfThisMonth</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">today</span><span class="p">.</span><span class="nx">getFullYear</span><span class="p">(),</span> <span class="nx">today</span><span class="p">.</span><span class="nx">getMonth</span><span class="p">(),</span> <span class="nx">i</span><span class="p">);</span>
      <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">break</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">firstDayOfNextMonth</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<p>ここだけ変えればいいかな、こんな感じ？<br>
1日から探索して、月曜日以外もしくは祝日なら次の日にいく。</p>

<p>以上です。</p>

<h1>
<span id="終わりに" class="fragment"></span><a href="#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>終わりに</h1>

<p>重要なことはそのままおコピペしてなんかやらかしちゃったとか責任とれないんで(ミスあっても、Slackがあれるとか、もしくは通知されないとか？)自身の環境でデバックしてからお使いください！</p>

<p>Google Apps Script楽しい！</p>

<p>.</p>
</article></div></div></div></div><footer class="footer"><div class="content has-text-centered"><p>last uploaded at <!-- -->2024/03/18</p><p>© 2021 ykhirao</p></div></footer></div></div><script type="text/javascript">window.__routeInfo = JSON.parse("{\"template\":\"__react_static_root__/src/components/QiitaPost\",\"sharedHashesByProp\":{},\"data\":{\"post\":{\"rendered_body\":\"\\n<h1>\\n<span id=\\\"\u6708\u672B\u3063\u3066\u5FD9\u3057\u3044\u3088\u306D\\\" class=\\\"fragment\\\"></span><a href=\\\"#%E6%9C%88%E6%9C%AB%E3%81%A3%E3%81%A6%E5%BF%99%E3%81%97%E3%81%84%E3%82%88%E3%81%AD\\\"><i class=\\\"fa fa-link\\\"></i></a>\u6708\u672B\u3063\u3066\u5FD9\u3057\u3044\u3088\u306D\u2026</h1>\\n\\n<p>\u6708\u672B\u3063\u3066\u5831\u544A\u66F8\u3068\u304B\u3001\u9818\u53CE\u8A3C\u3068\u304B\u2026\u306A\u3093\u304B\u305F\u304F\u3055\u3093\u51FA\u3055\u306A\u304D\u3083\u3044\u3051\u306A\u3044\u3082\u306E\u3042\u308B\u3088\u306D\u3002\u30BB\u30F3\u30D1\u30A4\u304C\u300C\u8AB0\u304B\u4F5C\u3063\u3066\u300D\u3063\u3066\u8A00\u3063\u3066\u305F\u306E\u3092Google apps script\u3067\u4F5C\u6210\u3057\u307E\u3057\u305F\u3002<br>\\nGoogle apps script[GAS]\u89E6\u308A\u3060\u3057\u30664\u65E5\u76EE\u304F\u3089\u3044\u3067\u3059\u304C\u3001\u304B\u306A\u308A\u4FBF\u5229\u306A\u306E\u3067\u30A8\u30F3\u30B8\u30CB\u30A2\u4EE5\u5916\u306E\u3082\u3063\u3068\u305F\u304F\u3055\u3093\u306E\u4EBA\u306B\u89E6\u308C\u3066\u6B32\u3057\u3044\u306A\u3068\u601D\u3044\u3001\u9023\u65E5\u3067\u3059\u304CGAS\u306E\u5B9F\u7528\u4F8B\u3092\u3042\u3052\u305F\u3044\u3068\u601D\u3044\u307E\u3059\u3002</p>\\n\\n<h1>\\n<span id=\\\"\u5B8C\u6210\u54C1\\\" class=\\\"fragment\\\"></span><a href=\\\"#%E5%AE%8C%E6%88%90%E5%93%81\\\"><i class=\\\"fa fa-link\\\"></i></a>\u5B8C\u6210\u54C1</h1>\\n\\n<p>\u6708\u672B\u306E\u55B6\u696D\u65E5\u306BSlack\u6295\u3052\u308B\u3060\u3051\u306E\u30B7\u30F3\u30D7\u30EB\u306A\u5B9F\u88C5\u3067\u3059\u3002<br>\\n\u30B3\u30D4\u30DA\u3059\u308C\u307010\u5206\u3067\u5B9F\u88C5\u3044\u3051\u308B\u3093\u3058\u3083\u306A\u3044\u304B\u3068\uFF01</p>\\n\\n<p><a href=\\\"https://camo.qiitausercontent.com/b149deb75bd6943500f82a6c5d8d688217114df0/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f65366537633034382d336463642d303934382d306430642d3539376266313438616534642e6a706567\\\" target=\\\"_blank\\\" rel=\\\"nofollow noopener\\\"><img width=\\\"555\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 21.29.19.jpg\\\" src=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fe6e7c048-3dcd-0948-0d0d-597bf148ae4d.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=db2b6d3bde4acf38d998fc70597a61ff\\\" data-canonical-src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/e6e7c048-3dcd-0948-0d0d-597bf148ae4d.jpeg\\\" srcset=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fe6e7c048-3dcd-0948-0d0d-597bf148ae4d.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=b80bcb2bc2bc1b56c1da86ddedf85763 1x\\\" loading=\\\"lazy\\\"></a></p>\\n\\n<h2>\\n<span id=\\\"\u5B8C\u6210\u307E\u3067\u306B\u4F7F\u7528\u3059\u308B\u3082\u306E\\\" class=\\\"fragment\\\"></span><a href=\\\"#%E5%AE%8C%E6%88%90%E3%81%BE%E3%81%A7%E3%81%AB%E4%BD%BF%E7%94%A8%E3%81%99%E3%82%8B%E3%82%82%E3%81%AE\\\"><i class=\\\"fa fa-link\\\"></i></a>\u5B8C\u6210\u307E\u3067\u306B\u4F7F\u7528\u3059\u308B\u3082\u306E</h2>\\n\\n<p>Google\u30A2\u30AB\u30A6\u30F3\u30C8[Google Apps Script]<br>\\nSlack</p>\\n\\n<h2>\\n<span id=\\\"\u5B8C\u6210\u3057\u305F\u3089\\\" class=\\\"fragment\\\"></span><a href=\\\"#%E5%AE%8C%E6%88%90%E3%81%97%E3%81%9F%E3%82%89\\\"><i class=\\\"fa fa-link\\\"></i></a>\u5B8C\u6210\u3057\u305F\u3089</h2>\\n\\n<p>\u4EE5\u4E0B\u306E2\u3064\u3082\u30B3\u30FC\u30C9\u516C\u958B\u3057\u307E\u3059<br>\\n* \u6708\u521D\u3081\u306E\u55B6\u696D\u65E5\u306B\u306A\u306B\u304B\u3092\u3059\u308B<br>\\n* \u6708\u59CB\u3081\u306E\u7B2C\u4E00\u91D1\u66DC\u65E5\u306B\u306A\u306B\u304B\u3092\u3059\u308B</p>\\n\\n<p>\u3064\u307E\u308A\u3053\u308C\u3092\u5FDC\u7528\u3059\u308C\u3070\u3001\u3044\u3064\u4F55\u6642\u3067\u3082Slack\u3067\u81EA\u52D5\u30C1\u30E3\u30C3\u30C8\u3092\u98DB\u3070\u305B\u308B\u3088\u3046\u306B\u306A\u308B\u3002</p>\\n\\n<h1>\\n<span id=\\\"\u6708\u672B\u7DE0\u3081\\\" class=\\\"fragment\\\"></span><a href=\\\"#%E6%9C%88%E6%9C%AB%E7%B7%A0%E3%82%81\\\"><i class=\\\"fa fa-link\\\"></i></a>\u6708\u672B\u7DE0\u3081\u2026\uFF01\uFF01</h1>\\n\\n<p>\u753B\u50CF\u3042\u308A\u3067\u3069\u3093\u3069\u3093\u3044\u304F\u3088\u301C\u301C</p>\\n\\n<h2>\\n<span id=\\\"slack-token\u306E\u53D6\u5F97\\\" class=\\\"fragment\\\"></span><a href=\\\"#slack-token%E3%81%AE%E5%8F%96%E5%BE%97\\\"><i class=\\\"fa fa-link\\\"></i></a>Slack Token\u306E\u53D6\u5F97</h2>\\n\\n<p>\u3053\u3053\u3092\u53C2\u8003\u306B\u3057\u3066\u307F\u3066\uFF01<br>\\n<a href=\\\"http://qiita.com/ykhirao/items/0d6b9f4a0cc626884dbb\\\" class=\\\"autolink\\\" id=\\\"reference-a3696fbcff57fc2bef93\\\">http://qiita.com/ykhirao/items/0d6b9f4a0cc626884dbb</a></p>\\n\\n<p>xoxp-18127\u3000\u3053\u3093\u306A\u611F\u3058\u306E\u9577\u3044\u6570\u5B57\u3002</p>\\n\\n<p>Slack\u6301\u3063\u3066\u306A\u3044\u4EBA\u306F<a href=\\\"http://qiita.com/saitotak/items/ac0eb7ddc0d8d83cbe91\\\" id=\\\"reference-c27f8c53fed184064594\\\">\u500B\u4EBASlack\u306E\u30B9\u30B9\u30E1</a>\u306B\u3057\u305F\u304C\u3063\u3066\u5C0E\u5165\u3092\u3059\u3059\u3081\u307E\u3059\u3002</p>\\n\\n<h2>\\n<span id=\\\"gas\u306E\u5C0E\u5165\\\" class=\\\"fragment\\\"></span><a href=\\\"#gas%E3%81%AE%E5%B0%8E%E5%85%A5\\\"><i class=\\\"fa fa-link\\\"></i></a>GAS\u306E\u5C0E\u5165</h2>\\n\\n<p>Google\u30C9\u30E9\u30A4\u30D6\u306B\u30A2\u30AF\u30BB\u30B9<br>\\n<a href=\\\"https://drive.google.com/drive/my-drive\\\" class=\\\"autolink\\\" rel=\\\"nofollow noopener\\\" target=\\\"_blank\\\">https://drive.google.com/drive/my-drive</a></p>\\n\\n<p><a href=\\\"https://camo.qiitausercontent.com/1bb999134bf657ebc975ba39db895e0f36c15e55/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f66303630333130352d656232332d613763612d353362652d3865353933643130343531362e6a706567\\\" target=\\\"_blank\\\" rel=\\\"nofollow noopener\\\"><img width=\\\"1192\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 21.59.16.jpg\\\" src=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Ff0603105-eb23-a7ca-53be-8e593d104516.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=3d95220c7d0ec307b0b324bb8d73aaab\\\" data-canonical-src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/f0603105-eb23-a7ca-53be-8e593d104516.jpeg\\\" srcset=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Ff0603105-eb23-a7ca-53be-8e593d104516.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=68314d0b8ed179a3da5a49d9d6b4f9b6 1x\\\" loading=\\\"lazy\\\"></a></p>\\n\\n<p><code>\u65B0\u898F &gt;&gt; \u305D\u306E\u4ED6 &gt;&gt; \u30A2\u30D7\u30EA\u3092\u8FFD\u52A0</code><br>\\n\u304B\u3089 Google apps script \u3092\u691C\u7D22\u30FB\u8FFD\u52A0</p>\\n\\n<p><a href=\\\"https://camo.qiitausercontent.com/596401421f94304589195d90bbb93d19d32c5092/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f35663537396630642d326432342d333462362d383633342d6137663066343836393533372e6a706567\\\" target=\\\"_blank\\\" rel=\\\"nofollow noopener\\\"><img width=\\\"1196\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 22.00.23.jpg\\\" src=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F5f579f0d-2d24-34b6-8634-a7f0f4869537.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=0027e01d18fcdad909aeda9c3be9d951\\\" data-canonical-src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/5f579f0d-2d24-34b6-8634-a7f0f4869537.jpeg\\\" srcset=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F5f579f0d-2d24-34b6-8634-a7f0f4869537.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=3aa8708c5121478d83d7e4c59f2526c4 1x\\\" loading=\\\"lazy\\\"></a></p>\\n\\n<p>\u305D\u3046\u3059\u308B\u3068<code>\u65B0\u898F &gt;&gt; \u305D\u306E\u4ED6 &gt;&gt; Google apps script</code>\u3092\u62BC\u3057\u3066\u307F\u3066\u304F\u3060\u3055\u3044\u3002<br>\\nGAS\u753B\u9762\u306B\u306A\u308B\u3068\u601D\u3044\u307E\u3059\u3002</p>\\n\\n<h2>\\n<span id=\\\"gas\u306E\u7DE8\u96C6\\\" class=\\\"fragment\\\"></span><a href=\\\"#gas%E3%81%AE%E7%B7%A8%E9%9B%86\\\"><i class=\\\"fa fa-link\\\"></i></a>GAS\u306E\u7DE8\u96C6</h2>\\n\\n<p><a href=\\\"https://camo.qiitausercontent.com/ca5e3c94c0855ef18d78bc41926692f9d7dc8f04/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f66636661393739642d323635322d663739352d633562612d6362376465343063616230322e6a706567\\\" target=\\\"_blank\\\" rel=\\\"nofollow noopener\\\"><img width=\\\"816\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 22.23.56.jpg\\\" src=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Ffcfa979d-2652-f795-c5ba-cb7de40cab02.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=f194163c0f34c56245cc49838e67f960\\\" data-canonical-src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/fcfa979d-2652-f795-c5ba-cb7de40cab02.jpeg\\\" srcset=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Ffcfa979d-2652-f795-c5ba-cb7de40cab02.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=6f030ab2a9355861517cfef200d34f54 1x\\\" loading=\\\"lazy\\\"></a></p>\\n\\n<p>\u30E1\u30A4\u30F3\u306E\u90E8\u5206\u306B\u3053\u308C\u3092\u8CBC\u308A\u4ED8\u3051\u3066\u307F\u3088\u3046\uFF01</p>\\n\\n<div class=\\\"code-frame\\\" data-lang=\\\"js\\\"><div class=\\\"highlight\\\"><pre><code>\\n<span class=\\\"cm\\\">/*\\n  \u30E1\u30A4\u30F3\u306E\u51E6\u7406\\n  setTriggerDay() : \u6700\u7D42\u55B6\u696D\u65E5(0\u6642)\u306B\u6B21\u306E\u51E6\u7406\u3092\u3059\u308B\u547D\u4EE4\u3092\u51FA\u3059\u3002\\n  setTriggerHoursLast() : \u6700\u7D42\u55B6\u696D\u65E5\u306E18\u6642\u306B\u6B21\u306E\u547D\u4EE4\u3092\u51FA\u3059\u3002\\n  sendSlack() : slack\u306B\u30C7\u30FC\u30BF\u3092\u6295\u3052\u308B\u3002\\n\\n  \u30B5\u30D6\u7684\u306A\u51E6\u7406\\n  deleteTrigger() : \u84C4\u7A4D\u3055\u308C\u3066\u3044\u308B\u547D\u4EE4\u3092\u524A\u9664\u3059\u308B\\n  lastBusinessDay() : \u4ECA\u6708\u306E\u6700\u7D42\u55B6\u696D\u65E5\u3092\u6C42\u3081\u308B\\n  isHoliday() : \u672C\u65E5\u304C[\u65E5\u672C\u306E\u795D\u65E5]\u304B\u3069\u3046\u304B\u30C1\u30A7\u30C3\u30AF\u3002\u571F\u65E5\u306F\u66DC\u65E5\u3067\u5224\u5B9A\u3057\u3066\u308B\u30C1\u30A7\u30C3\u30AF\\n  .getDay()\u3000: Date\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u304B\u3089\u66DC\u65E5\u3092\u6C42\u3081\u308B\u30E1\u30BD\u30C3\u30C9(0:\u65E5, 6:\u571F\u66DC\u65E5)\\n*/</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">setTriggerDay</span><span class=\\\"p\\\">()</span>\\n<span class=\\\"p\\\">{</span>  \\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">last</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">lastBusinessDay</span><span class=\\\"p\\\">();</span>\\n  <span class=\\\"nx\\\">ScriptApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">newTrigger</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">setTriggerHoursLast</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">)</span>\\n    <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">timeBased</span><span class=\\\"p\\\">()</span>\\n    <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">atDate</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">last</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getFullYear</span><span class=\\\"p\\\">(),</span> <span class=\\\"nx\\\">last</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getMonth</span><span class=\\\"p\\\">()</span><span class=\\\"o\\\">+</span><span class=\\\"mi\\\">1</span><span class=\\\"p\\\">,</span> <span class=\\\"nx\\\">last</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getDate</span><span class=\\\"p\\\">())</span>\\n    <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">create</span><span class=\\\"p\\\">();</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">setTriggerHoursLast</span><span class=\\\"p\\\">()</span>\\n<span class=\\\"p\\\">{</span>\\n  <span class=\\\"nx\\\">deleteTrigger</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">setTriggerHoursLast</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"nx\\\">ScriptApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">newTrigger</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">sendSlack</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">)</span>\\n    <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">timeBased</span><span class=\\\"p\\\">()</span>\\n    <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">after</span><span class=\\\"p\\\">(</span> <span class=\\\"mi\\\">18</span> <span class=\\\"o\\\">*</span> <span class=\\\"mi\\\">60</span> <span class=\\\"o\\\">*</span> <span class=\\\"mi\\\">60</span> <span class=\\\"o\\\">*</span> <span class=\\\"mi\\\">1000</span> <span class=\\\"p\\\">)</span>\\n    <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">create</span><span class=\\\"p\\\">();</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">sendSlack</span><span class=\\\"p\\\">()</span> \\n<span class=\\\"p\\\">{</span>\\n  <span class=\\\"nx\\\">deleteTrigger</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">sendSlack</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">options</span> <span class=\\\"o\\\">=</span> \\n  <span class=\\\"p\\\">{</span>\\n    <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">method</span><span class=\\\"dl\\\">\\\"</span> <span class=\\\"p\\\">:</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">POST</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">,</span>\\n    <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">payload</span><span class=\\\"dl\\\">\\\"</span> <span class=\\\"p\\\">:</span> \\n    <span class=\\\"p\\\">{</span>\\n      <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">token</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">:</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">********************</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">,</span>\\n      <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">channel</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">:</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">bot-test</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">,</span>\\n      <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">text</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">:</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">\u9818\u53CE\u66F8\u51FA\u3057\u307E\u3057\u305F\u304B\uFF1F\u5FD8\u308C\u3066\u306A\u3044\u3088\u306D\u3002</span><span class=\\\"se\\\">\\\\</span><span class=\\\"s2\\\">\uFF4Ehttp://.../</span><span class=\\\"dl\\\">\\\"</span>\\n    <span class=\\\"p\\\">}</span>\\n  <span class=\\\"p\\\">}</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">url</span> <span class=\\\"o\\\">=</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">https://slack.com/api/chat.postMessage</span><span class=\\\"dl\\\">\\\"</span>\\n  <span class=\\\"nx\\\">UrlFetchApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">fetch</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">url</span><span class=\\\"p\\\">,</span> <span class=\\\"nx\\\">options</span><span class=\\\"p\\\">);</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">lastBusinessDay</span><span class=\\\"p\\\">()</span> \\n<span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">today</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">();</span>\\n\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">lastDayOfThisMonth</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">today</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getFullYear</span><span class=\\\"p\\\">(),</span> <span class=\\\"nx\\\">today</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getMonth</span><span class=\\\"p\\\">()</span><span class=\\\"o\\\">+</span><span class=\\\"mi\\\">1</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">day</span><span class=\\\"p\\\">;</span> <span class=\\\"c1\\\">// 0-&gt;\u65E5\u66DC\u65E5</span>\\n\\n  <span class=\\\"k\\\">for</span> <span class=\\\"p\\\">(</span><span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">i</span> <span class=\\\"o\\\">=</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">;</span> <span class=\\\"nx\\\">i</span> <span class=\\\"o\\\">&lt;</span> <span class=\\\"mi\\\">30</span><span class=\\\"p\\\">;</span> <span class=\\\"nx\\\">i</span><span class=\\\"o\\\">++</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n    <span class=\\\"nx\\\">day</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">lastDayOfThisMonth</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getDay</span><span class=\\\"p\\\">();</span>\\n    <span class=\\\"k\\\">if</span> <span class=\\\"p\\\">(</span><span class=\\\"nx\\\">day</span> <span class=\\\"o\\\">==</span> <span class=\\\"mi\\\">0</span> <span class=\\\"o\\\">||</span> <span class=\\\"nx\\\">day</span> <span class=\\\"o\\\">==</span> <span class=\\\"mi\\\">6</span> <span class=\\\"o\\\">||</span> <span class=\\\"nx\\\">isHoliday</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">lastDayOfThisMonth</span><span class=\\\"p\\\">))</span> <span class=\\\"p\\\">{</span>\\n      <span class=\\\"nx\\\">lastDayOfThisMonth</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">today</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getFullYear</span><span class=\\\"p\\\">(),</span> <span class=\\\"nx\\\">today</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getMonth</span><span class=\\\"p\\\">()</span><span class=\\\"o\\\">+</span><span class=\\\"mi\\\">1</span><span class=\\\"p\\\">,</span> <span class=\\\"o\\\">-</span><span class=\\\"mi\\\">1</span> <span class=\\\"o\\\">*</span> <span class=\\\"nx\\\">i</span><span class=\\\"p\\\">);</span>\\n      <span class=\\\"k\\\">continue</span><span class=\\\"p\\\">;</span>\\n    <span class=\\\"p\\\">}</span>\\n  <span class=\\\"p\\\">}</span>\\n  <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">lastDayOfThisMonth</span><span class=\\\"p\\\">;</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">deleteTrigger</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">name</span><span class=\\\"p\\\">)</span> \\n<span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">triggers</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">ScriptApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getProjectTriggers</span><span class=\\\"p\\\">();</span>\\n  <span class=\\\"k\\\">for</span><span class=\\\"p\\\">(</span><span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">i</span><span class=\\\"o\\\">=</span><span class=\\\"mi\\\">0</span><span class=\\\"p\\\">;</span> <span class=\\\"nx\\\">i</span> <span class=\\\"o\\\">&lt;</span> <span class=\\\"nx\\\">triggers</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">length</span><span class=\\\"p\\\">;</span> <span class=\\\"nx\\\">i</span><span class=\\\"o\\\">++</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n    <span class=\\\"k\\\">if</span> <span class=\\\"p\\\">(</span><span class=\\\"nx\\\">triggers</span><span class=\\\"p\\\">[</span><span class=\\\"nx\\\">i</span><span class=\\\"p\\\">].</span><span class=\\\"nx\\\">getHandlerFunction</span><span class=\\\"p\\\">()</span> <span class=\\\"o\\\">==</span> <span class=\\\"nx\\\">name</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n      <span class=\\\"nx\\\">ScriptApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">deleteTrigger</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">triggers</span><span class=\\\"p\\\">[</span><span class=\\\"nx\\\">i</span><span class=\\\"p\\\">]);</span>\\n    <span class=\\\"p\\\">}</span>\\n  <span class=\\\"p\\\">}</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">isHoliday</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">day</span><span class=\\\"p\\\">)</span> \\n<span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">startDate</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">day</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">setHours</span><span class=\\\"p\\\">(</span><span class=\\\"mi\\\">0</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">));</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">endDate</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">day</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">setHours</span><span class=\\\"p\\\">(</span><span class=\\\"mi\\\">23</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">59</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">59</span><span class=\\\"p\\\">));</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">cal</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">CalendarApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getCalendarById</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">ja.japanese#holiday@group.v.calendar.google.com</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">holidays</span> <span class=\\\"o\\\">=</span>  <span class=\\\"nx\\\">cal</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getEvents</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">startDate</span><span class=\\\"p\\\">,</span> <span class=\\\"nx\\\">endDate</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">holidays</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">length</span> <span class=\\\"o\\\">!=</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">;</span> <span class=\\\"c1\\\">// \u795D\u65E5\u306A\u3089true</span>\\n<span class=\\\"p\\\">}</span>\\n\\n</code></pre></div></div>\\n\\n<p>sendSlack\u306E\u3053\u3053\u306F\u500B\u4EBA\u8A2D\u5B9A\u306B\u5909\u3048\u3066\u304F\u3060\u3055\u3044\uFF01</p>\\n\\n<ul>\\n<li>\\\"token\\\": \\\"********************\\\",</li>\\n<li>\\\"channel\\\": \\\"bot-test\\\",</li>\\n<li>\\\"text\\\": \\\"\u9818\u53CE\u66F8\u51FA\u3057\u307E\u3057\u305F\u304B\uFF1F\u5FD8\u308C\u3066\u306A\u3044\u3088\u306D\u3002\\\\\uFF4Ehttp://.../\\\"</li>\\n</ul>\\n\\n<h2>\\n<span id=\\\"settriggerday\u306E\u5B9F\u884C\u3068\u53D6\u308A\u6D88\u3057\u3068\u6BCE\u6708\u5B9F\u884C\\\" class=\\\"fragment\\\"></span><a href=\\\"#settriggerday%E3%81%AE%E5%AE%9F%E8%A1%8C%E3%81%A8%E5%8F%96%E3%82%8A%E6%B6%88%E3%81%97%E3%81%A8%E6%AF%8E%E6%9C%88%E5%AE%9F%E8%A1%8C\\\"><i class=\\\"fa fa-link\\\"></i></a>setTriggerDay()\u306E\u5B9F\u884C\u3068\u53D6\u308A\u6D88\u3057\u3068\u6BCE\u6708\u5B9F\u884C</h2>\\n\\n<p>\u5B9F\u884C &gt;&gt; setTriggerDay<br>\\n\u3092\u304A\u3057\u3066\u307F\u3088\u3046\u3002</p>\\n\\n<p><a href=\\\"https://camo.qiitausercontent.com/2943d9ffc3472a260a7b8b49cf1dd129d6215eaa/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f36656238366532392d613466392d346664302d653632642d3736613861663233336137322e6a706567\\\" target=\\\"_blank\\\" rel=\\\"nofollow noopener\\\"><img width=\\\"527\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 22.26.52.jpg\\\" src=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F6eb86e29-a4f9-4fd0-e62d-76a8af233a72.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=41f721b304f5cec115d59b983c938b0b\\\" data-canonical-src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/6eb86e29-a4f9-4fd0-e62d-76a8af233a72.jpeg\\\" srcset=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F6eb86e29-a4f9-4fd0-e62d-76a8af233a72.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=e1491c09dfdf657c2ef3aff033538ed5 1x\\\" loading=\\\"lazy\\\"></a></p>\\n\\n<p>\u30EA\u30BD\u30FC\u30B9 &gt;&gt; \u73FE\u5728\u306E\u30D7\u30ED\u30B8\u30A7\u30AF\u30C8\u306E\u30C8\u30EA\u30AC\u30FC<br>\\n\u3053\u3053\u304B\u3089\u30C8\u30EA\u30AC\u30FC\uFF08\u4F55\u6642\u306B\u3042\u308C\u3092\u5B9F\u884C\u3057\u306A\u3055\u3044\uFF09\u3092\u78BA\u8A8D\u3067\u304D\u307E\u3059\u3002</p>\\n\\n<p><a href=\\\"https://camo.qiitausercontent.com/3b08a873f77b7d6e66e6950e4b4d91c82fd6c443/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f64616566616139312d353166632d306662662d343035372d6233313663386265343562312e6a706567\\\" target=\\\"_blank\\\" rel=\\\"nofollow noopener\\\"><img width=\\\"648\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 22.27.40.jpg\\\" src=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fdaefaa91-51fc-0fbf-4057-b316c8be45b1.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=962a2c45562cefc53b007fdfc8ff1fc8\\\" data-canonical-src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/daefaa91-51fc-0fbf-4057-b316c8be45b1.jpeg\\\" srcset=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fdaefaa91-51fc-0fbf-4057-b316c8be45b1.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=2b7a193799802c5662a3b3b0c37d5e9e 1x\\\" loading=\\\"lazy\\\"></a></p>\\n\\n<p>\u3053\u3053\u3067 2017/03/21 \u591C\u4E2D\u4E01\u5EA6\u306B setTriggerHoursLast \u304C\u5B9F\u884C\u3055\u308C\u308B\u3088\u3046\u306B\u306A\u3063\u3066\u3044\u305F\u3089\u5927\u4E08\u592B\u3002setTriggerHoursLast\u306F18\u6642\u9593\u5F8C\u306BSlack\u9001\u308A\u306A\u3055\u3044\u3068\u3044\u3046\u547D\u4EE4\u3067\u3059\u3002</p>\\n\\n<p><a href=\\\"https://camo.qiitausercontent.com/7e6b6f79bffa7dac4f99d0ed7c62440e61ac39e6/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f62623663663961322d616566372d373639632d633639622d6261346561613962336539382e6a706567\\\" target=\\\"_blank\\\" rel=\\\"nofollow noopener\\\"><img width=\\\"838\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 22.27.47.jpg\\\" src=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fbb6cf9a2-aef7-769c-c69b-ba4eaa9b3e98.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=19baf0caf865485764a2109df380591b\\\" data-canonical-src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/bb6cf9a2-aef7-769c-c69b-ba4eaa9b3e98.jpeg\\\" srcset=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fbb6cf9a2-aef7-769c-c69b-ba4eaa9b3e98.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=230c496677d16423f56ac98744f89e3d 1x\\\" loading=\\\"lazy\\\"></a></p>\\n\\n<p>\u307E\u305F\u3064\u3044\u3067\u306B\u3053\u306E\u753B\u9762\u3067setTriggerDay\u3092\u6BCE\u67081\u65E56\u6642\u304F\u3089\u3044\u306B\u30BB\u30C3\u30C8\u3057\u307E\u3059\u3002</p>\\n\\n<p><a href=\\\"https://camo.qiitausercontent.com/03a0f1662ae9b4984279eca9bed6bfc52894518b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f33323838633963382d646561372d356264642d656566612d3433666337373335666366622e6a706567\\\" target=\\\"_blank\\\" rel=\\\"nofollow noopener\\\"><img width=\\\"836\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 22.37.18.jpg\\\" src=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F3288c9c8-dea7-5bdd-eefa-43fc7735fcfb.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=617a1a8877077bb4ae243b8b31e33d37\\\" data-canonical-src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/3288c9c8-dea7-5bdd-eefa-43fc7735fcfb.jpeg\\\" srcset=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2F3288c9c8-dea7-5bdd-eefa-43fc7735fcfb.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=f2dd1d807c95f0919a362633f312b55c 1x\\\" loading=\\\"lazy\\\"></a></p>\\n\\n<p>\u305D\u3046\u3059\u308B\u3068\u6BCE\u67081\u65E5\u306BsetTriggerDay\u304C\u5B9F\u884C\u3055\u308C\u3066<br>\\n-&gt; setTriggerDay :\u6700\u7D42\u65E5\u306B\u6B21\u3092\u5B9F\u884C<br>\\n-&gt; setTriggerHoursLast :18\u6642\u306B\u6B21\u3092\u5B9F\u884C<br>\\n-&gt; sendSlack :Slack\u3092\u5B9F\u884C</p>\\n\\n<p>\u3063\u3066\u611F\u3058\u3067\u6BCE\u6708\u3001\u6700\u7D42\u65E5\u30C8\u30EA\u30AC\u30FC\u3092\u4F5C\u6210\u3057\u3066\u304F\u308C\u307E\u3059\u3002</p>\\n\\n<h2>\\n<span id=\\\"function\u3054\u3068\u306B\u898B\u3066\u3044\u304F\\\" class=\\\"fragment\\\"></span><a href=\\\"#function%E3%81%94%E3%81%A8%E3%81%AB%E8%A6%8B%E3%81%A6%E3%81%84%E3%81%8F\\\"><i class=\\\"fa fa-link\\\"></i></a>function\u3054\u3068\u306B\u898B\u3066\u3044\u304F</h2>\\n\\n<p>\u7C21\u5358\u306B\u307F\u3066\u3044\u304D\u307E\u3059\u3002</p>\\n\\n<h3>\\n<span id=\\\"settriggerday\\\" class=\\\"fragment\\\"></span><a href=\\\"#settriggerday\\\"><i class=\\\"fa fa-link\\\"></i></a>setTriggerDay</h3>\\n\\n<div class=\\\"code-frame\\\" data-lang=\\\"js\\\"><div class=\\\"highlight\\\"><pre><code><span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">setTriggerDay</span><span class=\\\"p\\\">()</span>\\n<span class=\\\"p\\\">{</span>  \\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">last</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">lastBusinessDay</span><span class=\\\"p\\\">();</span>\\n  <span class=\\\"nx\\\">ScriptApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">newTrigger</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">setTriggerHoursLast</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">)</span>\\n    <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">timeBased</span><span class=\\\"p\\\">()</span>\\n    <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">atDate</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">last</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getFullYear</span><span class=\\\"p\\\">(),</span> <span class=\\\"nx\\\">last</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getMonth</span><span class=\\\"p\\\">()</span><span class=\\\"o\\\">+</span><span class=\\\"mi\\\">1</span><span class=\\\"p\\\">,</span> <span class=\\\"nx\\\">last</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getDate</span><span class=\\\"p\\\">())</span>\\n    <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">create</span><span class=\\\"p\\\">();</span>\\n<span class=\\\"p\\\">}</span>\\n</code></pre></div></div>\\n\\n<p>lastBusinessDay()\u3067\u55B6\u696D\u65E5\u6700\u7D42\u65E5\u306EDate\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u3092\u53D6\u3063\u3066\u304D\u3066<br>\\n.atDate(last.getMonth()+1)\u3068\u3057\u3066\u3044\u308B\u3068\u3053\u308D\u306F\u3001\u6708\u306F0\u6708\u59CB\u307E\u308A\u3068\u306A\u3063\u3066\u3044\u308B\u304B\u3089\u3067\u3059\u3002</p>\\n\\n<h3>\\n<span id=\\\"settriggerhourslast\\\" class=\\\"fragment\\\"></span><a href=\\\"#settriggerhourslast\\\"><i class=\\\"fa fa-link\\\"></i></a>setTriggerHoursLast</h3>\\n\\n<div class=\\\"code-frame\\\" data-lang=\\\"js\\\"><div class=\\\"highlight\\\"><pre><code><span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">setTriggerHoursLast</span><span class=\\\"p\\\">()</span>\\n<span class=\\\"p\\\">{</span>\\n  <span class=\\\"nx\\\">deleteTrigger</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">setTriggerHoursLast</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"nx\\\">ScriptApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">newTrigger</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">sendSlack</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">)</span>\\n    <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">timeBased</span><span class=\\\"p\\\">()</span>\\n    <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">after</span><span class=\\\"p\\\">(</span> <span class=\\\"mi\\\">18</span> <span class=\\\"o\\\">*</span> <span class=\\\"mi\\\">60</span> <span class=\\\"o\\\">*</span> <span class=\\\"mi\\\">60</span> <span class=\\\"o\\\">*</span> <span class=\\\"mi\\\">1000</span> <span class=\\\"p\\\">)</span>\\n    <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">create</span><span class=\\\"p\\\">();</span>\\n<span class=\\\"p\\\">}</span>\\n</code></pre></div></div>\\n\\n<p>.after( 18 * 60 * 60 * 1000 )\u3067\u30DF\u30EA\u79D2\u5F8C\u306B\u30C8\u30EA\u30AC\u30FC\u3092\u30BB\u30C3\u30C8\u3057\u3066\u307E\u3059\u3002</p>\\n\\n<h3>\\n<span id=\\\"sendslack\\\" class=\\\"fragment\\\"></span><a href=\\\"#sendslack\\\"><i class=\\\"fa fa-link\\\"></i></a>sendSlack</h3>\\n\\n<div class=\\\"code-frame\\\" data-lang=\\\"js\\\"><div class=\\\"highlight\\\"><pre><code><span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">sendSlack</span><span class=\\\"p\\\">()</span> \\n<span class=\\\"p\\\">{</span>\\n  <span class=\\\"nx\\\">deleteTrigger</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">sendSlack</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">options</span> <span class=\\\"o\\\">=</span> \\n  <span class=\\\"p\\\">{</span>\\n    <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">method</span><span class=\\\"dl\\\">\\\"</span> <span class=\\\"p\\\">:</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">POST</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">,</span>\\n    <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">payload</span><span class=\\\"dl\\\">\\\"</span> <span class=\\\"p\\\">:</span> \\n    <span class=\\\"p\\\">{</span>\\n      <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">token</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">:</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">********************</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">,</span>\\n      <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">channel</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">:</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">bot-test</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">,</span>\\n      <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">text</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">:</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">\u9818\u53CE\u66F8\u51FA\u3057\u307E\u3057\u305F\u304B\uFF1F\u5FD8\u308C\u3066\u306A\u3044\u3088\u306D\u3002</span><span class=\\\"se\\\">\\\\</span><span class=\\\"s2\\\">\uFF4Ehttp://.../</span><span class=\\\"dl\\\">\\\"</span>\\n    <span class=\\\"p\\\">}</span>\\n  <span class=\\\"p\\\">}</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">url</span> <span class=\\\"o\\\">=</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">https://slack.com/api/chat.postMessage</span><span class=\\\"dl\\\">\\\"</span>\\n  <span class=\\\"nx\\\">UrlFetchApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">fetch</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">url</span><span class=\\\"p\\\">,</span> <span class=\\\"nx\\\">options</span><span class=\\\"p\\\">);</span>\\n<span class=\\\"p\\\">}</span>\\n</code></pre></div></div>\\n\\n<p>\u3053\u3046\u3044\u3046\u66F8\u304D\u65B9\u3060\u3068\u601D\u3063\u3066\u3044\u305F\u3060\u3051\u308C\u3070\u2026<br>\\n\u8A73\u3057\u304F\u306F\u516C\u5F0F\u30C9\u30AD\u30E5\u30E1\u30F3\u30C8\u3067\u3000<a href=\\\"https://api.slack.com/methods/chat.postMessage\\\" class=\\\"autolink\\\" rel=\\\"nofollow noopener\\\" target=\\\"_blank\\\">https://api.slack.com/methods/chat.postMessage</a></p>\\n\\n<h3>\\n<span id=\\\"lastbusinessday\\\" class=\\\"fragment\\\"></span><a href=\\\"#lastbusinessday\\\"><i class=\\\"fa fa-link\\\"></i></a>lastBusinessDay</h3>\\n\\n<div class=\\\"code-frame\\\" data-lang=\\\"js\\\"><div class=\\\"highlight\\\"><pre><code><span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">lastBusinessDay</span><span class=\\\"p\\\">()</span> \\n<span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">today</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">();</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">lastDayOfThisMonth</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">today</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getFullYear</span><span class=\\\"p\\\">(),</span> <span class=\\\"nx\\\">today</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getMonth</span><span class=\\\"p\\\">()</span><span class=\\\"o\\\">+</span><span class=\\\"mi\\\">1</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">day</span><span class=\\\"p\\\">;</span> <span class=\\\"c1\\\">// 0-&gt;\u65E5\u66DC\u65E5</span>\\n\\n  <span class=\\\"k\\\">for</span> <span class=\\\"p\\\">(</span><span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">i</span> <span class=\\\"o\\\">=</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">;</span> <span class=\\\"nx\\\">i</span> <span class=\\\"o\\\">&lt;</span> <span class=\\\"mi\\\">30</span><span class=\\\"p\\\">;</span> <span class=\\\"nx\\\">i</span><span class=\\\"o\\\">++</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n    <span class=\\\"nx\\\">day</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">lastDayOfThisMonth</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getDay</span><span class=\\\"p\\\">();</span>\\n    <span class=\\\"k\\\">if</span> <span class=\\\"p\\\">(</span><span class=\\\"nx\\\">day</span> <span class=\\\"o\\\">==</span> <span class=\\\"mi\\\">0</span> <span class=\\\"o\\\">||</span> <span class=\\\"nx\\\">day</span> <span class=\\\"o\\\">==</span> <span class=\\\"mi\\\">6</span> <span class=\\\"o\\\">||</span> <span class=\\\"nx\\\">isHoliday</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">lastDayOfThisMonth</span><span class=\\\"p\\\">))</span> <span class=\\\"p\\\">{</span>\\n      <span class=\\\"nx\\\">lastDayOfThisMonth</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">today</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getFullYear</span><span class=\\\"p\\\">(),</span> <span class=\\\"nx\\\">today</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getMonth</span><span class=\\\"p\\\">()</span><span class=\\\"o\\\">+</span><span class=\\\"mi\\\">1</span><span class=\\\"p\\\">,</span> <span class=\\\"o\\\">-</span><span class=\\\"mi\\\">1</span> <span class=\\\"o\\\">*</span> <span class=\\\"nx\\\">i</span><span class=\\\"p\\\">);</span>\\n      <span class=\\\"k\\\">continue</span><span class=\\\"p\\\">;</span>\\n    <span class=\\\"p\\\">}</span>\\n    <span class=\\\"k\\\">break</span><span class=\\\"p\\\">;</span>\\n  <span class=\\\"p\\\">}</span>\\n  <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">lastDayOfThisMonth</span><span class=\\\"p\\\">;</span>\\n<span class=\\\"p\\\">}</span>\\n</code></pre></div></div>\\n\\n<p>day == 0 || day == 6 || isHoliday(lastDayOfThisMonth)<br>\\n\u3053\u3053\u3067\u571F\u65E5\u3082\u3057\u304F\u306F\u795D\u65E5\u5224\u5B9A\u3092\u3057\u3066\u3044\u307E\u3059\u3002</p>\\n\\n<h3>\\n<span id=\\\"deletetrigger\\\" class=\\\"fragment\\\"></span><a href=\\\"#deletetrigger\\\"><i class=\\\"fa fa-link\\\"></i></a>deleteTrigger</h3>\\n\\n<div class=\\\"code-frame\\\" data-lang=\\\"js\\\"><div class=\\\"highlight\\\"><pre><code>\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">deleteTrigger</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">name</span><span class=\\\"p\\\">)</span> \\n<span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">triggers</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">ScriptApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getProjectTriggers</span><span class=\\\"p\\\">();</span>\\n  <span class=\\\"k\\\">for</span><span class=\\\"p\\\">(</span><span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">i</span><span class=\\\"o\\\">=</span><span class=\\\"mi\\\">0</span><span class=\\\"p\\\">;</span> <span class=\\\"nx\\\">i</span> <span class=\\\"o\\\">&lt;</span> <span class=\\\"nx\\\">triggers</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">length</span><span class=\\\"p\\\">;</span> <span class=\\\"nx\\\">i</span><span class=\\\"o\\\">++</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n    <span class=\\\"k\\\">if</span> <span class=\\\"p\\\">(</span><span class=\\\"nx\\\">triggers</span><span class=\\\"p\\\">[</span><span class=\\\"nx\\\">i</span><span class=\\\"p\\\">].</span><span class=\\\"nx\\\">getHandlerFunction</span><span class=\\\"p\\\">()</span> <span class=\\\"o\\\">==</span> <span class=\\\"nx\\\">name</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n      <span class=\\\"nx\\\">ScriptApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">deleteTrigger</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">triggers</span><span class=\\\"p\\\">[</span><span class=\\\"nx\\\">i</span><span class=\\\"p\\\">]);</span>\\n    <span class=\\\"p\\\">}</span>\\n  <span class=\\\"p\\\">}</span>\\n<span class=\\\"p\\\">}</span>\\n\\n</code></pre></div></div>\\n\\n<p>\u5B9F\u306F\u81EA\u5206\u3067\u30BB\u30C3\u30C8\u3057\u305Ftrigger\u3063\u3066\u3053\u3093\u306A\u611F\u3058\u30671\u5206\u3054\u3068\u306B\u305F\u307E\u3063\u3066\u3044\u304D\u307E\u3059\u3002<br>\\n\u4ECA\u56DE\u3060\u3068\\\"MAIAMAIN\\\"\u3063\u3066\u540D\u524D\u306E\u30C8\u30EA\u30AC\u30FC\u3092\u5168\u524A\u9664\u3059\u308B\u6A5F\u80FD\u306B\u306A\u3063\u3066\u307E\u3059\u3002<br>\\n<a href=\\\"https://camo.qiitausercontent.com/18f33b9bf701e7e2189b93dcbdab932fc9b61457/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f3131323932392f61633666346337632d663134322d663463612d663764632d6639353038386263373131382e6a706567\\\" target=\\\"_blank\\\" rel=\\\"nofollow noopener\\\"><img width=\\\"735\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 23.14.29.jpg\\\" src=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fac6f4c7c-f142-f4ca-f7dc-f95088bc7118.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=36fd1a6a74b29b8998d068ac6e5dbb5d\\\" data-canonical-src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/ac6f4c7c-f142-f4ca-f7dc-f95088bc7118.jpeg\\\" srcset=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F112929%2Fac6f4c7c-f142-f4ca-f7dc-f95088bc7118.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=bcde38fa01a6d1b60bb0a3bef5ea1a2a 1x\\\" loading=\\\"lazy\\\"></a></p>\\n\\n<p>\u53C2\u8003\uFF1A\u3000<a href=\\\"http://qiita.com/sumi-engraphia/items/465dd027e17f44da4d6a\\\" class=\\\"autolink\\\" id=\\\"reference-6cdb302138342d02b062\\\">http://qiita.com/sumi-engraphia/items/465dd027e17f44da4d6a</a></p>\\n\\n<h3>\\n<span id=\\\"isholiday\\\" class=\\\"fragment\\\"></span><a href=\\\"#isholiday\\\"><i class=\\\"fa fa-link\\\"></i></a>isHoliday</h3>\\n\\n<div class=\\\"code-frame\\\" data-lang=\\\"js\\\"><div class=\\\"highlight\\\"><pre><code>\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">isHoliday</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">day</span><span class=\\\"p\\\">)</span> \\n<span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">startDate</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">day</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">setHours</span><span class=\\\"p\\\">(</span><span class=\\\"mi\\\">0</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">));</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">endDate</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">day</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">setHours</span><span class=\\\"p\\\">(</span><span class=\\\"mi\\\">23</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">59</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">59</span><span class=\\\"p\\\">));</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">cal</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">CalendarApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getCalendarById</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">ja.japanese#holiday@group.v.calendar.google.com</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">holidays</span> <span class=\\\"o\\\">=</span>  <span class=\\\"nx\\\">cal</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getEvents</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">startDate</span><span class=\\\"p\\\">,</span> <span class=\\\"nx\\\">endDate</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">holidays</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">length</span> <span class=\\\"o\\\">!=</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">;</span> <span class=\\\"c1\\\">// \u795D\u65E5\u306A\u3089true</span>\\n<span class=\\\"p\\\">}</span>\\n\\n</code></pre></div></div>\\n\\n<p>getCalendarById\u3067Google\u306E[\u65E5\u672C\u306E\u795D\u65E5]\u3092\u53D6\u5F97\u3057\u3066\u304D\u3066\u307E\u3059\u3002</p>\\n\\n<p>\u53C2\u8003\uFF1A\u3000<a href=\\\"http://qiita.com/kamatama_41/items/be40e05524530920a9d9\\\" class=\\\"autolink\\\" id=\\\"reference-5a809bb3572c78f54395\\\">http://qiita.com/kamatama_41/items/be40e05524530920a9d9</a></p>\\n\\n<p>\u7D42\u308F\u308A\u307E\u3057\u305F\u301C\u301C<br>\\n\u6B21\u306F\u6708\u521D\u3081\u306E\u55B6\u696D\u65E5\u3092\u53D6\u3063\u3066\u3044\u304D\u307E\u3059\u301C\u301C</p>\\n\\n<h1>\\n<span id=\\\"\u6708\u521D\u3081\u306E\u55B6\u696D\u65E5\\\" class=\\\"fragment\\\"></span><a href=\\\"#%E6%9C%88%E5%88%9D%E3%82%81%E3%81%AE%E5%96%B6%E6%A5%AD%E6%97%A5\\\"><i class=\\\"fa fa-link\\\"></i></a>\u6708\u521D\u3081\u306E\u55B6\u696D\u65E5</h1>\\n\\n<div class=\\\"code-frame\\\" data-lang=\\\"js\\\"><div class=\\\"highlight\\\"><pre><code>\\n<span class=\\\"cm\\\">/*\\n  \u30E1\u30A4\u30F3\u306E\u51E6\u7406\\n  setTriggerDay() : \u306F\u3058\u3081\u306E\u55B6\u696D\u65E5(0\u6642)\u306B\u6B21\u306E\u51E6\u7406\u3092\u3059\u308B\u547D\u4EE4\u3092\u51FA\u3059\u3002\\n  setTriggerHoursFirst() : \u306F\u3058\u3081\u306E\u55B6\u696D\u65E5\u306E11\u6642\u306B\u6B21\u306E\u547D\u4EE4\u3092\u51FA\u3059\u3002\\n  sendSlack() : slack\u306B\u30C7\u30FC\u30BF\u3092\u6295\u3052\u308B\u3002\\n\\n  \u30B5\u30D6\u7684\u306A\u51E6\u7406\\n  deleteTrigger() : \u84C4\u7A4D\u3055\u308C\u3066\u3044\u308B\u547D\u4EE4\u3092\u524A\u9664\u3059\u308B\\n  firstNextBusinessDay() : \u6765\u6708\u306E\u306F\u3058\u3081\u306E\u55B6\u696D\u65E5\u3092\u6C42\u3081\u308B\\n  isHoliday() : \u672C\u65E5\u304C[\u65E5\u672C\u306E\u795D\u65E5]\u304B\u3069\u3046\u304B\u30C1\u30A7\u30C3\u30AF\u3002\u571F\u65E5\u306F\u66DC\u65E5\u3067\u5224\u5B9A\u3057\u3066\u308B\u30C1\u30A7\u30C3\u30AF\\n  .getDay()\u3000: Date\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u304B\u3089\u66DC\u65E5\u3092\u6C42\u3081\u308B\u30E1\u30BD\u30C3\u30C9(0:\u65E5, 6:\u571F\u66DC\u65E5)\\n*/</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">setTriggerDay2</span><span class=\\\"p\\\">()</span>\\n<span class=\\\"p\\\">{</span>  \\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">first</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">firstNextBusinessDay</span><span class=\\\"p\\\">();</span>\\n  <span class=\\\"nx\\\">ScriptApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">newTrigger</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">setTriggerHoursFirst</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">)</span>\\n    <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">timeBased</span><span class=\\\"p\\\">()</span>\\n    <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">atDate</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">first</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getFullYear</span><span class=\\\"p\\\">(),</span> <span class=\\\"nx\\\">first</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getMonth</span><span class=\\\"p\\\">()</span><span class=\\\"o\\\">+</span><span class=\\\"mi\\\">1</span><span class=\\\"p\\\">,</span> <span class=\\\"nx\\\">first</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getDate</span><span class=\\\"p\\\">())</span>\\n    <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">create</span><span class=\\\"p\\\">();</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">setTriggerHoursFirst</span><span class=\\\"p\\\">()</span>\\n<span class=\\\"p\\\">{</span>\\n <span class=\\\"nx\\\">ScriptApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">newTrigger</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">sendSlack</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">)</span>\\n   <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">timeBased</span><span class=\\\"p\\\">()</span>\\n   <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">after</span><span class=\\\"p\\\">(</span><span class=\\\"mi\\\">11</span> <span class=\\\"o\\\">*</span> <span class=\\\"mi\\\">60</span> <span class=\\\"o\\\">*</span> <span class=\\\"mi\\\">60</span> <span class=\\\"o\\\">*</span> <span class=\\\"mi\\\">1000</span><span class=\\\"p\\\">)</span>\\n   <span class=\\\"p\\\">.</span><span class=\\\"nx\\\">create</span><span class=\\\"p\\\">();</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">sendSlack</span><span class=\\\"p\\\">()</span> \\n<span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">options</span> <span class=\\\"o\\\">=</span> \\n  <span class=\\\"p\\\">{</span>\\n    <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">method</span><span class=\\\"dl\\\">\\\"</span> <span class=\\\"p\\\">:</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">POST</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">,</span>\\n    <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">payload</span><span class=\\\"dl\\\">\\\"</span> <span class=\\\"p\\\">:</span> \\n    <span class=\\\"p\\\">{</span>\\n      <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">token</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">:</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">********************</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">,</span>\\n      <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">channel</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">:</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">bot-test</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">,</span>\\n      <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">text</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">:</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">\u6708\u304C\u59CB\u307E\u308A\u307E\u3057\u305F\u3002</span><span class=\\\"dl\\\">\\\"</span>\\n    <span class=\\\"p\\\">}</span>\\n  <span class=\\\"p\\\">}</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">url</span> <span class=\\\"o\\\">=</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">https://slack.com/api/chat.postMessage</span><span class=\\\"dl\\\">\\\"</span>\\n  <span class=\\\"nx\\\">UrlFetchApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">fetch</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">url</span><span class=\\\"p\\\">,</span> <span class=\\\"nx\\\">options</span><span class=\\\"p\\\">);</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">firstNextBusinessDay</span><span class=\\\"p\\\">()</span> \\n<span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">today</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">();</span>  \\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">firstDayOfNextMonth</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">today</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getFullYear</span><span class=\\\"p\\\">(),</span> <span class=\\\"nx\\\">today</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getMonth</span><span class=\\\"p\\\">()</span><span class=\\\"o\\\">+</span><span class=\\\"mi\\\">1</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">1</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">day</span><span class=\\\"p\\\">;</span> <span class=\\\"c1\\\">// 0-&gt;\u65E5\u66DC\u65E5</span>\\n\\n  <span class=\\\"k\\\">for</span> <span class=\\\"p\\\">(</span><span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">i</span> <span class=\\\"o\\\">=</span> <span class=\\\"mi\\\">2</span><span class=\\\"p\\\">;</span> <span class=\\\"nx\\\">i</span> <span class=\\\"o\\\">&lt;</span> <span class=\\\"mi\\\">32</span><span class=\\\"p\\\">;</span> <span class=\\\"nx\\\">i</span><span class=\\\"o\\\">++</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n    <span class=\\\"nx\\\">day</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">firstDayOfNextMonth</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getDay</span><span class=\\\"p\\\">();</span>\\n    <span class=\\\"k\\\">if</span> <span class=\\\"p\\\">(</span><span class=\\\"nx\\\">day</span> <span class=\\\"o\\\">==</span> <span class=\\\"mi\\\">0</span> <span class=\\\"o\\\">||</span> <span class=\\\"nx\\\">day</span> <span class=\\\"o\\\">==</span> <span class=\\\"mi\\\">6</span> <span class=\\\"o\\\">||</span> <span class=\\\"nx\\\">isHoliday</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">firstDayOfNextMonth</span><span class=\\\"p\\\">))</span> <span class=\\\"p\\\">{</span>\\n      <span class=\\\"nx\\\">firstDayOfThisMonth</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">today</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getFullYear</span><span class=\\\"p\\\">(),</span> <span class=\\\"nx\\\">today</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getMonth</span><span class=\\\"p\\\">(),</span> <span class=\\\"nx\\\">i</span><span class=\\\"p\\\">);</span>\\n      <span class=\\\"k\\\">continue</span><span class=\\\"p\\\">;</span>\\n    <span class=\\\"p\\\">}</span>\\n  <span class=\\\"p\\\">}</span>\\n  <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">firstDayOfNextMonth</span><span class=\\\"p\\\">;</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">deleteTrigger</span><span class=\\\"p\\\">()</span> \\n<span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">triggers</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">ScriptApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getProjectTriggers</span><span class=\\\"p\\\">();</span>\\n  <span class=\\\"k\\\">for</span><span class=\\\"p\\\">(</span><span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">i</span><span class=\\\"o\\\">=</span><span class=\\\"mi\\\">0</span><span class=\\\"p\\\">;</span> <span class=\\\"nx\\\">i</span> <span class=\\\"o\\\">&lt;</span> <span class=\\\"nx\\\">triggers</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">length</span><span class=\\\"p\\\">;</span> <span class=\\\"nx\\\">i</span><span class=\\\"o\\\">++</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n    <span class=\\\"k\\\">if</span> <span class=\\\"p\\\">(</span><span class=\\\"nx\\\">triggers</span><span class=\\\"p\\\">[</span><span class=\\\"nx\\\">i</span><span class=\\\"p\\\">].</span><span class=\\\"nx\\\">getHandlerFunction</span><span class=\\\"p\\\">()</span> <span class=\\\"o\\\">==</span> <span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">main</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n      <span class=\\\"nx\\\">ScriptApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">deleteTrigger</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">triggers</span><span class=\\\"p\\\">[</span><span class=\\\"nx\\\">i</span><span class=\\\"p\\\">]);</span>\\n    <span class=\\\"p\\\">}</span>\\n  <span class=\\\"p\\\">}</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">isHoliday</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">day</span><span class=\\\"p\\\">)</span> \\n<span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">startDate</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">day</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">setHours</span><span class=\\\"p\\\">(</span><span class=\\\"mi\\\">0</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">));</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">endDate</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">day</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">setHours</span><span class=\\\"p\\\">(</span><span class=\\\"mi\\\">23</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">59</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">59</span><span class=\\\"p\\\">));</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">cal</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">CalendarApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getCalendarById</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"s2\\\">ja.japanese#holiday@group.v.calendar.google.com</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">holidays</span> <span class=\\\"o\\\">=</span>  <span class=\\\"nx\\\">cal</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getEvents</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">startDate</span><span class=\\\"p\\\">,</span> <span class=\\\"nx\\\">endDate</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">holidays</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">length</span> <span class=\\\"o\\\">!=</span> <span class=\\\"mi\\\">0</span><span class=\\\"p\\\">;</span> <span class=\\\"c1\\\">// \u795D\u65E5\u306A\u3089true</span>\\n<span class=\\\"p\\\">}</span>\\n\\n</code></pre></div></div>\\n\\n<h1>\\n<span id=\\\"\u7B2C\u4E00\u6708\u66DC\u65E5\u55B6\u696D\u65E5\\\" class=\\\"fragment\\\"></span><a href=\\\"#%E7%AC%AC%E4%B8%80%E6%9C%88%E6%9B%9C%E6%97%A5%E5%96%B6%E6%A5%AD%E6%97%A5\\\"><i class=\\\"fa fa-link\\\"></i></a>\u7B2C\u4E00\u6708\u66DC\u65E5\u55B6\u696D\u65E5</h1>\\n\\n<div class=\\\"code-frame\\\" data-lang=\\\"js\\\"><div class=\\\"highlight\\\"><pre><code>\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">firstNextBusinessMonDay</span><span class=\\\"p\\\">()</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">today</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">();</span>\\n\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">firstDayOfNextMonth</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">today</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getFullYear</span><span class=\\\"p\\\">(),</span> <span class=\\\"nx\\\">today</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getMonth</span><span class=\\\"p\\\">()</span><span class=\\\"o\\\">+</span><span class=\\\"mi\\\">1</span><span class=\\\"p\\\">,</span> <span class=\\\"mi\\\">1</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">day</span><span class=\\\"p\\\">;</span> <span class=\\\"c1\\\">// 0-&gt;\u65E5\u66DC\u65E5</span>\\n\\n  <span class=\\\"k\\\">for</span> <span class=\\\"p\\\">(</span><span class=\\\"kd\\\">var</span> <span class=\\\"nx\\\">i</span> <span class=\\\"o\\\">=</span> <span class=\\\"mi\\\">2</span><span class=\\\"p\\\">;</span> <span class=\\\"nx\\\">i</span> <span class=\\\"o\\\">&lt;</span> <span class=\\\"mi\\\">32</span><span class=\\\"p\\\">;</span> <span class=\\\"nx\\\">i</span><span class=\\\"o\\\">++</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n    <span class=\\\"nx\\\">day</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">firstDayOfNextMonth</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getDay</span><span class=\\\"p\\\">();</span>\\n    <span class=\\\"k\\\">if</span> <span class=\\\"p\\\">(</span><span class=\\\"nx\\\">day</span> <span class=\\\"o\\\">!=</span> <span class=\\\"mi\\\">1</span> <span class=\\\"o\\\">||</span> <span class=\\\"nx\\\">isHoliday</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">firstDayOfNextMonth</span><span class=\\\"p\\\">))</span> <span class=\\\"p\\\">{</span>\\n      <span class=\\\"nx\\\">firstDayOfThisMonth</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">new</span> <span class=\\\"nb\\\">Date</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">today</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getFullYear</span><span class=\\\"p\\\">(),</span> <span class=\\\"nx\\\">today</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getMonth</span><span class=\\\"p\\\">(),</span> <span class=\\\"nx\\\">i</span><span class=\\\"p\\\">);</span>\\n      <span class=\\\"k\\\">continue</span><span class=\\\"p\\\">;</span>\\n    <span class=\\\"p\\\">}</span>\\n    <span class=\\\"k\\\">break</span><span class=\\\"p\\\">;</span>\\n  <span class=\\\"p\\\">}</span>\\n  <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">firstDayOfNextMonth</span><span class=\\\"p\\\">;</span>\\n<span class=\\\"p\\\">}</span>\\n\\n</code></pre></div></div>\\n\\n<p>\u3053\u3053\u3060\u3051\u5909\u3048\u308C\u3070\u3044\u3044\u304B\u306A\u3001\u3053\u3093\u306A\u611F\u3058\uFF1F<br>\\n1\u65E5\u304B\u3089\u63A2\u7D22\u3057\u3066\u3001\u6708\u66DC\u65E5\u4EE5\u5916\u3082\u3057\u304F\u306F\u795D\u65E5\u306A\u3089\u6B21\u306E\u65E5\u306B\u3044\u304F\u3002</p>\\n\\n<p>\u4EE5\u4E0A\u3067\u3059\u3002</p>\\n\\n<h1>\\n<span id=\\\"\u7D42\u308F\u308A\u306B\\\" class=\\\"fragment\\\"></span><a href=\\\"#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB\\\"><i class=\\\"fa fa-link\\\"></i></a>\u7D42\u308F\u308A\u306B</h1>\\n\\n<p>\u91CD\u8981\u306A\u3053\u3068\u306F\u305D\u306E\u307E\u307E\u304A\u30B3\u30D4\u30DA\u3057\u3066\u306A\u3093\u304B\u3084\u3089\u304B\u3057\u3061\u3083\u3063\u305F\u3068\u304B\u8CAC\u4EFB\u3068\u308C\u306A\u3044\u3093\u3067(\u30DF\u30B9\u3042\u3063\u3066\u3082\u3001Slack\u304C\u3042\u308C\u308B\u3068\u304B\u3001\u3082\u3057\u304F\u306F\u901A\u77E5\u3055\u308C\u306A\u3044\u3068\u304B\uFF1F)\u81EA\u8EAB\u306E\u74B0\u5883\u3067\u30C7\u30D0\u30C3\u30AF\u3057\u3066\u304B\u3089\u304A\u4F7F\u3044\u304F\u3060\u3055\u3044\uFF01</p>\\n\\n<p>Google Apps Script\u697D\u3057\u3044\uFF01</p>\\n\\n<p>.</p>\\n\",\"body\":\"# \u6708\u672B\u3063\u3066\u5FD9\u3057\u3044\u3088\u306D\u2026\\n\\n\u6708\u672B\u3063\u3066\u5831\u544A\u66F8\u3068\u304B\u3001\u9818\u53CE\u8A3C\u3068\u304B\u2026\u306A\u3093\u304B\u305F\u304F\u3055\u3093\u51FA\u3055\u306A\u304D\u3083\u3044\u3051\u306A\u3044\u3082\u306E\u3042\u308B\u3088\u306D\u3002\u30BB\u30F3\u30D1\u30A4\u304C\u300C\u8AB0\u304B\u4F5C\u3063\u3066\u300D\u3063\u3066\u8A00\u3063\u3066\u305F\u306E\u3092Google apps script\u3067\u4F5C\u6210\u3057\u307E\u3057\u305F\u3002\\nGoogle apps script[GAS]\u89E6\u308A\u3060\u3057\u30664\u65E5\u76EE\u304F\u3089\u3044\u3067\u3059\u304C\u3001\u304B\u306A\u308A\u4FBF\u5229\u306A\u306E\u3067\u30A8\u30F3\u30B8\u30CB\u30A2\u4EE5\u5916\u306E\u3082\u3063\u3068\u305F\u304F\u3055\u3093\u306E\u4EBA\u306B\u89E6\u308C\u3066\u6B32\u3057\u3044\u306A\u3068\u601D\u3044\u3001\u9023\u65E5\u3067\u3059\u304CGAS\u306E\u5B9F\u7528\u4F8B\u3092\u3042\u3052\u305F\u3044\u3068\u601D\u3044\u307E\u3059\u3002\\n\\n# \u5B8C\u6210\u54C1\\n\\n\u6708\u672B\u306E\u55B6\u696D\u65E5\u306BSlack\u6295\u3052\u308B\u3060\u3051\u306E\u30B7\u30F3\u30D7\u30EB\u306A\u5B9F\u88C5\u3067\u3059\u3002\\n\u30B3\u30D4\u30DA\u3059\u308C\u307010\u5206\u3067\u5B9F\u88C5\u3044\u3051\u308B\u3093\u3058\u3083\u306A\u3044\u304B\u3068\uFF01\\n\\n<img width=\\\"555\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 21.29.19.jpg\\\" src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/e6e7c048-3dcd-0948-0d0d-597bf148ae4d.jpeg\\\">\\n\\n## \u5B8C\u6210\u307E\u3067\u306B\u4F7F\u7528\u3059\u308B\u3082\u306E\\n\\nGoogle\u30A2\u30AB\u30A6\u30F3\u30C8[Google Apps Script]\\nSlack\\n\\n## \u5B8C\u6210\u3057\u305F\u3089\\n\\n\u4EE5\u4E0B\u306E2\u3064\u3082\u30B3\u30FC\u30C9\u516C\u958B\u3057\u307E\u3059\\n* \u6708\u521D\u3081\u306E\u55B6\u696D\u65E5\u306B\u306A\u306B\u304B\u3092\u3059\u308B\\n* \u6708\u59CB\u3081\u306E\u7B2C\u4E00\u91D1\u66DC\u65E5\u306B\u306A\u306B\u304B\u3092\u3059\u308B\\n\\n\u3064\u307E\u308A\u3053\u308C\u3092\u5FDC\u7528\u3059\u308C\u3070\u3001\u3044\u3064\u4F55\u6642\u3067\u3082Slack\u3067\u81EA\u52D5\u30C1\u30E3\u30C3\u30C8\u3092\u98DB\u3070\u305B\u308B\u3088\u3046\u306B\u306A\u308B\u3002\\n\\n# \u6708\u672B\u7DE0\u3081\u2026\uFF01\uFF01\\n\\n\u753B\u50CF\u3042\u308A\u3067\u3069\u3093\u3069\u3093\u3044\u304F\u3088\u301C\u301C\\n\\n## Slack Token\u306E\u53D6\u5F97\\n\\n\u3053\u3053\u3092\u53C2\u8003\u306B\u3057\u3066\u307F\u3066\uFF01\\nhttp://qiita.com/ykhirao/items/0d6b9f4a0cc626884dbb\\n\\nxoxp-18127\u3000\u3053\u3093\u306A\u611F\u3058\u306E\u9577\u3044\u6570\u5B57\u3002\\n\\nSlack\u6301\u3063\u3066\u306A\u3044\u4EBA\u306F[\u500B\u4EBASlack\u306E\u30B9\u30B9\u30E1](http://qiita.com/saitotak/items/ac0eb7ddc0d8d83cbe91)\u306B\u3057\u305F\u304C\u3063\u3066\u5C0E\u5165\u3092\u3059\u3059\u3081\u307E\u3059\u3002\\n\\n## GAS\u306E\u5C0E\u5165\\n\\nGoogle\u30C9\u30E9\u30A4\u30D6\u306B\u30A2\u30AF\u30BB\u30B9\\nhttps://drive.google.com/drive/my-drive\\n\\n<img width=\\\"1192\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 21.59.16.jpg\\\" src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/f0603105-eb23-a7ca-53be-8e593d104516.jpeg\\\">\\n\\n`\u65B0\u898F >> \u305D\u306E\u4ED6 >> \u30A2\u30D7\u30EA\u3092\u8FFD\u52A0`\\n\u304B\u3089 Google apps script \u3092\u691C\u7D22\u30FB\u8FFD\u52A0\\n\\n<img width=\\\"1196\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 22.00.23.jpg\\\" src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/5f579f0d-2d24-34b6-8634-a7f0f4869537.jpeg\\\">\\n\\n\u305D\u3046\u3059\u308B\u3068`\u65B0\u898F >> \u305D\u306E\u4ED6 >> Google apps script`\u3092\u62BC\u3057\u3066\u307F\u3066\u304F\u3060\u3055\u3044\u3002\\nGAS\u753B\u9762\u306B\u306A\u308B\u3068\u601D\u3044\u307E\u3059\u3002\\n\\n## GAS\u306E\u7DE8\u96C6\\n\\n<img width=\\\"816\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 22.23.56.jpg\\\" src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/fcfa979d-2652-f795-c5ba-cb7de40cab02.jpeg\\\">\\n\\n\u30E1\u30A4\u30F3\u306E\u90E8\u5206\u306B\u3053\u308C\u3092\u8CBC\u308A\u4ED8\u3051\u3066\u307F\u3088\u3046\uFF01\\n\\n```js\\n\\n/*\\n  \u30E1\u30A4\u30F3\u306E\u51E6\u7406\\n  setTriggerDay() : \u6700\u7D42\u55B6\u696D\u65E5(0\u6642)\u306B\u6B21\u306E\u51E6\u7406\u3092\u3059\u308B\u547D\u4EE4\u3092\u51FA\u3059\u3002\\n  setTriggerHoursLast() : \u6700\u7D42\u55B6\u696D\u65E5\u306E18\u6642\u306B\u6B21\u306E\u547D\u4EE4\u3092\u51FA\u3059\u3002\\n  sendSlack() : slack\u306B\u30C7\u30FC\u30BF\u3092\u6295\u3052\u308B\u3002\\n\\n  \u30B5\u30D6\u7684\u306A\u51E6\u7406\\n  deleteTrigger() : \u84C4\u7A4D\u3055\u308C\u3066\u3044\u308B\u547D\u4EE4\u3092\u524A\u9664\u3059\u308B\\n  lastBusinessDay() : \u4ECA\u6708\u306E\u6700\u7D42\u55B6\u696D\u65E5\u3092\u6C42\u3081\u308B\\n  isHoliday() : \u672C\u65E5\u304C[\u65E5\u672C\u306E\u795D\u65E5]\u304B\u3069\u3046\u304B\u30C1\u30A7\u30C3\u30AF\u3002\u571F\u65E5\u306F\u66DC\u65E5\u3067\u5224\u5B9A\u3057\u3066\u308B\u30C1\u30A7\u30C3\u30AF\\n  .getDay()\u3000: Date\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u304B\u3089\u66DC\u65E5\u3092\u6C42\u3081\u308B\u30E1\u30BD\u30C3\u30C9(0:\u65E5, 6:\u571F\u66DC\u65E5)\\n*/\\n\\nfunction setTriggerDay()\\n{  \\n  var last = lastBusinessDay();\\n  ScriptApp.newTrigger(\\\"setTriggerHoursLast\\\")\\n    .timeBased()\\n    .atDate(last.getFullYear(), last.getMonth()+1, last.getDate())\\n    .create();\\n}\\n\\nfunction setTriggerHoursLast()\\n{\\n  deleteTrigger(\\\"setTriggerHoursLast\\\");\\n  ScriptApp.newTrigger(\\\"sendSlack\\\")\\n    .timeBased()\\n    .after( 18 * 60 * 60 * 1000 )\\n    .create();\\n}\\n\\nfunction sendSlack() \\n{\\n  deleteTrigger(\\\"sendSlack\\\");\\n  var options = \\n  {\\n    \\\"method\\\" : \\\"POST\\\",\\n    \\\"payload\\\" : \\n    {\\n      \\\"token\\\": \\\"********************\\\",\\n      \\\"channel\\\": \\\"bot-test\\\",\\n      \\\"text\\\": \\\"\u9818\u53CE\u66F8\u51FA\u3057\u307E\u3057\u305F\u304B\uFF1F\u5FD8\u308C\u3066\u306A\u3044\u3088\u306D\u3002\\\\\uFF4Ehttp://.../\\\"\\n    }\\n  }\\n  var url = \\\"https://slack.com/api/chat.postMessage\\\"\\n  UrlFetchApp.fetch(url, options);\\n}\\n\\nfunction lastBusinessDay() \\n{\\n  var today = new Date();\\n  \\n  var lastDayOfThisMonth = new Date(today.getFullYear(), today.getMonth()+1, 0);\\n  var day; // 0->\u65E5\u66DC\u65E5\\n  \\n  for (var i = 0; i < 30; i++) {\\n    day = lastDayOfThisMonth.getDay();\\n    if (day == 0 || day == 6 || isHoliday(lastDayOfThisMonth)) {\\n      lastDayOfThisMonth = new Date(today.getFullYear(), today.getMonth()+1, -1 * i);\\n      continue;\\n    }\\n  }\\n  return lastDayOfThisMonth;\\n}\\n\\nfunction deleteTrigger(name) \\n{\\n  var triggers = ScriptApp.getProjectTriggers();\\n  for(var i=0; i < triggers.length; i++) {\\n    if (triggers[i].getHandlerFunction() == name) {\\n      ScriptApp.deleteTrigger(triggers[i]);\\n    }\\n  }\\n}\\n\\nfunction isHoliday(day) \\n{\\n  var startDate = new Date(day.setHours(0, 0, 0, 0));\\n  var endDate = new Date(day.setHours(23, 59, 59));\\n  var cal = CalendarApp.getCalendarById(\\\"ja.japanese#holiday@group.v.calendar.google.com\\\");\\n  var holidays =  cal.getEvents(startDate, endDate);\\n  return holidays.length != 0; // \u795D\u65E5\u306A\u3089true\\n}\\n\\n```\\nsendSlack\u306E\u3053\u3053\u306F\u500B\u4EBA\u8A2D\u5B9A\u306B\u5909\u3048\u3066\u304F\u3060\u3055\u3044\uFF01\\n\\n- \\\"token\\\": \\\"********************\\\",\\n- \\\"channel\\\": \\\"bot-test\\\",\\n- \\\"text\\\": \\\"\u9818\u53CE\u66F8\u51FA\u3057\u307E\u3057\u305F\u304B\uFF1F\u5FD8\u308C\u3066\u306A\u3044\u3088\u306D\u3002\\\\\uFF4Ehttp://.../\\\"\\n\\n\\n## setTriggerDay()\u306E\u5B9F\u884C\u3068\u53D6\u308A\u6D88\u3057\u3068\u6BCE\u6708\u5B9F\u884C\\n\u5B9F\u884C >> setTriggerDay\\n\u3092\u304A\u3057\u3066\u307F\u3088\u3046\u3002\\n\\n<img width=\\\"527\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 22.26.52.jpg\\\" src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/6eb86e29-a4f9-4fd0-e62d-76a8af233a72.jpeg\\\">\\n\\n\u30EA\u30BD\u30FC\u30B9 >> \u73FE\u5728\u306E\u30D7\u30ED\u30B8\u30A7\u30AF\u30C8\u306E\u30C8\u30EA\u30AC\u30FC\\n\u3053\u3053\u304B\u3089\u30C8\u30EA\u30AC\u30FC\uFF08\u4F55\u6642\u306B\u3042\u308C\u3092\u5B9F\u884C\u3057\u306A\u3055\u3044\uFF09\u3092\u78BA\u8A8D\u3067\u304D\u307E\u3059\u3002\\n\\n<img width=\\\"648\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 22.27.40.jpg\\\" src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/daefaa91-51fc-0fbf-4057-b316c8be45b1.jpeg\\\">\\n\\n\u3053\u3053\u3067 2017/03/21 \u591C\u4E2D\u4E01\u5EA6\u306B setTriggerHoursLast \u304C\u5B9F\u884C\u3055\u308C\u308B\u3088\u3046\u306B\u306A\u3063\u3066\u3044\u305F\u3089\u5927\u4E08\u592B\u3002setTriggerHoursLast\u306F18\u6642\u9593\u5F8C\u306BSlack\u9001\u308A\u306A\u3055\u3044\u3068\u3044\u3046\u547D\u4EE4\u3067\u3059\u3002\\n\\n<img width=\\\"838\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 22.27.47.jpg\\\" src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/bb6cf9a2-aef7-769c-c69b-ba4eaa9b3e98.jpeg\\\">\\n\\n\u307E\u305F\u3064\u3044\u3067\u306B\u3053\u306E\u753B\u9762\u3067setTriggerDay\u3092\u6BCE\u67081\u65E56\u6642\u304F\u3089\u3044\u306B\u30BB\u30C3\u30C8\u3057\u307E\u3059\u3002\\n\\n<img width=\\\"836\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 22.37.18.jpg\\\" src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/3288c9c8-dea7-5bdd-eefa-43fc7735fcfb.jpeg\\\">\\n\\n\\n\u305D\u3046\u3059\u308B\u3068\u6BCE\u67081\u65E5\u306BsetTriggerDay\u304C\u5B9F\u884C\u3055\u308C\u3066\\n-> setTriggerDay :\u6700\u7D42\u65E5\u306B\u6B21\u3092\u5B9F\u884C\\n-> setTriggerHoursLast :18\u6642\u306B\u6B21\u3092\u5B9F\u884C\\n-> sendSlack :Slack\u3092\u5B9F\u884C\\n\\n\u3063\u3066\u611F\u3058\u3067\u6BCE\u6708\u3001\u6700\u7D42\u65E5\u30C8\u30EA\u30AC\u30FC\u3092\u4F5C\u6210\u3057\u3066\u304F\u308C\u307E\u3059\u3002\\n\\n## function\u3054\u3068\u306B\u898B\u3066\u3044\u304F\\n\\n\u7C21\u5358\u306B\u307F\u3066\u3044\u304D\u307E\u3059\u3002\\n\\n### setTriggerDay\\n\\n```js\\nfunction setTriggerDay()\\n{  \\n  var last = lastBusinessDay();\\n  ScriptApp.newTrigger(\\\"setTriggerHoursLast\\\")\\n    .timeBased()\\n    .atDate(last.getFullYear(), last.getMonth()+1, last.getDate())\\n    .create();\\n}\\n```\\n\\nlastBusinessDay()\u3067\u55B6\u696D\u65E5\u6700\u7D42\u65E5\u306EDate\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u3092\u53D6\u3063\u3066\u304D\u3066\\n.atDate(last.getMonth()+1)\u3068\u3057\u3066\u3044\u308B\u3068\u3053\u308D\u306F\u3001\u6708\u306F0\u6708\u59CB\u307E\u308A\u3068\u306A\u3063\u3066\u3044\u308B\u304B\u3089\u3067\u3059\u3002\\n\\n### setTriggerHoursLast\\n\\n```js\\nfunction setTriggerHoursLast()\\n{\\n  deleteTrigger(\\\"setTriggerHoursLast\\\");\\n  ScriptApp.newTrigger(\\\"sendSlack\\\")\\n    .timeBased()\\n    .after( 18 * 60 * 60 * 1000 )\\n    .create();\\n}\\n```\\n.after( 18 * 60 * 60 * 1000 )\u3067\u30DF\u30EA\u79D2\u5F8C\u306B\u30C8\u30EA\u30AC\u30FC\u3092\u30BB\u30C3\u30C8\u3057\u3066\u307E\u3059\u3002\\n\\n### sendSlack\\n\\n```js\\nfunction sendSlack() \\n{\\n  deleteTrigger(\\\"sendSlack\\\");\\n  var options = \\n  {\\n    \\\"method\\\" : \\\"POST\\\",\\n    \\\"payload\\\" : \\n    {\\n      \\\"token\\\": \\\"********************\\\",\\n      \\\"channel\\\": \\\"bot-test\\\",\\n      \\\"text\\\": \\\"\u9818\u53CE\u66F8\u51FA\u3057\u307E\u3057\u305F\u304B\uFF1F\u5FD8\u308C\u3066\u306A\u3044\u3088\u306D\u3002\\\\\uFF4Ehttp://.../\\\"\\n    }\\n  }\\n  var url = \\\"https://slack.com/api/chat.postMessage\\\"\\n  UrlFetchApp.fetch(url, options);\\n}\\n```\\n\\n\u3053\u3046\u3044\u3046\u66F8\u304D\u65B9\u3060\u3068\u601D\u3063\u3066\u3044\u305F\u3060\u3051\u308C\u3070\u2026\\n\u8A73\u3057\u304F\u306F\u516C\u5F0F\u30C9\u30AD\u30E5\u30E1\u30F3\u30C8\u3067\u3000https://api.slack.com/methods/chat.postMessage\\n\\n### lastBusinessDay\\n\\n```js\\nfunction lastBusinessDay() \\n{\\n  var today = new Date();\\n  var lastDayOfThisMonth = new Date(today.getFullYear(), today.getMonth()+1, 0);\\n  var day; // 0->\u65E5\u66DC\u65E5\\n\\n  for (var i = 0; i < 30; i++) {\\n    day = lastDayOfThisMonth.getDay();\\n    if (day == 0 || day == 6 || isHoliday(lastDayOfThisMonth)) {\\n      lastDayOfThisMonth = new Date(today.getFullYear(), today.getMonth()+1, -1 * i);\\n      continue;\\n    }\\n    break;\\n  }\\n  return lastDayOfThisMonth;\\n}\\n```\\n\\nday == 0 || day == 6 || isHoliday(lastDayOfThisMonth)\\n\u3053\u3053\u3067\u571F\u65E5\u3082\u3057\u304F\u306F\u795D\u65E5\u5224\u5B9A\u3092\u3057\u3066\u3044\u307E\u3059\u3002\\n\\n### deleteTrigger\\n\\n```js\\n\\nfunction deleteTrigger(name) \\n{\\n  var triggers = ScriptApp.getProjectTriggers();\\n  for(var i=0; i < triggers.length; i++) {\\n    if (triggers[i].getHandlerFunction() == name) {\\n      ScriptApp.deleteTrigger(triggers[i]);\\n    }\\n  }\\n}\\n\\n```\\n\\n\u5B9F\u306F\u81EA\u5206\u3067\u30BB\u30C3\u30C8\u3057\u305Ftrigger\u3063\u3066\u3053\u3093\u306A\u611F\u3058\u30671\u5206\u3054\u3068\u306B\u305F\u307E\u3063\u3066\u3044\u304D\u307E\u3059\u3002\\n\u4ECA\u56DE\u3060\u3068\\\"MAIAMAIN\\\"\u3063\u3066\u540D\u524D\u306E\u30C8\u30EA\u30AC\u30FC\u3092\u5168\u524A\u9664\u3059\u308B\u6A5F\u80FD\u306B\u306A\u3063\u3066\u307E\u3059\u3002\\n<img width=\\\"735\\\" alt=\\\"\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8 2017-03-06 23.14.29.jpg\\\" src=\\\"https://qiita-image-store.s3.amazonaws.com/0/112929/ac6f4c7c-f142-f4ca-f7dc-f95088bc7118.jpeg\\\">\\n\\n\u53C2\u8003\uFF1A\u3000http://qiita.com/sumi-engraphia/items/465dd027e17f44da4d6a\\n\\n### isHoliday\\n\\n```js\\n\\nfunction isHoliday(day) \\n{\\n  var startDate = new Date(day.setHours(0, 0, 0, 0));\\n  var endDate = new Date(day.setHours(23, 59, 59));\\n  var cal = CalendarApp.getCalendarById(\\\"ja.japanese#holiday@group.v.calendar.google.com\\\");\\n  var holidays =  cal.getEvents(startDate, endDate);\\n  return holidays.length != 0; // \u795D\u65E5\u306A\u3089true\\n}\\n\\n```\\n\\ngetCalendarById\u3067Google\u306E[\u65E5\u672C\u306E\u795D\u65E5]\u3092\u53D6\u5F97\u3057\u3066\u304D\u3066\u307E\u3059\u3002\\n\\n\u53C2\u8003\uFF1A\u3000http://qiita.com/kamatama_41/items/be40e05524530920a9d9\\n\\n\u7D42\u308F\u308A\u307E\u3057\u305F\u301C\u301C\\n\u6B21\u306F\u6708\u521D\u3081\u306E\u55B6\u696D\u65E5\u3092\u53D6\u3063\u3066\u3044\u304D\u307E\u3059\u301C\u301C\\n\\n# \u6708\u521D\u3081\u306E\u55B6\u696D\u65E5\\n\\n```js\\n\\n/*\\n  \u30E1\u30A4\u30F3\u306E\u51E6\u7406\\n  setTriggerDay() : \u306F\u3058\u3081\u306E\u55B6\u696D\u65E5(0\u6642)\u306B\u6B21\u306E\u51E6\u7406\u3092\u3059\u308B\u547D\u4EE4\u3092\u51FA\u3059\u3002\\n  setTriggerHoursFirst() : \u306F\u3058\u3081\u306E\u55B6\u696D\u65E5\u306E11\u6642\u306B\u6B21\u306E\u547D\u4EE4\u3092\u51FA\u3059\u3002\\n  sendSlack() : slack\u306B\u30C7\u30FC\u30BF\u3092\u6295\u3052\u308B\u3002\\n\\n  \u30B5\u30D6\u7684\u306A\u51E6\u7406\\n  deleteTrigger() : \u84C4\u7A4D\u3055\u308C\u3066\u3044\u308B\u547D\u4EE4\u3092\u524A\u9664\u3059\u308B\\n  firstNextBusinessDay() : \u6765\u6708\u306E\u306F\u3058\u3081\u306E\u55B6\u696D\u65E5\u3092\u6C42\u3081\u308B\\n  isHoliday() : \u672C\u65E5\u304C[\u65E5\u672C\u306E\u795D\u65E5]\u304B\u3069\u3046\u304B\u30C1\u30A7\u30C3\u30AF\u3002\u571F\u65E5\u306F\u66DC\u65E5\u3067\u5224\u5B9A\u3057\u3066\u308B\u30C1\u30A7\u30C3\u30AF\\n  .getDay()\u3000: Date\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u304B\u3089\u66DC\u65E5\u3092\u6C42\u3081\u308B\u30E1\u30BD\u30C3\u30C9(0:\u65E5, 6:\u571F\u66DC\u65E5)\\n*/\\n\\nfunction setTriggerDay2()\\n{  \\n  var first = firstNextBusinessDay();\\n  ScriptApp.newTrigger(\\\"setTriggerHoursFirst\\\")\\n    .timeBased()\\n    .atDate(first.getFullYear(), first.getMonth()+1, first.getDate())\\n    .create();\\n}\\n\\nfunction setTriggerHoursFirst()\\n{\\n ScriptApp.newTrigger(\\\"sendSlack\\\")\\n   .timeBased()\\n   .after(11 * 60 * 60 * 1000)\\n   .create();\\n}\\n\\nfunction sendSlack() \\n{\\n  var options = \\n  {\\n    \\\"method\\\" : \\\"POST\\\",\\n    \\\"payload\\\" : \\n    {\\n      \\\"token\\\": \\\"********************\\\",\\n      \\\"channel\\\": \\\"bot-test\\\",\\n      \\\"text\\\": \\\"\u6708\u304C\u59CB\u307E\u308A\u307E\u3057\u305F\u3002\\\"\\n    }\\n  }\\n  var url = \\\"https://slack.com/api/chat.postMessage\\\"\\n  UrlFetchApp.fetch(url, options);\\n}\\n\\nfunction firstNextBusinessDay() \\n{\\n  var today = new Date();  \\n  var firstDayOfNextMonth = new Date(today.getFullYear(), today.getMonth()+1, 1);\\n  var day; // 0->\u65E5\u66DC\u65E5\\n  \\n  for (var i = 2; i < 32; i++) {\\n    day = firstDayOfNextMonth.getDay();\\n    if (day == 0 || day == 6 || isHoliday(firstDayOfNextMonth)) {\\n      firstDayOfThisMonth = new Date(today.getFullYear(), today.getMonth(), i);\\n      continue;\\n    }\\n  }\\n  return firstDayOfNextMonth;\\n}\\n\\nfunction deleteTrigger() \\n{\\n  var triggers = ScriptApp.getProjectTriggers();\\n  for(var i=0; i < triggers.length; i++) {\\n    if (triggers[i].getHandlerFunction() == \\\"main\\\") {\\n      ScriptApp.deleteTrigger(triggers[i]);\\n    }\\n  }\\n}\\n\\nfunction isHoliday(day) \\n{\\n  var startDate = new Date(day.setHours(0, 0, 0, 0));\\n  var endDate = new Date(day.setHours(23, 59, 59));\\n  var cal = CalendarApp.getCalendarById(\\\"ja.japanese#holiday@group.v.calendar.google.com\\\");\\n  var holidays =  cal.getEvents(startDate, endDate);\\n  return holidays.length != 0; // \u795D\u65E5\u306A\u3089true\\n}\\n\\n```\\n\\n# \u7B2C\u4E00\u6708\u66DC\u65E5\u55B6\u696D\u65E5\\n\\n```js\\n\\nfunction firstNextBusinessMonDay() {\\n  var today = new Date();\\n  \\n  var firstDayOfNextMonth = new Date(today.getFullYear(), today.getMonth()+1, 1);\\n  var day; // 0->\u65E5\u66DC\u65E5\\n  \\n  for (var i = 2; i < 32; i++) {\\n    day = firstDayOfNextMonth.getDay();\\n    if (day != 1 || isHoliday(firstDayOfNextMonth)) {\\n      firstDayOfThisMonth = new Date(today.getFullYear(), today.getMonth(), i);\\n      continue;\\n    }\\n    break;\\n  }\\n  return firstDayOfNextMonth;\\n}\\n\\n```\\n\u3053\u3053\u3060\u3051\u5909\u3048\u308C\u3070\u3044\u3044\u304B\u306A\u3001\u3053\u3093\u306A\u611F\u3058\uFF1F\\n1\u65E5\u304B\u3089\u63A2\u7D22\u3057\u3066\u3001\u6708\u66DC\u65E5\u4EE5\u5916\u3082\u3057\u304F\u306F\u795D\u65E5\u306A\u3089\u6B21\u306E\u65E5\u306B\u3044\u304F\u3002\\n\\n\\n\u4EE5\u4E0A\u3067\u3059\u3002\\n\\n\\n# \u7D42\u308F\u308A\u306B\\n\\n\u91CD\u8981\u306A\u3053\u3068\u306F\u305D\u306E\u307E\u307E\u304A\u30B3\u30D4\u30DA\u3057\u3066\u306A\u3093\u304B\u3084\u3089\u304B\u3057\u3061\u3083\u3063\u305F\u3068\u304B\u8CAC\u4EFB\u3068\u308C\u306A\u3044\u3093\u3067(\u30DF\u30B9\u3042\u3063\u3066\u3082\u3001Slack\u304C\u3042\u308C\u308B\u3068\u304B\u3001\u3082\u3057\u304F\u306F\u901A\u77E5\u3055\u308C\u306A\u3044\u3068\u304B\uFF1F)\u81EA\u8EAB\u306E\u74B0\u5883\u3067\u30C7\u30D0\u30C3\u30AF\u3057\u3066\u304B\u3089\u304A\u4F7F\u3044\u304F\u3060\u3055\u3044\uFF01\\n\\nGoogle Apps Script\u697D\u3057\u3044\uFF01\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n.\\n\",\"coediting\":false,\"comments_count\":0,\"created_at\":\"2017-03-06T23:34:54+09:00\",\"group\":null,\"id\":\"782e20ab0465533c48f6\",\"likes_count\":44,\"private\":false,\"reactions_count\":0,\"stocks_count\":51,\"tags\":[{\"name\":\"JavaScript\",\"versions\":[]},{\"name\":\"Google\",\"versions\":[]},{\"name\":\"GoogleAppsScript\",\"versions\":[]},{\"name\":\"Slack\",\"versions\":[]}],\"title\":\"\u6708\u672B\u55B6\u696D\u65E5\u306B\u30BF\u30B9\u30AF\u3092\u30EA\u30DE\u30A4\u30F3\u30C9\u3059\u308B ~ \u4F7F\u3046\u306E\u306FSlack\u3068Google\u30A2\u30AB\u30A6\u30F3\u30C8\u3060\u3051\u306710\u5206\u304F\u3089\u3044\u3067\u5B9F\u88C5\u3067\u304D\u308B\u3088 ~\",\"updated_at\":\"2017-03-06T23:39:17+09:00\",\"url\":\"https://qiita.com/ykhirao/items/782e20ab0465533c48f6\",\"user\":{\"description\":\"Web Developer From 2016.\\r\\nPHP/Laravel && React/TypeScript/Node.js\\r\\n\\r\\n\u696D\u52D9\u59D4\u8A17\u306E\u4F9D\u983C\u3068\u304B\u306FWantedly\u3068\u304B\u304B\u3089\u3067\u304A\u9858\u3044\u3057\u307E\u3059\uFF01\",\"facebook_id\":\"\",\"followees_count\":39,\"followers_count\":103,\"github_login_name\":\"ykhirao\",\"id\":\"ykhirao\",\"items_count\":83,\"linkedin_id\":\"\",\"location\":\"Tokyo, Japan\",\"name\":\"yk\",\"organization\":\"\",\"permanent_id\":112929,\"profile_image_url\":\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/profile-images/1639030792\",\"team_only\":false,\"twitter_screen_name\":\"ykhirao\",\"website_url\":\"https://www.wantedly.com/id/ykhirao\"},\"page_views_count\":null,\"team_membership\":null,\"organization_url_name\":null,\"slide\":false}},\"path\":\"posts/782e20ab0465533c48f6\",\"sharedData\":{},\"siteData\":{\"updatedAt\":\"2024/03/18\"}}");</script><script defer="" type="text/javascript" src="/templates/styles.5353cbc5.js"></script><script defer="" type="text/javascript" src="/templates/vendors~main.991a9778.js"></script><script defer="" type="text/javascript" src="/main.e4c894d8.js"></script></body></html>