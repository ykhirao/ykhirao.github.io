<!DOCTYPE html><html lang="en"><head><meta name="generator" content="React Static"/><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, shrink-to-fit=no"/><link rel="preload" as="script" href="/templates/styles.ce528c12.js"/><link rel="preload" as="script" href="/templates/vendors~main.991a9778.js"/><link rel="preload" as="script" href="/main.e4c894d8.js"/><link rel="preload" as="style" href="/styles.642cfcb4.css"/><link rel="stylesheet" href="/styles.642cfcb4.css"/><link rel="shortcut icon" href="/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png"/><link rel="manifest" href="/manifest.json"/><meta name="mobile-web-app-capable" content="yes"/><meta name="theme-color" content="#fff"/><meta name="application-name"/><link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png"/><link rel="apple-touch-icon" sizes="167x167" href="/apple-touch-icon-167x167.png"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"/><link rel="apple-touch-icon" sizes="1024x1024" href="/apple-touch-icon-1024x1024.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/><meta name="apple-mobile-web-app-title"/><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-640x1136.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-750x1334.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-828x1792.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1125x2436.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2208.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2688.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1536x2048.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2224.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2388.png"/><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-2048x2732.png"/><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1620x2160.png"/><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1136x640.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1334x750.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1792x828.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2436x1125.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2208x1242.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2688x1242.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2048x1536.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2224x1668.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2388x1668.png"/><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2732x2048.png"/><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1620.png"/><link rel="icon" type="image/png" sizes="228x228" href="/coast-228x228.png"/><meta name="msapplication-TileColor" content="#fff"/><meta name="msapplication-TileImage" content="/mstile-144x144.png"/><meta name="msapplication-config" content="/browserconfig.xml"/><link rel="yandex-tableau-widget" href="/yandex-browser-manifest.json"/></head><body><div id="root"><div style="outline:none" tabindex="-1"><nav class="navbar is-dark is-fixed-top" role="navigation" aria-label="main navigation"><div class="container"><div class="navbar-brand"><a class="navbar-item" href="/">Home</a><a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false"><span aria-hidden="true"></span><span aria-hidden="true"></span><span aria-hidden="true"></span></a></div><div id="navbarBasicExample" class="navbar-menu "><div class="navbar-start"><a class="navbar-item" href="/posts">Posts</a><a class="navbar-item" href="/events">Events</a><a class="navbar-item" href="/github">GitHub</a></div></div></div></nav><div class="container"><div class="is-primary" style="padding:4.5rem 0.5rem"><div style="outline:none" tabindex="-1"><div><a href="/posts">&lt;<!-- --> Back</a><br/><h3>ラズベリーパイでPlaywrightを使い検索のスクリーンショットを取りまくった話</h3><article class="md-body"><p data-sourcepos="3:1-3:102">ラズベリーパイだとPlayWrite対応してなさそうだったけど色々やったら動いた</p>
<p data-sourcepos="5:1-5:51"><iframe id="qiita-embed-content__d2703c358430dbf03db7dac390d01c3a" src="https://qiita.com/embed-contents/link-card#qiita-embed-content__d2703c358430dbf03db7dac390d01c3a" data-content="https%3A%2F%2Fgithub.com%2Fmicrosoft%2Fplaywright%2Fissues%2F4984" frameborder="0" scrolling="no" loading="lazy" style="width:100%;" height="29">
</iframe>
</p>
<h2 data-sourcepos="8:1-8:12">
<span id="やり方" class="fragment"></span><a href="#%E3%82%84%E3%82%8A%E6%96%B9"><i class="fa fa-link"></i></a>やり方</h2>
<h3 data-sourcepos="10:1-10:33">
<span id="chromiumのインストール" class="fragment"></span><a href="#chromium%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>chromiumのインストール</h3>
<p data-sourcepos="13:1-13:36"><iframe id="qiita-embed-content__b1bef422c78d0d19074711bb78a80172" src="https://qiita.com/embed-contents/link-card#qiita-embed-content__b1bef422c78d0d19074711bb78a80172" data-content="https%3A%2F%2Fraspida.com%2Finstall-chromium" frameborder="0" scrolling="no" loading="lazy" style="width:100%;" height="29">
</iframe>
</p>
<div class="code-frame" data-lang="text" data-sourcepos="15:1-19:3"><div class="highlight"><pre><code>$ sudo apt install chromium
$ which chromium
/usr/bin/chromium
</code></pre></div></div>
<p data-sourcepos="21:1-21:43">後でNode.jsのコードにいれます。</p>
<h2 data-sourcepos="24:1-24:22">
<span id="nodejs側コード" class="fragment"></span><a href="#nodejs%E5%81%B4%E3%82%B3%E3%83%BC%E3%83%89"><i class="fa fa-link"></i></a>Node.js側コード</h2>
<div class="code-frame" data-lang="json" data-sourcepos="27:1-51:3"><div class="highlight"><pre><code><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"piapp"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1.0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ラズベリーパイに利用するアプリケーション"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"main"</span><span class="p">:</span><span class="w"> </span><span class="s2">"index.js"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"start"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NODE_ENV=production forever start -vc ts-node src/index.ts"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"stop"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NODE_ENV=production forever stop -vc ts-node src/index.ts"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"dev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nodemon"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"keywords"</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span><span class="w">
  </span><span class="nl">"author"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nl">"license"</span><span class="p">:</span><span class="w"> </span><span class="s2">"MIT"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"dependencies"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"chrome-aws-lambda"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^10.1.0"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"node-cron"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^3.0.3"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"playwright-core"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.40.1"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"devDependencies"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"@types/node"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^20.10.4"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"@types/node-cron"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^3.0.11"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
<p data-sourcepos="54:1-54:39">この記事が一番参考になった</p>
<p data-sourcepos="56:1-56:51"><iframe id="qiita-embed-content__81f553752a6ba7054a00d678f7d1b122" src="https://qiita.com/embed-contents/link-card#qiita-embed-content__81f553752a6ba7054a00d678f7d1b122" data-content="https%3A%2F%2Fgithub.com%2Fmicrosoft%2Fplaywright%2Fissues%2F2834" frameborder="0" scrolling="no" loading="lazy" style="width:100%;" height="29">
</iframe>
</p>
<div class="code-frame" data-lang="js" data-sourcepos="59:1-106:3"><div class="highlight"><pre><code><span class="kd">const</span> <span class="nx">piChrome</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">/usr/bin/chromium</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// for Raspberry Pi, after like `$ sudo apt install chromium`</span>
<span class="k">import</span> <span class="nx">path</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">path</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">fs</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">fs</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">chromium</span><span class="p">,</span> <span class="nx">devices</span><span class="p">,</span> <span class="nx">Page</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">playwright-core</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">nowSecondString</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./utils</span><span class="dl">'</span><span class="p">;</span>

<span class="cm">/** TypeのKeyをStringのUnion型にする */</span>
<span class="k">export</span> <span class="nx">type</span> <span class="nx">NoStringIndex</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">{</span> <span class="p">[</span><span class="nx">K</span> <span class="k">in</span> <span class="nx">keyof</span> <span class="nx">T</span> <span class="k">as</span> <span class="nx">string</span> <span class="kd">extends</span> <span class="nx">K</span> <span class="p">?</span> <span class="nx">never</span> <span class="p">:</span> <span class="nx">K</span><span class="p">]:</span> <span class="nx">T</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span> <span class="p">};</span>
<span class="k">export</span> <span class="nx">type</span> <span class="nx">DeviceType</span> <span class="o">=</span> <span class="nx">keyof</span> <span class="nx">NoStringIndex</span><span class="o">&lt;</span><span class="k">typeof</span> <span class="nx">devices</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">export</span> <span class="nx">type</span> <span class="nx">DeviceDescriptor</span> <span class="o">=</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">devices</span><span class="p">)[</span><span class="dl">'</span><span class="s1">Pixel 5</span><span class="dl">'</span><span class="p">];</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">playwrightScreenshotOnlyLocal</span> <span class="o">=</span> <span class="k">async </span><span class="p">(</span><span class="nx">page</span><span class="p">:</span> <span class="nx">Page</span><span class="p">,</span> <span class="nx">text</span><span class="p">?:</span> <span class="nx">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">if </span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">production</span><span class="dl">'</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
  <span class="k">await</span> <span class="nx">page</span><span class="p">.</span><span class="nf">screenshot</span><span class="p">({</span>
    <span class="na">path</span><span class="p">:</span> <span class="nx">path</span><span class="p">.</span><span class="nf">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s2">`../downloads/</span><span class="p">${</span><span class="nf">nowSecondString</span><span class="p">()}</span><span class="s2">.jpg`</span><span class="p">),</span>
    <span class="na">fullPage</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="p">}).</span><span class="k">catch</span><span class="p">(</span><span class="nx">_</span> <span class="o">=&gt;</span> <span class="kc">undefined</span><span class="p">);</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">googleCheck</span> <span class="o">=</span> <span class="k">async </span><span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">browser</span> <span class="o">=</span> <span class="k">await</span> <span class="nf">createChromeBrowser</span><span class="p">();</span>

  <span class="kd">const</span> <span class="nx">page</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">browser</span><span class="p">.</span><span class="nf">newPage</span><span class="p">();</span>
  <span class="k">await</span> <span class="nx">page</span><span class="p">.</span><span class="nf">goto</span><span class="p">(</span><span class="dl">'</span><span class="s1">https://www.google.com/search?q=新宿の天気</span><span class="dl">'</span><span class="p">);</span>
  <span class="nx">console</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">await page.title(): </span><span class="dl">'</span><span class="p">,</span> <span class="k">await</span> <span class="nx">page</span><span class="p">.</span><span class="nf">title</span><span class="p">());</span>

  <span class="k">await</span> <span class="nf">playwrightScreenshotOnlyLocal</span><span class="p">(</span><span class="nx">page</span><span class="p">)</span>

  <span class="k">return</span> <span class="k">await</span> <span class="nx">browser</span><span class="p">.</span><span class="nf">close</span><span class="p">();</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">defaultOption</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">headless</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">slowMo</span><span class="p">:</span> <span class="mi">333</span><span class="p">,</span>
  <span class="na">timeout</span><span class="p">:</span> <span class="mi">150000</span><span class="p">,</span> <span class="c1">// 120 sec</span>
  <span class="na">args</span><span class="p">:</span> <span class="p">[</span>
    <span class="dl">'</span><span class="s1">--lang=ja</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// 日本語対応</span>
  <span class="p">],</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">createChromeBrowser</span> <span class="o">=</span> <span class="k">async </span><span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="na">executablePath</span><span class="p">:</span> <span class="nx">string</span> <span class="o">|</span> <span class="kc">undefined</span><span class="p">;</span>
  <span class="nx">executablePath</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nf">existsSync</span><span class="p">(</span><span class="nx">piChrome</span><span class="p">)</span> <span class="p">?</span> <span class="nx">piChrome</span> <span class="p">:</span> <span class="kc">undefined</span><span class="p">;</span>
  <span class="k">if </span><span class="p">(</span><span class="nx">executablePath</span><span class="p">)</span> <span class="k">return</span> <span class="nx">chromium</span><span class="p">.</span><span class="nf">launch</span><span class="p">({</span> <span class="nx">executablePath</span><span class="p">,</span> <span class="p">...</span><span class="nx">defaultOption</span> <span class="p">});</span>
  <span class="k">return</span> <span class="nx">chromium</span><span class="p">.</span><span class="nf">launch</span><span class="p">(</span><span class="nx">defaultOption</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div></div>
<p data-sourcepos="109:1-109:60">だいたいこんな感じのコードで動きました。</p>
<p data-sourcepos="112:1-112:230">MacOSで開発しているときは <code>/usr/bin/chromium</code> にchromiumがなく <code>npx install playwrite</code> でインストールした実体を動かして、ラズベリーパイのときは <code>/usr/bin/chromium</code> で動かしました。</p>
<p data-sourcepos="114:1-115:133">これで毎日朝7時に新宿区の天気をスクショして保存するという動作を node-cron で走らせられるようになりました。<br>
<a href="https://camo.qiitausercontent.com/a780fd97e59dfc48e5fb492289ccb7c38cee083b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f35643934333836362d373265642d316431342d366635342d3931666563383735376533372e6a706567" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F5d943866-72ed-1d14-6f54-91fec8757e37.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8a8d6da0a7a9209df670eae993f2eea1" alt="20231216_2226794.jpg" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/5d943866-72ed-1d14-6f54-91fec8757e37.jpeg" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F5d943866-72ed-1d14-6f54-91fec8757e37.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=9d4904c1b299da310409729222b76604 1x" loading="lazy"></a></p>
</article></div></div></div></div><footer class="footer"><div class="content has-text-centered"><p>last uploaded at <!-- -->2024/01/08</p><p>© 2021 ykhirao</p></div></footer></div></div><script type="text/javascript">window.__routeInfo = JSON.parse("{\"template\":\"__react_static_root__/src/components/QiitaPost\",\"sharedHashesByProp\":{},\"data\":{\"post\":{\"rendered_body\":\"<p data-sourcepos=\\\"3:1-3:102\\\">\u30E9\u30BA\u30D9\u30EA\u30FC\u30D1\u30A4\u3060\u3068PlayWrite\u5BFE\u5FDC\u3057\u3066\u306A\u3055\u305D\u3046\u3060\u3063\u305F\u3051\u3069\u8272\u3005\u3084\u3063\u305F\u3089\u52D5\u3044\u305F</p>\\n<p data-sourcepos=\\\"5:1-5:51\\\"><iframe id=\\\"qiita-embed-content__d2703c358430dbf03db7dac390d01c3a\\\" src=\\\"https://qiita.com/embed-contents/link-card#qiita-embed-content__d2703c358430dbf03db7dac390d01c3a\\\" data-content=\\\"https%3A%2F%2Fgithub.com%2Fmicrosoft%2Fplaywright%2Fissues%2F4984\\\" frameborder=\\\"0\\\" scrolling=\\\"no\\\" loading=\\\"lazy\\\" style=\\\"width:100%;\\\" height=\\\"29\\\">\\n</iframe>\\n</p>\\n<h2 data-sourcepos=\\\"8:1-8:12\\\">\\n<span id=\\\"\u3084\u308A\u65B9\\\" class=\\\"fragment\\\"></span><a href=\\\"#%E3%82%84%E3%82%8A%E6%96%B9\\\"><i class=\\\"fa fa-link\\\"></i></a>\u3084\u308A\u65B9</h2>\\n<h3 data-sourcepos=\\\"10:1-10:33\\\">\\n<span id=\\\"chromium\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\\\" class=\\\"fragment\\\"></span><a href=\\\"#chromium%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB\\\"><i class=\\\"fa fa-link\\\"></i></a>chromium\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB</h3>\\n<p data-sourcepos=\\\"13:1-13:36\\\"><iframe id=\\\"qiita-embed-content__b1bef422c78d0d19074711bb78a80172\\\" src=\\\"https://qiita.com/embed-contents/link-card#qiita-embed-content__b1bef422c78d0d19074711bb78a80172\\\" data-content=\\\"https%3A%2F%2Fraspida.com%2Finstall-chromium\\\" frameborder=\\\"0\\\" scrolling=\\\"no\\\" loading=\\\"lazy\\\" style=\\\"width:100%;\\\" height=\\\"29\\\">\\n</iframe>\\n</p>\\n<div class=\\\"code-frame\\\" data-lang=\\\"text\\\" data-sourcepos=\\\"15:1-19:3\\\"><div class=\\\"highlight\\\"><pre><code>$ sudo apt install chromium\\n$ which chromium\\n/usr/bin/chromium\\n</code></pre></div></div>\\n<p data-sourcepos=\\\"21:1-21:43\\\">\u5F8C\u3067Node.js\u306E\u30B3\u30FC\u30C9\u306B\u3044\u308C\u307E\u3059\u3002</p>\\n<h2 data-sourcepos=\\\"24:1-24:22\\\">\\n<span id=\\\"nodejs\u5074\u30B3\u30FC\u30C9\\\" class=\\\"fragment\\\"></span><a href=\\\"#nodejs%E5%81%B4%E3%82%B3%E3%83%BC%E3%83%89\\\"><i class=\\\"fa fa-link\\\"></i></a>Node.js\u5074\u30B3\u30FC\u30C9</h2>\\n<div class=\\\"code-frame\\\" data-lang=\\\"json\\\" data-sourcepos=\\\"27:1-51:3\\\"><div class=\\\"highlight\\\"><pre><code><span class=\\\"p\\\">{</span><span class=\\\"w\\\">\\n  </span><span class=\\\"nl\\\">\\\"name\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"s2\\\">\\\"piapp\\\"</span><span class=\\\"p\\\">,</span><span class=\\\"w\\\">\\n  </span><span class=\\\"nl\\\">\\\"version\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"s2\\\">\\\"1.0.0\\\"</span><span class=\\\"p\\\">,</span><span class=\\\"w\\\">\\n  </span><span class=\\\"nl\\\">\\\"description\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"s2\\\">\\\"\u30E9\u30BA\u30D9\u30EA\u30FC\u30D1\u30A4\u306B\u5229\u7528\u3059\u308B\u30A2\u30D7\u30EA\u30B1\u30FC\u30B7\u30E7\u30F3\\\"</span><span class=\\\"p\\\">,</span><span class=\\\"w\\\">\\n  </span><span class=\\\"nl\\\">\\\"main\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"s2\\\">\\\"index.js\\\"</span><span class=\\\"p\\\">,</span><span class=\\\"w\\\">\\n  </span><span class=\\\"nl\\\">\\\"scripts\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"p\\\">{</span><span class=\\\"w\\\">\\n    </span><span class=\\\"nl\\\">\\\"start\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"s2\\\">\\\"NODE_ENV=production forever start -vc ts-node src/index.ts\\\"</span><span class=\\\"p\\\">,</span><span class=\\\"w\\\">\\n    </span><span class=\\\"nl\\\">\\\"stop\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"s2\\\">\\\"NODE_ENV=production forever stop -vc ts-node src/index.ts\\\"</span><span class=\\\"p\\\">,</span><span class=\\\"w\\\">\\n    </span><span class=\\\"nl\\\">\\\"dev\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"s2\\\">\\\"nodemon\\\"</span><span class=\\\"w\\\">\\n  </span><span class=\\\"p\\\">},</span><span class=\\\"w\\\">\\n  </span><span class=\\\"nl\\\">\\\"keywords\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"p\\\">[],</span><span class=\\\"w\\\">\\n  </span><span class=\\\"nl\\\">\\\"author\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"s2\\\">\\\"\\\"</span><span class=\\\"p\\\">,</span><span class=\\\"w\\\">\\n  </span><span class=\\\"nl\\\">\\\"license\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"s2\\\">\\\"MIT\\\"</span><span class=\\\"p\\\">,</span><span class=\\\"w\\\">\\n  </span><span class=\\\"nl\\\">\\\"dependencies\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"p\\\">{</span><span class=\\\"w\\\">\\n    </span><span class=\\\"nl\\\">\\\"chrome-aws-lambda\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"s2\\\">\\\"^10.1.0\\\"</span><span class=\\\"p\\\">,</span><span class=\\\"w\\\">\\n    </span><span class=\\\"nl\\\">\\\"node-cron\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"s2\\\">\\\"^3.0.3\\\"</span><span class=\\\"p\\\">,</span><span class=\\\"w\\\">\\n    </span><span class=\\\"nl\\\">\\\"playwright-core\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"s2\\\">\\\"^1.40.1\\\"</span><span class=\\\"w\\\">\\n  </span><span class=\\\"p\\\">},</span><span class=\\\"w\\\">\\n  </span><span class=\\\"nl\\\">\\\"devDependencies\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"p\\\">{</span><span class=\\\"w\\\">\\n    </span><span class=\\\"nl\\\">\\\"@types/node\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"s2\\\">\\\"^20.10.4\\\"</span><span class=\\\"p\\\">,</span><span class=\\\"w\\\">\\n    </span><span class=\\\"nl\\\">\\\"@types/node-cron\\\"</span><span class=\\\"p\\\">:</span><span class=\\\"w\\\"> </span><span class=\\\"s2\\\">\\\"^3.0.11\\\"</span><span class=\\\"w\\\">\\n  </span><span class=\\\"p\\\">}</span><span class=\\\"w\\\">\\n</span><span class=\\\"p\\\">}</span><span class=\\\"w\\\">\\n</span></code></pre></div></div>\\n<p data-sourcepos=\\\"54:1-54:39\\\">\u3053\u306E\u8A18\u4E8B\u304C\u4E00\u756A\u53C2\u8003\u306B\u306A\u3063\u305F</p>\\n<p data-sourcepos=\\\"56:1-56:51\\\"><iframe id=\\\"qiita-embed-content__81f553752a6ba7054a00d678f7d1b122\\\" src=\\\"https://qiita.com/embed-contents/link-card#qiita-embed-content__81f553752a6ba7054a00d678f7d1b122\\\" data-content=\\\"https%3A%2F%2Fgithub.com%2Fmicrosoft%2Fplaywright%2Fissues%2F2834\\\" frameborder=\\\"0\\\" scrolling=\\\"no\\\" loading=\\\"lazy\\\" style=\\\"width:100%;\\\" height=\\\"29\\\">\\n</iframe>\\n</p>\\n<div class=\\\"code-frame\\\" data-lang=\\\"js\\\" data-sourcepos=\\\"59:1-106:3\\\"><div class=\\\"highlight\\\"><pre><code><span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">piChrome</span> <span class=\\\"o\\\">=</span> <span class=\\\"dl\\\">'</span><span class=\\\"s1\\\">/usr/bin/chromium</span><span class=\\\"dl\\\">'</span><span class=\\\"p\\\">;</span> <span class=\\\"c1\\\">// for Raspberry Pi, after like `$ sudo apt install chromium`</span>\\n<span class=\\\"k\\\">import</span> <span class=\\\"nx\\\">path</span> <span class=\\\"k\\\">from</span> <span class=\\\"dl\\\">'</span><span class=\\\"s1\\\">path</span><span class=\\\"dl\\\">'</span><span class=\\\"p\\\">;</span>\\n<span class=\\\"k\\\">import</span> <span class=\\\"nx\\\">fs</span> <span class=\\\"k\\\">from</span> <span class=\\\"dl\\\">'</span><span class=\\\"s1\\\">fs</span><span class=\\\"dl\\\">'</span><span class=\\\"p\\\">;</span>\\n<span class=\\\"k\\\">import</span> <span class=\\\"p\\\">{</span> <span class=\\\"nx\\\">chromium</span><span class=\\\"p\\\">,</span> <span class=\\\"nx\\\">devices</span><span class=\\\"p\\\">,</span> <span class=\\\"nx\\\">Page</span> <span class=\\\"p\\\">}</span> <span class=\\\"k\\\">from</span> <span class=\\\"dl\\\">'</span><span class=\\\"s1\\\">playwright-core</span><span class=\\\"dl\\\">'</span><span class=\\\"p\\\">;</span>\\n<span class=\\\"k\\\">import</span> <span class=\\\"p\\\">{</span> <span class=\\\"nx\\\">nowSecondString</span> <span class=\\\"p\\\">}</span> <span class=\\\"k\\\">from</span> <span class=\\\"dl\\\">'</span><span class=\\\"s1\\\">./utils</span><span class=\\\"dl\\\">'</span><span class=\\\"p\\\">;</span>\\n\\n<span class=\\\"cm\\\">/** Type\u306EKey\u3092String\u306EUnion\u578B\u306B\u3059\u308B */</span>\\n<span class=\\\"k\\\">export</span> <span class=\\\"nx\\\">type</span> <span class=\\\"nx\\\">NoStringIndex</span><span class=\\\"o\\\">&lt;</span><span class=\\\"nx\\\">T</span><span class=\\\"o\\\">&gt;</span> <span class=\\\"o\\\">=</span> <span class=\\\"p\\\">{</span> <span class=\\\"p\\\">[</span><span class=\\\"nx\\\">K</span> <span class=\\\"k\\\">in</span> <span class=\\\"nx\\\">keyof</span> <span class=\\\"nx\\\">T</span> <span class=\\\"k\\\">as</span> <span class=\\\"nx\\\">string</span> <span class=\\\"kd\\\">extends</span> <span class=\\\"nx\\\">K</span> <span class=\\\"p\\\">?</span> <span class=\\\"nx\\\">never</span> <span class=\\\"p\\\">:</span> <span class=\\\"nx\\\">K</span><span class=\\\"p\\\">]:</span> <span class=\\\"nx\\\">T</span><span class=\\\"p\\\">[</span><span class=\\\"nx\\\">K</span><span class=\\\"p\\\">]</span> <span class=\\\"p\\\">};</span>\\n<span class=\\\"k\\\">export</span> <span class=\\\"nx\\\">type</span> <span class=\\\"nx\\\">DeviceType</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">keyof</span> <span class=\\\"nx\\\">NoStringIndex</span><span class=\\\"o\\\">&lt;</span><span class=\\\"k\\\">typeof</span> <span class=\\\"nx\\\">devices</span><span class=\\\"o\\\">&gt;</span><span class=\\\"p\\\">;</span>\\n<span class=\\\"k\\\">export</span> <span class=\\\"nx\\\">type</span> <span class=\\\"nx\\\">DeviceDescriptor</span> <span class=\\\"o\\\">=</span> <span class=\\\"p\\\">(</span><span class=\\\"k\\\">typeof</span> <span class=\\\"nx\\\">devices</span><span class=\\\"p\\\">)[</span><span class=\\\"dl\\\">'</span><span class=\\\"s1\\\">Pixel 5</span><span class=\\\"dl\\\">'</span><span class=\\\"p\\\">];</span>\\n\\n<span class=\\\"k\\\">export</span> <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">playwrightScreenshotOnlyLocal</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">async </span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">page</span><span class=\\\"p\\\">:</span> <span class=\\\"nx\\\">Page</span><span class=\\\"p\\\">,</span> <span class=\\\"nx\\\">text</span><span class=\\\"p\\\">?:</span> <span class=\\\"nx\\\">string</span><span class=\\\"p\\\">)</span> <span class=\\\"o\\\">=&gt;</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"k\\\">if </span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">process</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">env</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">NODE_ENV</span> <span class=\\\"o\\\">===</span> <span class=\\\"dl\\\">'</span><span class=\\\"s1\\\">production</span><span class=\\\"dl\\\">'</span><span class=\\\"p\\\">)</span> <span class=\\\"k\\\">return</span><span class=\\\"p\\\">;</span>\\n  <span class=\\\"k\\\">await</span> <span class=\\\"nx\\\">page</span><span class=\\\"p\\\">.</span><span class=\\\"nf\\\">screenshot</span><span class=\\\"p\\\">({</span>\\n    <span class=\\\"na\\\">path</span><span class=\\\"p\\\">:</span> <span class=\\\"nx\\\">path</span><span class=\\\"p\\\">.</span><span class=\\\"nf\\\">resolve</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">__dirname</span><span class=\\\"p\\\">,</span> <span class=\\\"s2\\\">`../downloads/</span><span class=\\\"p\\\">${</span><span class=\\\"nf\\\">nowSecondString</span><span class=\\\"p\\\">()}</span><span class=\\\"s2\\\">.jpg`</span><span class=\\\"p\\\">),</span>\\n    <span class=\\\"na\\\">fullPage</span><span class=\\\"p\\\">:</span> <span class=\\\"kc\\\">false</span><span class=\\\"p\\\">,</span>\\n  <span class=\\\"p\\\">}).</span><span class=\\\"k\\\">catch</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">_</span> <span class=\\\"o\\\">=&gt;</span> <span class=\\\"kc\\\">undefined</span><span class=\\\"p\\\">);</span>\\n<span class=\\\"p\\\">};</span>\\n\\n<span class=\\\"k\\\">export</span> <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">googleCheck</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">async </span><span class=\\\"p\\\">()</span> <span class=\\\"o\\\">=&gt;</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">browser</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">await</span> <span class=\\\"nf\\\">createChromeBrowser</span><span class=\\\"p\\\">();</span>\\n\\n  <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">page</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">await</span> <span class=\\\"nx\\\">browser</span><span class=\\\"p\\\">.</span><span class=\\\"nf\\\">newPage</span><span class=\\\"p\\\">();</span>\\n  <span class=\\\"k\\\">await</span> <span class=\\\"nx\\\">page</span><span class=\\\"p\\\">.</span><span class=\\\"nf\\\">goto</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">'</span><span class=\\\"s1\\\">https://www.google.com/search?q=\u65B0\u5BBF\u306E\u5929\u6C17</span><span class=\\\"dl\\\">'</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"nx\\\">console</span><span class=\\\"p\\\">.</span><span class=\\\"nf\\\">log</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">'</span><span class=\\\"s1\\\">await page.title(): </span><span class=\\\"dl\\\">'</span><span class=\\\"p\\\">,</span> <span class=\\\"k\\\">await</span> <span class=\\\"nx\\\">page</span><span class=\\\"p\\\">.</span><span class=\\\"nf\\\">title</span><span class=\\\"p\\\">());</span>\\n\\n  <span class=\\\"k\\\">await</span> <span class=\\\"nf\\\">playwrightScreenshotOnlyLocal</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">page</span><span class=\\\"p\\\">)</span>\\n\\n  <span class=\\\"k\\\">return</span> <span class=\\\"k\\\">await</span> <span class=\\\"nx\\\">browser</span><span class=\\\"p\\\">.</span><span class=\\\"nf\\\">close</span><span class=\\\"p\\\">();</span>\\n<span class=\\\"p\\\">};</span>\\n\\n<span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">defaultOption</span> <span class=\\\"o\\\">=</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"na\\\">headless</span><span class=\\\"p\\\">:</span> <span class=\\\"kc\\\">true</span><span class=\\\"p\\\">,</span>\\n  <span class=\\\"na\\\">slowMo</span><span class=\\\"p\\\">:</span> <span class=\\\"mi\\\">333</span><span class=\\\"p\\\">,</span>\\n  <span class=\\\"na\\\">timeout</span><span class=\\\"p\\\">:</span> <span class=\\\"mi\\\">150000</span><span class=\\\"p\\\">,</span> <span class=\\\"c1\\\">// 120 sec</span>\\n  <span class=\\\"na\\\">args</span><span class=\\\"p\\\">:</span> <span class=\\\"p\\\">[</span>\\n    <span class=\\\"dl\\\">'</span><span class=\\\"s1\\\">--lang=ja</span><span class=\\\"dl\\\">'</span><span class=\\\"p\\\">,</span> <span class=\\\"c1\\\">// \u65E5\u672C\u8A9E\u5BFE\u5FDC</span>\\n  <span class=\\\"p\\\">],</span>\\n<span class=\\\"p\\\">};</span>\\n\\n<span class=\\\"k\\\">export</span> <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">createChromeBrowser</span> <span class=\\\"o\\\">=</span> <span class=\\\"k\\\">async </span><span class=\\\"p\\\">()</span> <span class=\\\"o\\\">=&gt;</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"kd\\\">let</span> <span class=\\\"na\\\">executablePath</span><span class=\\\"p\\\">:</span> <span class=\\\"nx\\\">string</span> <span class=\\\"o\\\">|</span> <span class=\\\"kc\\\">undefined</span><span class=\\\"p\\\">;</span>\\n  <span class=\\\"nx\\\">executablePath</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">fs</span><span class=\\\"p\\\">.</span><span class=\\\"nf\\\">existsSync</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">piChrome</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">?</span> <span class=\\\"nx\\\">piChrome</span> <span class=\\\"p\\\">:</span> <span class=\\\"kc\\\">undefined</span><span class=\\\"p\\\">;</span>\\n  <span class=\\\"k\\\">if </span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">executablePath</span><span class=\\\"p\\\">)</span> <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">chromium</span><span class=\\\"p\\\">.</span><span class=\\\"nf\\\">launch</span><span class=\\\"p\\\">({</span> <span class=\\\"nx\\\">executablePath</span><span class=\\\"p\\\">,</span> <span class=\\\"p\\\">...</span><span class=\\\"nx\\\">defaultOption</span> <span class=\\\"p\\\">});</span>\\n  <span class=\\\"k\\\">return</span> <span class=\\\"nx\\\">chromium</span><span class=\\\"p\\\">.</span><span class=\\\"nf\\\">launch</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">defaultOption</span><span class=\\\"p\\\">);</span>\\n<span class=\\\"p\\\">};</span>\\n</code></pre></div></div>\\n<p data-sourcepos=\\\"109:1-109:60\\\">\u3060\u3044\u305F\u3044\u3053\u3093\u306A\u611F\u3058\u306E\u30B3\u30FC\u30C9\u3067\u52D5\u304D\u307E\u3057\u305F\u3002</p>\\n<p data-sourcepos=\\\"112:1-112:230\\\">MacOS\u3067\u958B\u767A\u3057\u3066\u3044\u308B\u3068\u304D\u306F <code>/usr/bin/chromium</code> \u306Bchromium\u304C\u306A\u304F <code>npx install playwrite</code> \u3067\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3057\u305F\u5B9F\u4F53\u3092\u52D5\u304B\u3057\u3066\u3001\u30E9\u30BA\u30D9\u30EA\u30FC\u30D1\u30A4\u306E\u3068\u304D\u306F <code>/usr/bin/chromium</code> \u3067\u52D5\u304B\u3057\u307E\u3057\u305F\u3002</p>\\n<p data-sourcepos=\\\"114:1-115:133\\\">\u3053\u308C\u3067\u6BCE\u65E5\u671D7\u6642\u306B\u65B0\u5BBF\u533A\u306E\u5929\u6C17\u3092\u30B9\u30AF\u30B7\u30E7\u3057\u3066\u4FDD\u5B58\u3059\u308B\u3068\u3044\u3046\u52D5\u4F5C\u3092 node-cron \u3067\u8D70\u3089\u305B\u3089\u308C\u308B\u3088\u3046\u306B\u306A\u308A\u307E\u3057\u305F\u3002<br>\\n<a href=\\\"https://camo.qiitausercontent.com/a780fd97e59dfc48e5fb492289ccb7c38cee083b/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e61702d6e6f727468656173742d312e616d617a6f6e6177732e636f6d2f302f3131323932392f35643934333836362d373265642d316431342d366635342d3931666563383735376533372e6a706567\\\" target=\\\"_blank\\\" rel=\\\"nofollow noopener\\\"><img src=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F5d943866-72ed-1d14-6f54-91fec8757e37.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;s=8a8d6da0a7a9209df670eae993f2eea1\\\" alt=\\\"20231216_2226794.jpg\\\" data-canonical-src=\\\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/5d943866-72ed-1d14-6f54-91fec8757e37.jpeg\\\" srcset=\\\"https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F112929%2F5d943866-72ed-1d14-6f54-91fec8757e37.jpeg?ixlib=rb-4.0.0&amp;auto=format&amp;gif-q=60&amp;q=75&amp;w=1400&amp;fit=max&amp;s=9d4904c1b299da310409729222b76604 1x\\\" loading=\\\"lazy\\\"></a></p>\\n\",\"body\":\"\\n\\n\u30E9\u30BA\u30D9\u30EA\u30FC\u30D1\u30A4\u3060\u3068PlayWrite\u5BFE\u5FDC\u3057\u3066\u306A\u3055\u305D\u3046\u3060\u3063\u305F\u3051\u3069\u8272\u3005\u3084\u3063\u305F\u3089\u52D5\u3044\u305F\\n\\nhttps://github.com/microsoft/playwright/issues/4984\\n\\n\\n## \u3084\u308A\u65B9\\n\\n### chromium\u306E\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\\n\\n\\nhttps://raspida.com/install-chromium\\n\\n```\\n$ sudo apt install chromium\\n$ which chromium\\n/usr/bin/chromium\\n```\\n\\n\u5F8C\u3067Node.js\u306E\u30B3\u30FC\u30C9\u306B\u3044\u308C\u307E\u3059\u3002\\n\\n\\n## Node.js\u5074\u30B3\u30FC\u30C9\\n\\n\\n```json\\n{\\n  \\\"name\\\": \\\"piapp\\\",\\n  \\\"version\\\": \\\"1.0.0\\\",\\n  \\\"description\\\": \\\"\u30E9\u30BA\u30D9\u30EA\u30FC\u30D1\u30A4\u306B\u5229\u7528\u3059\u308B\u30A2\u30D7\u30EA\u30B1\u30FC\u30B7\u30E7\u30F3\\\",\\n  \\\"main\\\": \\\"index.js\\\",\\n  \\\"scripts\\\": {\\n    \\\"start\\\": \\\"NODE_ENV=production forever start -vc ts-node src/index.ts\\\",\\n    \\\"stop\\\": \\\"NODE_ENV=production forever stop -vc ts-node src/index.ts\\\",\\n    \\\"dev\\\": \\\"nodemon\\\"\\n  },\\n  \\\"keywords\\\": [],\\n  \\\"author\\\": \\\"\\\",\\n  \\\"license\\\": \\\"MIT\\\",\\n  \\\"dependencies\\\": {\\n    \\\"chrome-aws-lambda\\\": \\\"^10.1.0\\\",\\n    \\\"node-cron\\\": \\\"^3.0.3\\\",\\n    \\\"playwright-core\\\": \\\"^1.40.1\\\"\\n  },\\n  \\\"devDependencies\\\": {\\n    \\\"@types/node\\\": \\\"^20.10.4\\\",\\n    \\\"@types/node-cron\\\": \\\"^3.0.11\\\"\\n  }\\n}\\n```\\n\\n\\n\u3053\u306E\u8A18\u4E8B\u304C\u4E00\u756A\u53C2\u8003\u306B\u306A\u3063\u305F\\n\\nhttps://github.com/microsoft/playwright/issues/2834\\n\\n\\n```js\\nconst piChrome = '/usr/bin/chromium'; // for Raspberry Pi, after like `$ sudo apt install chromium`\\nimport path from 'path';\\nimport fs from 'fs';\\nimport { chromium, devices, Page } from 'playwright-core';\\nimport { nowSecondString } from './utils';\\n\\n/** Type\u306EKey\u3092String\u306EUnion\u578B\u306B\u3059\u308B */\\nexport type NoStringIndex<T> = { [K in keyof T as string extends K ? never : K]: T[K] };\\nexport type DeviceType = keyof NoStringIndex<typeof devices>;\\nexport type DeviceDescriptor = (typeof devices)['Pixel 5'];\\n\\nexport const playwrightScreenshotOnlyLocal = async (page: Page, text?: string) => {\\n  if (process.env.NODE_ENV === 'production') return;\\n  await page.screenshot({\\n    path: path.resolve(__dirname, `../downloads/${nowSecondString()}.jpg`),\\n    fullPage: false,\\n  }).catch(_ => undefined);\\n};\\n\\nexport const googleCheck = async () => {\\n  const browser = await createChromeBrowser();\\n\\n  const page = await browser.newPage();\\n  await page.goto('https://www.google.com/search?q=\u65B0\u5BBF\u306E\u5929\u6C17');\\n  console.log('await page.title(): ', await page.title());\\n\\n  await playwrightScreenshotOnlyLocal(page)\\n\\n  return await browser.close();\\n};\\n\\nconst defaultOption = {\\n  headless: true,\\n  slowMo: 333,\\n  timeout: 150000, // 120 sec\\n  args: [\\n    '--lang=ja', // \u65E5\u672C\u8A9E\u5BFE\u5FDC\\n  ],\\n};\\n\\nexport const createChromeBrowser = async () => {\\n  let executablePath: string | undefined;\\n  executablePath = fs.existsSync(piChrome) ? piChrome : undefined;\\n  if (executablePath) return chromium.launch({ executablePath, ...defaultOption });\\n  return chromium.launch(defaultOption);\\n};\\n```\\n\\n\\n\u3060\u3044\u305F\u3044\u3053\u3093\u306A\u611F\u3058\u306E\u30B3\u30FC\u30C9\u3067\u52D5\u304D\u307E\u3057\u305F\u3002\\n\\n\\nMacOS\u3067\u958B\u767A\u3057\u3066\u3044\u308B\u3068\u304D\u306F `/usr/bin/chromium` \u306Bchromium\u304C\u306A\u304F `npx install playwrite` \u3067\u30A4\u30F3\u30B9\u30C8\u30FC\u30EB\u3057\u305F\u5B9F\u4F53\u3092\u52D5\u304B\u3057\u3066\u3001\u30E9\u30BA\u30D9\u30EA\u30FC\u30D1\u30A4\u306E\u3068\u304D\u306F `/usr/bin/chromium` \u3067\u52D5\u304B\u3057\u307E\u3057\u305F\u3002\\n\\n\u3053\u308C\u3067\u6BCE\u65E5\u671D7\u6642\u306B\u65B0\u5BBF\u533A\u306E\u5929\u6C17\u3092\u30B9\u30AF\u30B7\u30E7\u3057\u3066\u4FDD\u5B58\u3059\u308B\u3068\u3044\u3046\u52D5\u4F5C\u3092 node-cron \u3067\u8D70\u3089\u305B\u3089\u308C\u308B\u3088\u3046\u306B\u306A\u308A\u307E\u3057\u305F\u3002\\n![20231216_2226794.jpg](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/5d943866-72ed-1d14-6f54-91fec8757e37.jpeg)\\n\\n\\n\\n\\n\\n\\n\",\"coediting\":false,\"comments_count\":0,\"created_at\":\"2023-12-16T22:46:26+09:00\",\"group\":null,\"id\":\"9b564e65d9c0a19bf2e0\",\"likes_count\":1,\"private\":false,\"reactions_count\":0,\"stocks_count\":0,\"tags\":[{\"name\":\"JavaScript\",\"versions\":[]},{\"name\":\"Node.js\",\"versions\":[]},{\"name\":\"Chrome\",\"versions\":[]},{\"name\":\"TypeScript\",\"versions\":[]},{\"name\":\"\u30E9\u30BA\u30D1\u30A4\",\"versions\":[]}],\"title\":\"\u30E9\u30BA\u30D9\u30EA\u30FC\u30D1\u30A4\u3067Playwright\u3092\u4F7F\u3044\u691C\u7D22\u306E\u30B9\u30AF\u30EA\u30FC\u30F3\u30B7\u30E7\u30C3\u30C8\u3092\u53D6\u308A\u307E\u304F\u3063\u305F\u8A71\",\"updated_at\":\"2023-12-16T22:47:23+09:00\",\"url\":\"https://qiita.com/ykhirao/items/9b564e65d9c0a19bf2e0\",\"user\":{\"description\":\"Web Developer From 2016.\\r\\nPHP/Laravel && React/TypeScript/Node.js\\r\\n\\r\\n\u696D\u52D9\u59D4\u8A17\u306E\u4F9D\u983C\u3068\u304B\u306FWantedly\u3068\u304B\u304B\u3089\u3067\u304A\u9858\u3044\u3057\u307E\u3059\uFF01\",\"facebook_id\":\"\",\"followees_count\":39,\"followers_count\":100,\"github_login_name\":\"ykhirao\",\"id\":\"ykhirao\",\"items_count\":82,\"linkedin_id\":\"\",\"location\":\"Tokyo, Japan\",\"name\":\"yk\",\"organization\":\"\",\"permanent_id\":112929,\"profile_image_url\":\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/profile-images/1639030792\",\"team_only\":false,\"twitter_screen_name\":\"ykhirao\",\"website_url\":\"https://www.wantedly.com/id/ykhirao\"},\"page_views_count\":null,\"team_membership\":null,\"organization_url_name\":null,\"slide\":false}},\"path\":\"posts/9b564e65d9c0a19bf2e0\",\"sharedData\":{},\"siteData\":{\"updatedAt\":\"2024/01/08\"}}");</script><script defer="" type="text/javascript" src="/templates/styles.ce528c12.js"></script><script defer="" type="text/javascript" src="/templates/vendors~main.991a9778.js"></script><script defer="" type="text/javascript" src="/main.e4c894d8.js"></script></body></html>