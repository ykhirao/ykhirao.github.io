<!DOCTYPE html><html lang="en"><head><meta name="generator" content="React Static"/><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, shrink-to-fit=no"/><link rel="preload" as="script" href="/templates/styles.8ede5912.js"/><link rel="preload" as="script" href="/templates/vendors~main.50f3f31b.js"/><link rel="preload" as="script" href="/main.62ec0c15.js"/><link rel="preload" as="style" href="/styles.1048b661.css"/><link rel="stylesheet" href="/styles.1048b661.css"/><link rel="shortcut icon" href="/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="48x48" href="/favicon-48x48.png"/><link rel="manifest" href="/manifest.json"/><meta name="mobile-web-app-capable" content="yes"/><meta name="theme-color" content="#fff"/><meta name="application-name"/><link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png"/><link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png"/><link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png"/><link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png"/><link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png"/><link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png"/><link rel="apple-touch-icon" sizes="167x167" href="/apple-touch-icon-167x167.png"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png"/><link rel="apple-touch-icon" sizes="1024x1024" href="/apple-touch-icon-1024x1024.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/><meta name="apple-mobile-web-app-title"/><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-640x1136.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-750x1334.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-828x1792.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1125x2436.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2208.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="/apple-touch-startup-image-1242x2688.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1536x2048.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2224.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1668x2388.png"/><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-2048x2732.png"/><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="/apple-touch-startup-image-1620x2160.png"/><link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1136x640.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1334x750.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-1792x828.png"/><link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2436x1125.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2208x1242.png"/><link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="/apple-touch-startup-image-2688x1242.png"/><link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2048x1536.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2224x1668.png"/><link rel="apple-touch-startup-image" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2388x1668.png"/><link rel="apple-touch-startup-image" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2732x2048.png"/><link rel="apple-touch-startup-image" media="(device-width: 810px) and (device-height: 1080px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="/apple-touch-startup-image-2160x1620.png"/><link rel="icon" type="image/png" sizes="228x228" href="/coast-228x228.png"/><meta name="msapplication-TileColor" content="#fff"/><meta name="msapplication-TileImage" content="/mstile-144x144.png"/><meta name="msapplication-config" content="/browserconfig.xml"/><link rel="yandex-tableau-widget" href="/yandex-browser-manifest.json"/></head><body><div id="root"><div style="outline:none" tabindex="-1"><nav class="navbar is-dark is-fixed-top" role="navigation" aria-label="main navigation"><div class="container"><div class="navbar-brand"><a class="navbar-item" href="/">Home</a><a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false"><span aria-hidden="true"></span><span aria-hidden="true"></span><span aria-hidden="true"></span></a></div><div id="navbarBasicExample" class="navbar-menu "><div class="navbar-start"><a class="navbar-item" href="/posts">Posts</a><a class="navbar-item" href="/events">Events</a><a class="navbar-item" href="/github">GitHub</a></div></div></div></nav><div class="container"><div class="is-primary" style="padding:4.5rem 0.5rem"><div style="outline:none" tabindex="-1"><div><a href="/posts">&lt;<!-- --> Back</a><br/><h3>Google Driveで共有設定が適切に設定されているかドライブのファイル・フォルダを一覧で調べる方法</h3><article class="md-body">
<h1>
<span id="google-driveで共有設定が適切に設定されているかドライブのファイルフォルダを一覧で調べる方法" class="fragment"></span><a href="#google-drive%E3%81%A7%E5%85%B1%E6%9C%89%E8%A8%AD%E5%AE%9A%E3%81%8C%E9%81%A9%E5%88%87%E3%81%AB%E8%A8%AD%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%82%8B%E3%81%8B%E3%83%89%E3%83%A9%E3%82%A4%E3%83%96%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%83%95%E3%82%A9%E3%83%AB%E3%83%80%E3%82%92%E4%B8%80%E8%A6%A7%E3%81%A7%E8%AA%BF%E3%81%B9%E3%82%8B%E6%96%B9%E6%B3%95"><i class="fa fa-link"></i></a>Google Driveで共有設定が適切に設定されているかドライブのファイル・フォルダを一覧で調べる方法</h1>

<p>30分くらいで作ったやつを貼っておく。<br>
かんたんなスクリプトなのでもっと良さそうな改良版あればコメント欄なり、自分で記事お願いします！</p>

<p>「2021年１月６日、福岡県の新型コロナウイルス感染症陽性者に関する個人情報の漏えい」がありましたが、この漏洩事案がGoogle Driveによるものだとは存じ上げないのですが、SaaSのドライブを利用するユーザーが増えてくると（絶対数が増える）と、共有設定を間違えるニュースが増えてくると思います。</p>

<p>なのでDriveのファイルとフォルダが適切に共有設定されているか確認しましょう、ってお話。</p>

<h2>
<span id="データ" class="fragment"></span><a href="#%E3%83%87%E3%83%BC%E3%82%BF"><i class="fa fa-link"></i></a>データ</h2>

<div class="code-frame" data-lang="js"><div class="highlight"><pre><code><span class="kd">const</span> <span class="nx">results</span> <span class="o">=</span> <span class="p">[];</span>

<span class="kd">function</span> <span class="nx">doGet</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">writeInforInFolder</span><span class="p">(</span><span class="nx">DriveApp</span><span class="p">.</span><span class="nx">getRootFolder</span><span class="p">());</span>
  <span class="kd">const</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">results</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="se">\n</span><span class="dl">"</span><span class="p">);</span>
  <span class="nx">Logger</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>

  <span class="c1">// Webアプリとして導入するならこんな感じ？</span>
  <span class="c1">// return HtmlService.createHtmlOutput(text);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">writeInforInFolder</span><span class="p">(</span><span class="nx">folder</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">folder</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

  <span class="c1">// フォルダ以下ファイルをすべて取得</span>
  <span class="kd">const</span> <span class="nx">files</span> <span class="o">=</span> <span class="nx">folder</span><span class="p">.</span><span class="nx">getFiles</span><span class="p">();</span>
  <span class="k">while</span><span class="p">(</span><span class="nx">files</span><span class="p">.</span><span class="nx">hasNext</span><span class="p">())</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">file</span> <span class="o">=</span> <span class="nx">files</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span>
    <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">`FILE,</span><span class="p">${</span><span class="nx">file</span><span class="p">.</span><span class="nx">getName</span><span class="p">()}</span><span class="s2">,</span><span class="p">${</span><span class="nx">file</span><span class="p">.</span><span class="nx">getSharingAccess</span><span class="p">()}</span><span class="s2">,</span><span class="p">${</span><span class="nx">file</span><span class="p">.</span><span class="nx">getUrl</span><span class="p">()}</span><span class="s2">`</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="c1">// フォルダ配下のフォルダを取得</span>
  <span class="kd">const</span> <span class="nx">folders</span> <span class="o">=</span> <span class="nx">folder</span><span class="p">.</span><span class="nx">getFolders</span><span class="p">();</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">folders</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
  <span class="k">while</span><span class="p">(</span><span class="nx">folders</span><span class="p">.</span><span class="nx">hasNext</span><span class="p">())</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">folder</span> <span class="o">=</span> <span class="nx">folders</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span>
    <span class="nx">results</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">`FOLDER,</span><span class="p">${</span><span class="nx">folder</span><span class="p">.</span><span class="nx">getName</span><span class="p">()}</span><span class="s2">,</span><span class="p">${</span><span class="nx">folder</span><span class="p">.</span><span class="nx">getSharingAccess</span><span class="p">()}</span><span class="s2">,</span><span class="p">${</span><span class="nx">folder</span><span class="p">.</span><span class="nx">getUrl</span><span class="p">()}</span><span class="s2">`</span><span class="p">)</span>
    <span class="c1">// 更に下のフォルダを検索するため再帰処理</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">writeInforInFolder</span><span class="p">(</span><span class="nx">folder</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
<li>権限を取得とかもろもろの許可が必要</li>
</ul>

<p>CSV形式のテキストで出力されるので、3列目がANYONEとかANYONE_WITH_LINKになっているのは確認したほうがいいと思います。</p>

<div class="code-frame" data-lang="csvs"><div class="highlight"><pre><code><span class="c1">// 出力例</span>
<span class="c1">// 長すぎるとエラーでるので、</span>
<span class="c1">// return HtmlService.createHtmlOutput(text);のとこコメントアウト外してWebで見たほうがいいかも</span>
<span class="k">Logging</span> <span class="k">output</span> <span class="k">too</span> <span class="k">large</span><span class="err">.</span> <span class="k">Truncating</span> <span class="k">output</span><span class="err">.</span> 

<span class="c1">// folderとfile,名前,url</span>
<span class="k">FOLDER</span><span class="p">,</span><span class="k">test</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="nv">https:</span><span class="c1">//script.google.com/d/sample</span>
<span class="k">FILE</span><span class="p">,</span><span class="err">無題のプロジェクト</span><span class="p">,</span><span class="k">PRIVATE</span><span class="p">,</span><span class="nv">https:</span><span class="c1">//script.google.com/d/1i</span>
</code></pre></div></div>

<p>権限は以下を確認してください。<br>
<a href="https://developers.google.com/apps-script/reference/drive/access" class="autolink" rel="nofollow noopener" target="_blank">https://developers.google.com/apps-script/reference/drive/access</a></p>

<ul>
<li>ANYONE (誰でも見れる)</li>
<li>ANYONE_WITH_LINK(リンク知っている人全員)</li>
<li>DOMAIN (自社のGsuiteワークスペースの人のみ)</li>
<li>DOMAIN_WITH_LINK(自社のワークスペースの人でリンク知っている人のみ)</li>
<li>PRIVATE (自分のみ)</li>
</ul>

<p>基本的に機密情報は、ANYONE,ANYONE_WITH_LINKだと合うと、特に気密性高い情報はDOMAINもDOMAIN_WITH_LINKもだめかも。<br>
気密性の高いファイルは、PRIVATEにして、必要な人だけ個別で追加していくスタイルがよいかと。</p>
</article></div></div></div></div><footer class="footer"><div class="content has-text-centered"><p>This web site was created by ykhirao using react-static. <a href="https://github.com/ykhirao/ykhirao.github.io" target="_blank" rel="noopener noreferrer">Here</a> is the link to the GitHub repository.</p><p>© 2021 ykhirao</p></div></footer></div></div><script type="text/javascript">window.__routeInfo = JSON.parse("{\"template\":\"__react_static_root__/src/components/QiitaPost\",\"sharedHashesByProp\":{},\"data\":{\"post\":{\"rendered_body\":\"\\n<h1>\\n<span id=\\\"google-drive\u3067\u5171\u6709\u8A2D\u5B9A\u304C\u9069\u5207\u306B\u8A2D\u5B9A\u3055\u308C\u3066\u3044\u308B\u304B\u30C9\u30E9\u30A4\u30D6\u306E\u30D5\u30A1\u30A4\u30EB\u30D5\u30A9\u30EB\u30C0\u3092\u4E00\u89A7\u3067\u8ABF\u3079\u308B\u65B9\u6CD5\\\" class=\\\"fragment\\\"></span><a href=\\\"#google-drive%E3%81%A7%E5%85%B1%E6%9C%89%E8%A8%AD%E5%AE%9A%E3%81%8C%E9%81%A9%E5%88%87%E3%81%AB%E8%A8%AD%E5%AE%9A%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%82%8B%E3%81%8B%E3%83%89%E3%83%A9%E3%82%A4%E3%83%96%E3%81%AE%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%83%95%E3%82%A9%E3%83%AB%E3%83%80%E3%82%92%E4%B8%80%E8%A6%A7%E3%81%A7%E8%AA%BF%E3%81%B9%E3%82%8B%E6%96%B9%E6%B3%95\\\"><i class=\\\"fa fa-link\\\"></i></a>Google Drive\u3067\u5171\u6709\u8A2D\u5B9A\u304C\u9069\u5207\u306B\u8A2D\u5B9A\u3055\u308C\u3066\u3044\u308B\u304B\u30C9\u30E9\u30A4\u30D6\u306E\u30D5\u30A1\u30A4\u30EB\u30FB\u30D5\u30A9\u30EB\u30C0\u3092\u4E00\u89A7\u3067\u8ABF\u3079\u308B\u65B9\u6CD5</h1>\\n\\n<p>30\u5206\u304F\u3089\u3044\u3067\u4F5C\u3063\u305F\u3084\u3064\u3092\u8CBC\u3063\u3066\u304A\u304F\u3002<br>\\n\u304B\u3093\u305F\u3093\u306A\u30B9\u30AF\u30EA\u30D7\u30C8\u306A\u306E\u3067\u3082\u3063\u3068\u826F\u3055\u305D\u3046\u306A\u6539\u826F\u7248\u3042\u308C\u3070\u30B3\u30E1\u30F3\u30C8\u6B04\u306A\u308A\u3001\u81EA\u5206\u3067\u8A18\u4E8B\u304A\u9858\u3044\u3057\u307E\u3059\uFF01</p>\\n\\n<p>\u300C2021\u5E74\uFF11\u6708\uFF16\u65E5\u3001\u798F\u5CA1\u770C\u306E\u65B0\u578B\u30B3\u30ED\u30CA\u30A6\u30A4\u30EB\u30B9\u611F\u67D3\u75C7\u967D\u6027\u8005\u306B\u95A2\u3059\u308B\u500B\u4EBA\u60C5\u5831\u306E\u6F0F\u3048\u3044\u300D\u304C\u3042\u308A\u307E\u3057\u305F\u304C\u3001\u3053\u306E\u6F0F\u6D29\u4E8B\u6848\u304CGoogle Drive\u306B\u3088\u308B\u3082\u306E\u3060\u3068\u306F\u5B58\u3058\u4E0A\u3052\u306A\u3044\u306E\u3067\u3059\u304C\u3001SaaS\u306E\u30C9\u30E9\u30A4\u30D6\u3092\u5229\u7528\u3059\u308B\u30E6\u30FC\u30B6\u30FC\u304C\u5897\u3048\u3066\u304F\u308B\u3068\uFF08\u7D76\u5BFE\u6570\u304C\u5897\u3048\u308B\uFF09\u3068\u3001\u5171\u6709\u8A2D\u5B9A\u3092\u9593\u9055\u3048\u308B\u30CB\u30E5\u30FC\u30B9\u304C\u5897\u3048\u3066\u304F\u308B\u3068\u601D\u3044\u307E\u3059\u3002</p>\\n\\n<p>\u306A\u306E\u3067Drive\u306E\u30D5\u30A1\u30A4\u30EB\u3068\u30D5\u30A9\u30EB\u30C0\u304C\u9069\u5207\u306B\u5171\u6709\u8A2D\u5B9A\u3055\u308C\u3066\u3044\u308B\u304B\u78BA\u8A8D\u3057\u307E\u3057\u3087\u3046\u3001\u3063\u3066\u304A\u8A71\u3002</p>\\n\\n<h2>\\n<span id=\\\"\u30C7\u30FC\u30BF\\\" class=\\\"fragment\\\"></span><a href=\\\"#%E3%83%87%E3%83%BC%E3%82%BF\\\"><i class=\\\"fa fa-link\\\"></i></a>\u30C7\u30FC\u30BF</h2>\\n\\n<div class=\\\"code-frame\\\" data-lang=\\\"js\\\"><div class=\\\"highlight\\\"><pre><code><span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">results</span> <span class=\\\"o\\\">=</span> <span class=\\\"p\\\">[];</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">doGet</span><span class=\\\"p\\\">()</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"nx\\\">writeInforInFolder</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">DriveApp</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getRootFolder</span><span class=\\\"p\\\">());</span>\\n  <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">text</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">results</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">join</span><span class=\\\"p\\\">(</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"se\\\">\\\\n</span><span class=\\\"dl\\\">\\\"</span><span class=\\\"p\\\">);</span>\\n  <span class=\\\"nx\\\">Logger</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">log</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">text</span><span class=\\\"p\\\">);</span>\\n\\n  <span class=\\\"c1\\\">// Web\u30A2\u30D7\u30EA\u3068\u3057\u3066\u5C0E\u5165\u3059\u308B\u306A\u3089\u3053\u3093\u306A\u611F\u3058\uFF1F</span>\\n  <span class=\\\"c1\\\">// return HtmlService.createHtmlOutput(text);</span>\\n<span class=\\\"p\\\">}</span>\\n\\n<span class=\\\"kd\\\">function</span> <span class=\\\"nx\\\">writeInforInFolder</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">folder</span><span class=\\\"p\\\">)</span> <span class=\\\"p\\\">{</span>\\n  <span class=\\\"k\\\">if</span><span class=\\\"p\\\">(</span><span class=\\\"o\\\">!</span><span class=\\\"nx\\\">folder</span><span class=\\\"p\\\">)</span> <span class=\\\"k\\\">return</span><span class=\\\"p\\\">;</span>\\n\\n  <span class=\\\"c1\\\">// \u30D5\u30A9\u30EB\u30C0\u4EE5\u4E0B\u30D5\u30A1\u30A4\u30EB\u3092\u3059\u3079\u3066\u53D6\u5F97</span>\\n  <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">files</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">folder</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getFiles</span><span class=\\\"p\\\">();</span>\\n  <span class=\\\"k\\\">while</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">files</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">hasNext</span><span class=\\\"p\\\">())</span> <span class=\\\"p\\\">{</span>\\n    <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">file</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">files</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">next</span><span class=\\\"p\\\">();</span>\\n    <span class=\\\"nx\\\">results</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">push</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">`FILE,</span><span class=\\\"p\\\">${</span><span class=\\\"nx\\\">file</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getName</span><span class=\\\"p\\\">()}</span><span class=\\\"s2\\\">,</span><span class=\\\"p\\\">${</span><span class=\\\"nx\\\">file</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getSharingAccess</span><span class=\\\"p\\\">()}</span><span class=\\\"s2\\\">,</span><span class=\\\"p\\\">${</span><span class=\\\"nx\\\">file</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getUrl</span><span class=\\\"p\\\">()}</span><span class=\\\"s2\\\">`</span><span class=\\\"p\\\">)</span>\\n  <span class=\\\"p\\\">}</span>\\n\\n  <span class=\\\"c1\\\">// \u30D5\u30A9\u30EB\u30C0\u914D\u4E0B\u306E\u30D5\u30A9\u30EB\u30C0\u3092\u53D6\u5F97</span>\\n  <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">folders</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">folder</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getFolders</span><span class=\\\"p\\\">();</span>\\n  <span class=\\\"k\\\">if</span> <span class=\\\"p\\\">(</span><span class=\\\"o\\\">!</span><span class=\\\"nx\\\">folders</span><span class=\\\"p\\\">)</span> <span class=\\\"k\\\">return</span><span class=\\\"p\\\">;</span>\\n  <span class=\\\"k\\\">while</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">folders</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">hasNext</span><span class=\\\"p\\\">())</span> <span class=\\\"p\\\">{</span>\\n    <span class=\\\"kd\\\">const</span> <span class=\\\"nx\\\">folder</span> <span class=\\\"o\\\">=</span> <span class=\\\"nx\\\">folders</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">next</span><span class=\\\"p\\\">();</span>\\n    <span class=\\\"nx\\\">results</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">push</span><span class=\\\"p\\\">(</span><span class=\\\"s2\\\">`FOLDER,</span><span class=\\\"p\\\">${</span><span class=\\\"nx\\\">folder</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getName</span><span class=\\\"p\\\">()}</span><span class=\\\"s2\\\">,</span><span class=\\\"p\\\">${</span><span class=\\\"nx\\\">folder</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getSharingAccess</span><span class=\\\"p\\\">()}</span><span class=\\\"s2\\\">,</span><span class=\\\"p\\\">${</span><span class=\\\"nx\\\">folder</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">getUrl</span><span class=\\\"p\\\">()}</span><span class=\\\"s2\\\">`</span><span class=\\\"p\\\">)</span>\\n    <span class=\\\"c1\\\">// \u66F4\u306B\u4E0B\u306E\u30D5\u30A9\u30EB\u30C0\u3092\u691C\u7D22\u3059\u308B\u305F\u3081\u518D\u5E30\u51E6\u7406</span>\\n    <span class=\\\"k\\\">this</span><span class=\\\"p\\\">.</span><span class=\\\"nx\\\">writeInforInFolder</span><span class=\\\"p\\\">(</span><span class=\\\"nx\\\">folder</span><span class=\\\"p\\\">)</span>\\n  <span class=\\\"p\\\">}</span>\\n<span class=\\\"p\\\">}</span>\\n</code></pre></div></div>\\n\\n<ul>\\n<li>\u6A29\u9650\u3092\u53D6\u5F97\u3068\u304B\u3082\u308D\u3082\u308D\u306E\u8A31\u53EF\u304C\u5FC5\u8981</li>\\n</ul>\\n\\n<p>CSV\u5F62\u5F0F\u306E\u30C6\u30AD\u30B9\u30C8\u3067\u51FA\u529B\u3055\u308C\u308B\u306E\u3067\u30013\u5217\u76EE\u304CANYONE\u3068\u304BANYONE_WITH_LINK\u306B\u306A\u3063\u3066\u3044\u308B\u306E\u306F\u78BA\u8A8D\u3057\u305F\u307B\u3046\u304C\u3044\u3044\u3068\u601D\u3044\u307E\u3059\u3002</p>\\n\\n<div class=\\\"code-frame\\\" data-lang=\\\"csvs\\\"><div class=\\\"highlight\\\"><pre><code><span class=\\\"c1\\\">// \u51FA\u529B\u4F8B</span>\\n<span class=\\\"c1\\\">// \u9577\u3059\u304E\u308B\u3068\u30A8\u30E9\u30FC\u3067\u308B\u306E\u3067\u3001</span>\\n<span class=\\\"c1\\\">// return HtmlService.createHtmlOutput(text);\u306E\u3068\u3053\u30B3\u30E1\u30F3\u30C8\u30A2\u30A6\u30C8\u5916\u3057\u3066Web\u3067\u898B\u305F\u307B\u3046\u304C\u3044\u3044\u304B\u3082</span>\\n<span class=\\\"k\\\">Logging</span> <span class=\\\"k\\\">output</span> <span class=\\\"k\\\">too</span> <span class=\\\"k\\\">large</span><span class=\\\"err\\\">.</span> <span class=\\\"k\\\">Truncating</span> <span class=\\\"k\\\">output</span><span class=\\\"err\\\">.</span> \\n\\n<span class=\\\"c1\\\">// folder\u3068file,\u540D\u524D,url</span>\\n<span class=\\\"k\\\">FOLDER</span><span class=\\\"p\\\">,</span><span class=\\\"k\\\">test</span><span class=\\\"p\\\">,</span><span class=\\\"k\\\">PRIVATE</span><span class=\\\"p\\\">,</span><span class=\\\"nv\\\">https:</span><span class=\\\"c1\\\">//script.google.com/d/sample</span>\\n<span class=\\\"k\\\">FILE</span><span class=\\\"p\\\">,</span><span class=\\\"err\\\">\u7121\u984C\u306E\u30D7\u30ED\u30B8\u30A7\u30AF\u30C8</span><span class=\\\"p\\\">,</span><span class=\\\"k\\\">PRIVATE</span><span class=\\\"p\\\">,</span><span class=\\\"nv\\\">https:</span><span class=\\\"c1\\\">//script.google.com/d/1i</span>\\n</code></pre></div></div>\\n\\n<p>\u6A29\u9650\u306F\u4EE5\u4E0B\u3092\u78BA\u8A8D\u3057\u3066\u304F\u3060\u3055\u3044\u3002<br>\\n<a href=\\\"https://developers.google.com/apps-script/reference/drive/access\\\" class=\\\"autolink\\\" rel=\\\"nofollow noopener\\\" target=\\\"_blank\\\">https://developers.google.com/apps-script/reference/drive/access</a></p>\\n\\n<ul>\\n<li>ANYONE (\u8AB0\u3067\u3082\u898B\u308C\u308B)</li>\\n<li>ANYONE_WITH_LINK(\u30EA\u30F3\u30AF\u77E5\u3063\u3066\u3044\u308B\u4EBA\u5168\u54E1)</li>\\n<li>DOMAIN (\u81EA\u793E\u306EGsuite\u30EF\u30FC\u30AF\u30B9\u30DA\u30FC\u30B9\u306E\u4EBA\u306E\u307F)</li>\\n<li>DOMAIN_WITH_LINK(\u81EA\u793E\u306E\u30EF\u30FC\u30AF\u30B9\u30DA\u30FC\u30B9\u306E\u4EBA\u3067\u30EA\u30F3\u30AF\u77E5\u3063\u3066\u3044\u308B\u4EBA\u306E\u307F)</li>\\n<li>PRIVATE (\u81EA\u5206\u306E\u307F)</li>\\n</ul>\\n\\n<p>\u57FA\u672C\u7684\u306B\u6A5F\u5BC6\u60C5\u5831\u306F\u3001ANYONE,ANYONE_WITH_LINK\u3060\u3068\u5408\u3046\u3068\u3001\u7279\u306B\u6C17\u5BC6\u6027\u9AD8\u3044\u60C5\u5831\u306FDOMAIN\u3082DOMAIN_WITH_LINK\u3082\u3060\u3081\u304B\u3082\u3002<br>\\n\u6C17\u5BC6\u6027\u306E\u9AD8\u3044\u30D5\u30A1\u30A4\u30EB\u306F\u3001PRIVATE\u306B\u3057\u3066\u3001\u5FC5\u8981\u306A\u4EBA\u3060\u3051\u500B\u5225\u3067\u8FFD\u52A0\u3057\u3066\u3044\u304F\u30B9\u30BF\u30A4\u30EB\u304C\u3088\u3044\u304B\u3068\u3002</p>\\n\",\"body\":\"# Google Drive\u3067\u5171\u6709\u8A2D\u5B9A\u304C\u9069\u5207\u306B\u8A2D\u5B9A\u3055\u308C\u3066\u3044\u308B\u304B\u30C9\u30E9\u30A4\u30D6\u306E\u30D5\u30A1\u30A4\u30EB\u30FB\u30D5\u30A9\u30EB\u30C0\u3092\u4E00\u89A7\u3067\u8ABF\u3079\u308B\u65B9\u6CD5\\n\\n30\u5206\u304F\u3089\u3044\u3067\u4F5C\u3063\u305F\u3084\u3064\u3092\u8CBC\u3063\u3066\u304A\u304F\u3002\\n\u304B\u3093\u305F\u3093\u306A\u30B9\u30AF\u30EA\u30D7\u30C8\u306A\u306E\u3067\u3082\u3063\u3068\u826F\u3055\u305D\u3046\u306A\u6539\u826F\u7248\u3042\u308C\u3070\u30B3\u30E1\u30F3\u30C8\u6B04\u306A\u308A\u3001\u81EA\u5206\u3067\u8A18\u4E8B\u304A\u9858\u3044\u3057\u307E\u3059\uFF01\\n\\n\u300C2021\u5E74\uFF11\u6708\uFF16\u65E5\u3001\u798F\u5CA1\u770C\u306E\u65B0\u578B\u30B3\u30ED\u30CA\u30A6\u30A4\u30EB\u30B9\u611F\u67D3\u75C7\u967D\u6027\u8005\u306B\u95A2\u3059\u308B\u500B\u4EBA\u60C5\u5831\u306E\u6F0F\u3048\u3044\u300D\u304C\u3042\u308A\u307E\u3057\u305F\u304C\u3001\u3053\u306E\u6F0F\u6D29\u4E8B\u6848\u304CGoogle Drive\u306B\u3088\u308B\u3082\u306E\u3060\u3068\u306F\u5B58\u3058\u4E0A\u3052\u306A\u3044\u306E\u3067\u3059\u304C\u3001SaaS\u306E\u30C9\u30E9\u30A4\u30D6\u3092\u5229\u7528\u3059\u308B\u30E6\u30FC\u30B6\u30FC\u304C\u5897\u3048\u3066\u304F\u308B\u3068\uFF08\u7D76\u5BFE\u6570\u304C\u5897\u3048\u308B\uFF09\u3068\u3001\u5171\u6709\u8A2D\u5B9A\u3092\u9593\u9055\u3048\u308B\u30CB\u30E5\u30FC\u30B9\u304C\u5897\u3048\u3066\u304F\u308B\u3068\u601D\u3044\u307E\u3059\u3002\\n\\n\u306A\u306E\u3067Drive\u306E\u30D5\u30A1\u30A4\u30EB\u3068\u30D5\u30A9\u30EB\u30C0\u304C\u9069\u5207\u306B\u5171\u6709\u8A2D\u5B9A\u3055\u308C\u3066\u3044\u308B\u304B\u78BA\u8A8D\u3057\u307E\u3057\u3087\u3046\u3001\u3063\u3066\u304A\u8A71\u3002\\n\\n## \u30C7\u30FC\u30BF\\n\\n\\n\\n```js\\nconst results = [];\\n\\nfunction doGet() {\\n  writeInforInFolder(DriveApp.getRootFolder());\\n  const text = results.join(\\\"\\\\n\\\");\\n  Logger.log(text);\\n\\n  // Web\u30A2\u30D7\u30EA\u3068\u3057\u3066\u5C0E\u5165\u3059\u308B\u306A\u3089\u3053\u3093\u306A\u611F\u3058\uFF1F\\n  // return HtmlService.createHtmlOutput(text);\\n}\\n\\nfunction writeInforInFolder(folder) {\\n  if(!folder) return;\\n  \\n  // \u30D5\u30A9\u30EB\u30C0\u4EE5\u4E0B\u30D5\u30A1\u30A4\u30EB\u3092\u3059\u3079\u3066\u53D6\u5F97\\n  const files = folder.getFiles();\\n  while(files.hasNext()) {\\n    const file = files.next();\\n    results.push(`FILE,${file.getName()},${file.getSharingAccess()},${file.getUrl()}`)\\n  }\\n\\n  // \u30D5\u30A9\u30EB\u30C0\u914D\u4E0B\u306E\u30D5\u30A9\u30EB\u30C0\u3092\u53D6\u5F97\\n  const folders = folder.getFolders();\\n  if (!folders) return;\\n  while(folders.hasNext()) {\\n    const folder = folders.next();\\n    results.push(`FOLDER,${folder.getName()},${folder.getSharingAccess()},${folder.getUrl()}`)\\n    // \u66F4\u306B\u4E0B\u306E\u30D5\u30A9\u30EB\u30C0\u3092\u691C\u7D22\u3059\u308B\u305F\u3081\u518D\u5E30\u51E6\u7406\\n    this.writeInforInFolder(folder)\\n  }\\n}\\n```\\n\\n- \u6A29\u9650\u3092\u53D6\u5F97\u3068\u304B\u3082\u308D\u3082\u308D\u306E\u8A31\u53EF\u304C\u5FC5\u8981\\n\\n\\nCSV\u5F62\u5F0F\u306E\u30C6\u30AD\u30B9\u30C8\u3067\u51FA\u529B\u3055\u308C\u308B\u306E\u3067\u30013\u5217\u76EE\u304CANYONE\u3068\u304BANYONE_WITH_LINK\u306B\u306A\u3063\u3066\u3044\u308B\u306E\u306F\u78BA\u8A8D\u3057\u305F\u307B\u3046\u304C\u3044\u3044\u3068\u601D\u3044\u307E\u3059\u3002\\n\\n```csvs\\n// \u51FA\u529B\u4F8B\\n// \u9577\u3059\u304E\u308B\u3068\u30A8\u30E9\u30FC\u3067\u308B\u306E\u3067\u3001\\n// return HtmlService.createHtmlOutput(text);\u306E\u3068\u3053\u30B3\u30E1\u30F3\u30C8\u30A2\u30A6\u30C8\u5916\u3057\u3066Web\u3067\u898B\u305F\u307B\u3046\u304C\u3044\u3044\u304B\u3082\\nLogging output too large. Truncating output. \\n\\n// folder\u3068file,\u540D\u524D,url\\nFOLDER,test,PRIVATE,https://script.google.com/d/sample\\nFILE,\u7121\u984C\u306E\u30D7\u30ED\u30B8\u30A7\u30AF\u30C8,PRIVATE,https://script.google.com/d/1i\\n```\\n\\n\u6A29\u9650\u306F\u4EE5\u4E0B\u3092\u78BA\u8A8D\u3057\u3066\u304F\u3060\u3055\u3044\u3002\\nhttps://developers.google.com/apps-script/reference/drive/access\\n\\n- ANYONE (\u8AB0\u3067\u3082\u898B\u308C\u308B)\\n- ANYONE_WITH_LINK(\u30EA\u30F3\u30AF\u77E5\u3063\u3066\u3044\u308B\u4EBA\u5168\u54E1)\\n- DOMAIN (\u81EA\u793E\u306EGsuite\u30EF\u30FC\u30AF\u30B9\u30DA\u30FC\u30B9\u306E\u4EBA\u306E\u307F)\\n- DOMAIN_WITH_LINK(\u81EA\u793E\u306E\u30EF\u30FC\u30AF\u30B9\u30DA\u30FC\u30B9\u306E\u4EBA\u3067\u30EA\u30F3\u30AF\u77E5\u3063\u3066\u3044\u308B\u4EBA\u306E\u307F)\\n- PRIVATE (\u81EA\u5206\u306E\u307F)\\n\\n\\n\u57FA\u672C\u7684\u306B\u6A5F\u5BC6\u60C5\u5831\u306F\u3001ANYONE,ANYONE_WITH_LINK\u3060\u3068\u5408\u3046\u3068\u3001\u7279\u306B\u6C17\u5BC6\u6027\u9AD8\u3044\u60C5\u5831\u306FDOMAIN\u3082DOMAIN_WITH_LINK\u3082\u3060\u3081\u304B\u3082\u3002\\n\u6C17\u5BC6\u6027\u306E\u9AD8\u3044\u30D5\u30A1\u30A4\u30EB\u306F\u3001PRIVATE\u306B\u3057\u3066\u3001\u5FC5\u8981\u306A\u4EBA\u3060\u3051\u500B\u5225\u3067\u8FFD\u52A0\u3057\u3066\u3044\u304F\u30B9\u30BF\u30A4\u30EB\u304C\u3088\u3044\u304B\u3068\u3002\\n\\n\",\"coediting\":false,\"comments_count\":0,\"created_at\":\"2021-03-08T11:09:30+09:00\",\"group\":null,\"id\":\"e068314d14879221f5a8\",\"likes_count\":2,\"private\":false,\"reactions_count\":0,\"tags\":[{\"name\":\"gas\",\"versions\":[]},{\"name\":\"GoogleDrive\",\"versions\":[]},{\"name\":\"\u5171\u6709\",\"versions\":[]},{\"name\":\"\u6A29\u9650\u7BA1\u7406\",\"versions\":[]}],\"title\":\"Google Drive\u3067\u5171\u6709\u8A2D\u5B9A\u304C\u9069\u5207\u306B\u8A2D\u5B9A\u3055\u308C\u3066\u3044\u308B\u304B\u30C9\u30E9\u30A4\u30D6\u306E\u30D5\u30A1\u30A4\u30EB\u30FB\u30D5\u30A9\u30EB\u30C0\u3092\u4E00\u89A7\u3067\u8ABF\u3079\u308B\u65B9\u6CD5\",\"updated_at\":\"2021-03-08T11:09:30+09:00\",\"url\":\"https://qiita.com/ykhirao/items/e068314d14879221f5a8\",\"user\":{\"description\":\"Web Developer For 6 years.\\r\\nPHP/Laravel && (React OR Vue.js)\\r\\nTypeScript/node.js\\r\\n\\r\\n\u696D\u52D9\u59D4\u8A17\u306E\u4F9D\u983C\u3068\u304B\u306FWantedly\u3068\u304B\u304B\u3089\u3067\u304A\u9858\u3044\u3057\u307E\u3059\uFF01\",\"facebook_id\":\"\",\"followees_count\":38,\"followers_count\":95,\"github_login_name\":\"ykhirao\",\"id\":\"ykhirao\",\"items_count\":58,\"linkedin_id\":\"\",\"location\":\"Tokyo, Japan\",\"name\":\"yk\",\"organization\":\"\",\"permanent_id\":112929,\"profile_image_url\":\"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/profile-images/1639030792\",\"team_only\":false,\"twitter_screen_name\":\"yk_hirao\",\"website_url\":\"https://www.wantedly.com/id/ykhirao\"},\"page_views_count\":null,\"team_membership\":null}},\"path\":\"posts/e068314d14879221f5a8\",\"sharedData\":{},\"siteData\":{}}");</script><script defer="" type="text/javascript" src="/templates/styles.8ede5912.js"></script><script defer="" type="text/javascript" src="/templates/vendors~main.50f3f31b.js"></script><script defer="" type="text/javascript" src="/main.62ec0c15.js"></script></body></html>