{"template":"__react_static_root__/src/components/QiitaPost","sharedHashesByProp":{},"data":{"post":{"rendered_body":"\n<h1>\n<span id=\"シェルスクリプト内でディレクトリ階層移動して呼び出し元で反映する方法\" class=\"fragment\"></span><a href=\"#%E3%82%B7%E3%82%A7%E3%83%AB%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E5%86%85%E3%81%A7%E3%83%87%E3%82%A3%E3%83%AC%E3%82%AF%E3%83%88%E3%83%AA%E9%9A%8E%E5%B1%A4%E7%A7%BB%E5%8B%95%E3%81%97%E3%81%A6%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%97%E5%85%83%E3%81%A7%E5%8F%8D%E6%98%A0%E3%81%99%E3%82%8B%E6%96%B9%E6%B3%95\"><i class=\"fa fa-link\"></i></a>シェルスクリプト内でディレクトリ階層移動して呼び出し元で反映する方法</h1>\n\n<p>簡単なシェルスクリプト書いたので後世に残しておく。<br>\n特にシェルに詳しいわけではないので何か問題あったら気軽に編集リクエストとかコメントください！</p>\n\n<h2>\n<span id=\"やりたいこと\" class=\"fragment\"></span><a href=\"#%E3%82%84%E3%82%8A%E3%81%9F%E3%81%84%E3%81%93%E3%81%A8\"><i class=\"fa fa-link\"></i></a>やりたいこと</h2>\n\n<ul>\n<li>毎日サーバー上で日付いりのフォルダを掘ってそこで作業している人向けのスクリプト <code>mkdir 190512 &amp;&amp; cd 190512</code>\n</li>\n<li>現シェルのコンテキストで別シェルを呼び出す <code>source ~/start.sh</code>\n</li>\n</ul>\n\n<h2>\n<span id=\"データ\" class=\"fragment\"></span><a href=\"#%E3%83%87%E3%83%BC%E3%82%BF\"><i class=\"fa fa-link\"></i></a>データ</h2>\n\n<blockquote>\n<p>~/ops/startTodaysOps.sh</p>\n</blockquote>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><code><span class=\"c\">#!/bin/bash</span>\n\n<span class=\"nv\">dir1</span><span class=\"o\">=</span><span class=\"s1\">'ops/'</span>\n<span class=\"nv\">dir2</span><span class=\"o\">=</span><span class=\"sb\">`</span><span class=\"nb\">date</span> <span class=\"s2\">\"+%y%m%d\"</span><span class=\"sb\">`</span>\n\n<span class=\"nb\">dir</span><span class=\"o\">=</span><span class=\"nv\">$dir1$dir2</span>\n\n<span class=\"k\">if</span> <span class=\"o\">[[</span> <span class=\"o\">!</span> <span class=\"nt\">-e</span> <span class=\"nv\">$dir</span> <span class=\"o\">]]</span><span class=\"p\">;</span> <span class=\"k\">then\n    </span><span class=\"nb\">mkdir</span> <span class=\"nv\">$dir</span>\n    <span class=\"nb\">chmod </span>g+w <span class=\"nv\">$dir</span>\n<span class=\"k\">fi\n\n</span><span class=\"nb\">echo</span> <span class=\"nv\">$dir</span>\n<span class=\"nb\">cd</span> <span class=\"nv\">$dir</span>\n</code></pre></div></div>\n\n<blockquote>\n<p>~/.bashrc</p>\n</blockquote>\n\n<div class=\"code-frame\" data-lang=\"bashrc\"><div class=\"highlight\"><pre><code>alias start='source ~/ops/startTodaysOps.sh'\n</code></pre></div></div>\n\n<blockquote>\n<p>実行する</p>\n</blockquote>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><code>hirao <span class=\"nv\">$ </span>start\nops/200512\n\nhirao <span class=\"nv\">$ </span>~/ops/200512<span class=\"nv\">$ </span>\n</code></pre></div></div>\n\n<h2>\n<span id=\"ちょっとだけ解説\" class=\"fragment\"></span><a href=\"#%E3%81%A1%E3%82%87%E3%81%A3%E3%81%A8%E3%81%A0%E3%81%91%E8%A7%A3%E8%AA%AC\"><i class=\"fa fa-link\"></i></a>ちょっとだけ解説</h2>\n\n<div class=\"code-frame\" data-lang=\"text\"><div class=\"highlight\"><pre><code># 存在確認\nif [[ ! -e $dir ]]; then\n\nfi\n</code></pre></div></div>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><code><span class=\"c\"># -p オプションで存在確認してもよし</span>\n    <span class=\"nb\">mkdir</span> <span class=\"nv\">$dir</span>\n\n<span class=\"c\"># とりあえずグループに書き込み権限あたえる</span>\n    <span class=\"nb\">chmod </span>g+w <span class=\"nv\">$dir</span>\n</code></pre></div></div>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><code><span class=\"nb\">cd</span> <span class=\"nv\">$dir</span>\n\n<span class=\"c\"># このCDは source で呼び出さないと別シェルでディレクトリ移動するっぽい</span>\n</code></pre></div></div>\n\n<p>実行シェルのプロセスIDを書き出す</p>\n\n<blockquote>\n<p>test.sh</p>\n</blockquote>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><code><span class=\"c\">#!/bin/bash</span>\n\n<span class=\"nb\">echo</span> <span class=\"nv\">$$</span>\n</code></pre></div></div>\n\n<div class=\"code-frame\" data-lang=\"bash\"><div class=\"highlight\"><pre><code>~/workspace/shell-sample hirao<span class=\"nv\">$ </span><span class=\"nb\">echo</span> <span class=\"nv\">$$</span>\n42143\n\n~/workspace/shell-sample hirao<span class=\"nv\">$ </span>./test1.sh       \n42366\n\n~/workspace/shell-sample hirao<span class=\"nv\">$ </span><span class=\"nb\">source</span> ./test1.sh\n42143\n\n</code></pre></div></div>\n\n<p>こんな感じ。sourceで実行すればもとのシェル内での移動になるので実行後に移動されています。</p>\n\n<h2>\n<span id=\"終わりに\" class=\"fragment\"></span><a href=\"#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB\"><i class=\"fa fa-link\"></i></a>終わりに</h2>\n\n<p>結構雑に書きましたが、スクリプト書くのには時間かかった（ <code>cd</code> されずにハマった）ので同じ感じでハマるかたがいないように <img alt=\":pray:\" class=\"emoji\" height=\"20\" src=\"https://cdn.qiita.com/emoji/twemoji/unicode/1f64f.png\" title=\":pray:\" width=\"20\" loading=\"lazy\"></p>\n","body":"# シェルスクリプト内でディレクトリ階層移動して呼び出し元で反映する方法\n\n簡単なシェルスクリプト書いたので後世に残しておく。\n特にシェルに詳しいわけではないので何か問題あったら気軽に編集リクエストとかコメントください！\n\n## やりたいこと\n\n- 毎日サーバー上で日付いりのフォルダを掘ってそこで作業している人向けのスクリプト `mkdir 190512 && cd 190512`\n- 現シェルのコンテキストで別シェルを呼び出す `source ~/start.sh`\n\n## データ\n\n> ~/ops/startTodaysOps.sh\n\n```bash\n#!/bin/bash\n\ndir1='ops/'\ndir2=`date \"+%y%m%d\"`\n\ndir=$dir1$dir2\n\nif [[ ! -e $dir ]]; then\n    mkdir $dir\n    chmod g+w $dir\nfi\n\necho $dir\ncd $dir\n```\n\n> ~/.bashrc\n\n```.bashrc\nalias start='source ~/ops/startTodaysOps.sh'\n```\n\n> 実行する\n\n```bash\nhirao $ start\nops/200512\n\nhirao $ ~/ops/200512$ \n```\n\n## ちょっとだけ解説\n\n\n```\n# 存在確認\nif [[ ! -e $dir ]]; then\n\nfi\n```\n\n```bash\n# -p オプションで存在確認してもよし\n    mkdir $dir\n\n# とりあえずグループに書き込み権限あたえる\n    chmod g+w $dir\n```\n\n```bash\ncd $dir\n\n# このCDは source で呼び出さないと別シェルでディレクトリ移動するっぽい\n```\n\n実行シェルのプロセスIDを書き出す\n\n\n> test.sh\n\n```bash\n#!/bin/bash\n\necho $$\n```\n\n\n```bash\n~/workspace/shell-sample hirao$ echo $$\n42143\n\n~/workspace/shell-sample hirao$ ./test1.sh       \n42366\n\n~/workspace/shell-sample hirao$ source ./test1.sh\n42143\n\n```\n\nこんな感じ。sourceで実行すればもとのシェル内での移動になるので実行後に移動されています。\n\n## 終わりに\n\n結構雑に書きましたが、スクリプト書くのには時間かかった（ `cd` されずにハマった）ので同じ感じでハマるかたがいないように :pray:\n","coediting":false,"comments_count":0,"created_at":"2020-05-12T11:25:26+09:00","group":null,"id":"f9e25324bc2e24891848","likes_count":1,"private":false,"reactions_count":0,"tags":[{"name":"Ubuntu","versions":[]},{"name":"shell","versions":[]}],"title":"シェルスクリプト内でディレクトリ階層移動して呼び出し元で反映する方法","updated_at":"2020-05-12T11:25:26+09:00","url":"https://qiita.com/ykhirao/items/f9e25324bc2e24891848","user":{"description":"Web Developer For 6 years.\r\nPHP/Laravel && (React OR Vue.js)\r\nTypeScript/node.js\r\n\r\n業務委託の依頼とかはWantedlyとかからでお願いします！","facebook_id":"","followees_count":38,"followers_count":95,"github_login_name":"ykhirao","id":"ykhirao","items_count":60,"linkedin_id":"","location":"Tokyo, Japan","name":"yk","organization":"","permanent_id":112929,"profile_image_url":"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/112929/profile-images/1639030792","team_only":false,"twitter_screen_name":"ykhirao","website_url":"https://www.wantedly.com/id/ykhirao"},"page_views_count":null,"team_membership":null}},"path":"posts/f9e25324bc2e24891848"}
